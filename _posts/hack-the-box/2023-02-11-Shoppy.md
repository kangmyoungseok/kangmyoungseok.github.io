---
title: "[Hack The Box] Shoppy í’€ì´"
categories:
  - Hack-The-Box
tags:
  - HTB
  - Hack The Box
  - Shoppy
toc: true
toc_sticky: true
toc_label: "Shoppy í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/hackthebox.jpeg
---

ğŸ’¡ Hack-The-Box Shoppy í’€ì´ ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ

![image](https://user-images.githubusercontent.com/33647663/218263273-6899c702-0f14-47f2-93c5-aedb464f4775.png)

# Enumeration

```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]
â””â”€ nmap -sV -p - 10.129.227.233 -vv --min-rate 3000

Nmap scan report for 10.129.227.233
Host is up, received echo-reply ttl 63 (0.081s latency).
Scanned at 2023-02-11 09:24:39 EST for 122s
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE  REASON         VERSION
22/tcp   open  ssh      syn-ack ttl 63 OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
80/tcp   open  http     syn-ack ttl 63 nginx 1.23.1
9093/tcp open  copycat? syn-ack ttl 63
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
Nmap done: 1 IP address (1 host up) scanned in 122.20 seconds
           Raw packets sent: 65540 (2.884MB) | Rcvd: 65536 (2.621MB)
                                                                            
```

ì´ 3ê°œì˜ ì„œë¹„ìŠ¤ê°€ ì—´ë ¤ìˆìŠµë‹ˆë‹¤. http(80) ì„œë¹„ìŠ¤ì™€ , ì–´ë–¤ ì„œë¹„ìŠ¤ ì¸ì§€ëŠ” ëª¨ë¥´ì§€ë§Œ 9093 í¬íŠ¸ë¡œ ì ‘ì†ì„ í•´ë´…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218263399-6def6a45-da13-4bf0-9b3c-eac5b748a5ef.png)

ìœ„ì™€ê°™ì€ ë°ì´í„°ë“¤ì´ ë‚˜ì˜¤ê³ , ì¼ë¶€ í•­ëª©ë“¤ì„ êµ¬ê¸€ë§ í•´ë³´ë©´ í•´ë‹¹ í˜ì´ì§€ëŠ” prometheus ë¼ëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” í˜ì´ì§€ ì…ë‹ˆë‹¤. 

ë¬¸ì œë¥¼ ë‹¤ í’€ì–´ë³¸ ê²°ê³¼ í•´ë‹¹ í˜ì´ì§€ëŠ” ë¬¸ì œí’€ì´ì™€ ì—°ê´€ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì— ì¶”ê°€ì ì¸ ì„¤ëª…ì€ í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤.

ê·¸ ë‹¤ìŒì€ ì›¹ì„œë¹„ìŠ¤ ì…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218263583-a7b10868-e985-4963-bf91-074c07293ada.png)

/etc/hosts íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ë„ë©”ì¸ì„ ë“±ë¡í•´ ì£¼ê³  ë‹¤ì‹œ ì ‘ì†ì„ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

```bash
# /etc/hosts 
10.129.227.233 shoppy.htb
```

![image](https://user-images.githubusercontent.com/33647663/218263657-1adc8a99-01d5-4c1c-a455-986222826faa.png)


ì‚¬ì´íŠ¸ë¥¼ ë‘˜ëŸ¬ë´ë„ íŠ¹ë³„í•œ ê¸°ëŠ¥ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 

subdomain / subdirectory ë¦¬ìŠ¤íŒ…ì„ ìˆ˜í–‰í•´ ë´…ë‹ˆë‹¤.

```bash
# subdirectory
wfuzz -c --hc 404 -w /usr/share/wordlists/dirb/commont.txt 'http://shoppy.htb/FUZZ'

# subdomain
wfuzz -c -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -u shoppy.htb -H "Host: FUZZ.shoppy.htb" --hc 301
```

ë¨¼ì € subdirectoryì˜ ê²°ê³¼ì…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218263862-3b9b505f-3bad-40e8-b386-f7cb14ebc98e.png)

```admin``` ê²½ë¡œë¡œ ì ‘ì†ì„ í•´ë´…ë‹ˆë‹¤.

# SQL Injection

![image](https://user-images.githubusercontent.com/33647663/218263914-eabe9d67-eb31-491c-a448-ad2d5d4fd3e6.png)

ê³„ì • ì¸ì ì…˜ì„ ìˆ˜í–‰í•´ë³¸ ê²°ê³¼, ë°±ì—”ë“œì—ì„œ MongoDBë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶”ì¸¡ë˜ê³  ê³„ì •ì˜ ê²€ì¦ì„ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ì€ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœì¼ ê²ƒìœ¼ë¡œ ì¶”ì¸¡í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
db.user.find({$where: `this.username=='${req.query.username}'&&this.password=='${req.query.password}'`});
```

ë”°ë¼ì„œ ì¸ì ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

```py
username='||1||'&password=123
```

![image](https://user-images.githubusercontent.com/33647663/218265008-049eb1cf-8b67-4f8e-ae26-b3cab6c951d2.png)

ê²€ìƒ‰ê¸°ëŠ¥ ì—­ì‹œ ì¸ì ì…˜ì´ ê°€ëŠ¥í•˜ì—¬ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ ì¸ì ì…˜ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265246-0fe54acb-06cc-4a6c-9c84-f01979bead0d.png)

```admin``` ê³„ì •ê³¼, ```josh``` ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œê°’ì„ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.


# Crack MD5

```hash-identifier``` ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•´ë³¸ ê²°ê³¼ md5 ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265322-df53584b-e7df-4435-8bde-d0eab6abb439.png)

ë‘ ê³„ì • ëª¨ë‘ rockyou.txt íŒŒì¼ì„ ì´ìš©í•˜ì—¬ í¬ë˜í‚¹ì„ ì‹œë„í•´ ë´…ë‹ˆë‹¤.
ì‹œë„ ê²°ê³¼ admin ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” ì–»ì§€ ëª»í•˜ì˜€ê³ , josh ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265799-b8cc4384-8c95-466e-946d-bae5ba341c49.png)

```
id : josh 
pw : remembermethisway
```


ì´ì „ì— ì‹¤í–‰í•´ë†“ì€ wfuzz ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ë©´, subdomainìœ¼ë¡œ mattermost ê°€ ì¡´ì¬í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265840-c3426f5c-c255-4c72-9a86-21310b58770b.png)


![image](https://user-images.githubusercontent.com/33647663/218265905-a568df0f-2eea-4e4d-b309-a7db4280b6f6.png)

íšë“í•œ josh ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì„ í•©ë‹ˆë‹¤.

ì±„íŒ… ë‚´ì—­ì—ì„œ jaeger ê³„ì •ì •ë³´ë¥¼ íšë“í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265936-e94cab1e-f920-47e4-b7ec-101ecfb49091.png)


user ê³„ì •ì˜ flagë¥¼ íšë“í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218265981-f3e73bba-007d-4066-ba23-0c3453e51df9.png)


/home ë””ë ‰í„°ë¦¬ë¥¼ ë³´ë©´ deploy ê³„ì •ì´ ì¡´ì¬í•¨ì„ ì•Œ ìˆ˜ìˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218266035-fe479670-8fca-4726-a038-c9b78ec5437f.png)

í•´ë‹¹ í™ˆë””ë ‰í„°ë¦¬ì— password-manager íŒŒì¼ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì‹¤í–‰ ê¶Œí•œì€ ì—†ê³  ì‹¤í–‰íŒŒì¼ì— ì½ê¸° ê¶Œí•œì´ ìˆê¸° ë•Œë¬¸ì— í•´ë‹¹ íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ kali linux ë¡œì»¬ì—ì„œ ë¦¬ë²„ì‹± í•´ë´…ë‹ˆë‹¤.

ë¦¬ë²„ì‹±ì€ ghidraë¡œ ìˆ˜í–‰í•˜ì˜€ìœ¼ë©°, ê·¸ ê²°ê³¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```sudo -l``` ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ë³´ë©´, jaeger ê³„ì •ìœ¼ë¡œ deploy ê¶Œí•œìœ¼ë¡œ password-manager í”„ë¡œê·¸ë¨ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218266157-4a28fc51-f11c-4a87-8ab8-7cea11955ebc.png)

![image](https://user-images.githubusercontent.com/33647663/218266184-7d1cd987-260d-4ef1-b8c6-87aa52ac8578.png)

deploy ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ëƒˆìŠµë‹ˆë‹¤.


# Docker Breakout

![image](https://user-images.githubusercontent.com/33647663/218266208-7e6fce55-472e-4c88-b9c5-60d91d1d8463.png)

deploy ê³„ì •ì— docker ê·¸ë£¹ê¶Œí•œì´ ì£¼ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. 
docker breakout ê¸°ìˆ ì„ ì´ìš©í•´ì„œ root ê¶Œí•œ íƒˆì·¨ë¥¼ ì‹œë„í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218266246-50ce4816-36c9-43a2-b1c9-054a9309af6e.png)

docker iamges ëª…ë ¹ì–´ ìˆ˜í–‰ê²°ê³¼ alpine ì´ë¯¸ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. 

ë‹¤ìŒê³¼ ê°™ì´ ```--privileged```ê¶Œí•œì„ ì¤˜ì„œ breakoutì´ ê°€ëŠ¥í•˜ë„ë¡ ë„ì»¤ í™˜ê²½ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/218266305-f31ae869-b53c-4dde-a9ed-fd8d61cc502d.png)

```--privileged``` ê¶Œí•œì´ ì£¼ì–´ì§€ë©´, í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ìœ¼ë¡œ mountê°€ ê°€ëŠ¥í•´ ì§‘ë‹ˆë‹¤. host ë¨¸ì‹ ì˜ í•˜ë“œì¸ /dev/sda1 ë¡œ ë‹¤ì‹œ mountë¥¼ í•˜ì—¬ ì „ì²´ íŒŒì¼ì‹œìŠ¤í…œì˜ ì ‘ê·¼ê¶Œí•œì„ íšë“í•©ë‹ˆë‹¤.


![image](https://user-images.githubusercontent.com/33647663/218266415-b082ae28-e555-4a82-bfdf-a91c1240e888.png)



![image](https://user-images.githubusercontent.com/33647663/218266464-fa441d07-5f07-4f8e-993c-3adadfe23b63.png)