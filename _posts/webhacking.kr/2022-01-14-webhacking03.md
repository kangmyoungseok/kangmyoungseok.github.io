---
title: "[webhacking.kr] 3ë²ˆ ë¬¸ì œ í’€ì´[SQL]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - SQL
toc: true
toc_sticky: true
toc_label: "3ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 3ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ

## ë¬¸ì œ í™”ë©´
 ì²˜ìŒ ë¬¸ì œë¥¼ ëŠ˜ì–´ê°€ë©´ ê·¸ë¦¼ê³¼ ê°™ì´ ë„¤ëª¨ë„¤ëª¨ ë¡œì§ì„ í‘¸ëŠ” ë¬¸ì œê°€ ë‚˜ì˜µë‹ˆë‹¤. ê°€ë¿íˆ í’€ì–´ì¤ë‹ˆë‹¤. ~~ë…¸ë…¸ê·¸ë¨ì´ë¼ê³  ë¶€ë¥´ëŠ”êµ¬ë‚˜..~~

  ![image](https://user-images.githubusercontent.com/33647663/149819286-8bb47c21-fb38-4f1b-b32e-58188f88a5d1.png)

  ![image](https://user-images.githubusercontent.com/33647663/149819476-ac694936-31e5-419b-9a3f-844145b55a24.png)

 ë¬¸ì œë¥¼ í’€ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì´ë¦„ì„ ì ëŠ” ì¹¸ì´ ë‚˜ì˜µë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/149819580-e13ce8c5-d9dd-4755-b78f-e89c6d08cd13.png)

 **guest**ë¥¼ ì…ë ¥í•´ ì£¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê¸°ë¡ì´ ë©ë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/149819821-bdb89b81-67a9-40f8-9100-601952e3ec0a.png)

## ë¬¸ì œ ì ‘ê·¼ 
 ì´ë²ˆ ë¬¸ì œëŠ” ì†ŒìŠ¤ì½”ë“œëŠ” ë”°ë¡œ ì—†ê³  ì›¹ì‚¬ì´íŠ¸ ì‘ë™ ë¡œì§ì„ ë¶„ì„í•´ì„œ ê³µê²© ë²¡í„°ë¥¼ ì°¾ëŠ” ë¬¸ì œ ê°™ìŠµë‹ˆë‹¤. 

 ê¸°ë¡ì´ ë˜ëŠ” í˜ì´ì§€ë¥¼ ë³´ë‹ˆ name,answer,ipê°€ ê¸°ë¡ì´ ë˜ê³  ì´ê²ƒë“¤ì„ ë‚´ê°€ ë³€ì¡°í•  ìˆ˜ ìˆëŠ”ì§€ ìƒê°í•´ì„œ sql injectionì„ ì‹œë„í•´ ë´¤ìŠµë‹ˆë‹¤.

 ë¨¼ì € ê°€ì¥ ë§Œë§Œí•œ nameì— ì¸ì ì…˜ì„ ì‹œë„í•´ ë´¤ìŠµë‹ˆë‹¤. ```'``` ë¬¸ìë¥¼ ë„£ì–´ì„œ ì˜¤ë¥˜ê°€ ë‚˜ëŠ”ì§€ í™•ì¸í•´ë³´ë‹ˆ í…ìŠ¤íŠ¸ ê·¸ëŒ€ë¡œ ì €ì¥ì´ ë˜ëŠ”ê±¸ ë³´ë‹ˆ nameìª½ì€ ì•„ë‹Œê²ƒ ê°™ìŠµë‹ˆë‹¤. ê·¸ ë‹¤ìŒì€ ipë‚˜ answer ë¶€ë¶„ì— ì…ë ¥ì´ ê°€ëŠ¥í•œ ê³³ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/149820001-ef174a65-943c-4345-8921-867ce61fe9a4.png)

 ê°œë°œì ëª¨ë“œë¡œ í™•ì¸ì„ í•´ë³´ë‹ˆ answerê°’ì„ hidden valueë¡œ ì „ì†¡í•´ ì£¼ê³  ìˆì—ˆìŠµë‹ˆë‹¤. 

 ![image](https://user-images.githubusercontent.com/33647663/149820208-550fab5b-4cb4-4eb0-985e-0f05597ff972.png)

 ì´ ê°’ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€ì¡° í•´ì„œ ë³´ë‚´ë´…ë‹ˆë‹¤.
 
 ![image](https://user-images.githubusercontent.com/33647663/149820327-c9e3a083-5f4e-4459-8df1-1706f6dce89f.png)

 **??? í’€ë ¸ë‹¤.**
 ![image](https://user-images.githubusercontent.com/33647663/149818719-86cea65f-601f-43ef-8657-7c5e7ba7302d.png)

# ë¬¸ì œ í•´ì„
 ë¬¸ì œê°€ ë„ˆë¬´ í—ˆë¬´í•˜ê²Œ í’€ë ¤ì„œ, PHP ì½”ë“œê°€ ì–´ë–»ê²Œ ë˜ì–´ ìˆëŠ”ì§€ ì¶”ì¸¡ì„ í•´ë³´ê³  ì™œ ì € êµ¬ë¬¸ìœ¼ë¡œ ì¸í•´ì„œ ë¬¸ì œê°€ í’€ë ¸ëŠ”ì§€ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

 ìš°ì„  ì œê°€ ì…ë ¥í•œ ê°’ìœ¼ë¡œ ì¸í•´ì„œ ë‚˜ì˜¨ í˜ì´ì§€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/149820628-ae0fdc84-2fbb-47a4-8e63-246af548316d.png)

 ê²°ê³¼ ê°’ì„ ë³´ì•„í•˜ë‹ˆ DBì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì—ì„œ where ì¡°ê±´ì ˆì„ ìš°íšŒí•˜ì—¬ ëª¨ë“  ì»¬ëŸ¼ ê°’ì„ ë½‘ì•„ì˜¨ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ëª‡ê°€ì§€ ì‹œë„ë¥¼ í•´ë³´ê³  ë‚˜ë‹ˆ ë‹¤ìŒê³¼ ê°™ì´ php ì½”ë“œê°€ ì§œì—¬ ìˆì—ˆì„ ê²ƒìœ¼ë¡œ ì¶”ì¸¡ì´ ë©ë‹ˆë‹¤.
 ```php
 <?php
  $ip =  $_SERVER["REMOTE_ADDR"];
  $name = $_POST['id']
  $answer = $_POST['answer']

  # DBì— ê°’ì´ ë“¤ì–´ê°ˆ ë• ì„±ê³µì ìœ¼ë¡œ ë“¤ì–´ê°„ ê²ƒì„ ë³´ë‹ˆ, ë“¤ì–´ê°ˆ ë• íŠ¹ìˆ˜ë¬¸ì ' ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•´ì¤¬ë‹¤.
  mysqli_query($db,"insert into chall3(ip,name,answer) values('$ip','$name','$answer'))";

  # ë¬¸ì œëŠ” ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì—ì„œ íŠ¹ìˆ˜ë¬¸ì ì²˜ë¦¬ë¥¼ ì•ˆí•´ì¤˜ì„œ ë‹¤ìŒì˜ êµ¬ë¬¸ì—ì„œ Injection ì·¨ì•½ì ì´ ë°œìƒí•œ ë“¯.
  $result = mysqli_query($db,"select name,answer,ip from chall3 where answer ='$answer'  and  ip='$ip'");
  ... ë‚˜ì˜¨ ê²°ê³¼ ê°’ í™”ë©´ ì¶œë ¥	
  ?>
 ```
 ìœ„ì²˜ëŸ¼ ì¿¼ë¦¬ê°€ ì‘ì„±ë˜ì–´ ìˆì–´ì„œ ì €ì˜ ì…ë ¥ ê°’ì´ ë“¤ì–´ê°€ë©´ ë‹¤ìŒê³¼ ê°™ì´ where êµ¬ë¬¸ì„ ìš°íšŒí•œ ëª¨ë“  ê°’ë“¤ì„ ë½‘ì•„ì˜¨ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

 ```sql
  select name,answer,ip from chall3 where answer = '1' or 1=1 -- and ip='$ip'
 ```
