---
title: "[webhacking.kr] 51ë²ˆ ë¬¸ì œ í’€ì´[md5 true ì·¨ì•½ì ]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - md5 true
toc: true
toc_sticky: true
toc_label: "51ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 51ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152945460-7760f7e5-ba71-46d1-9157-efb072c9ed80.png)


  ```php
<?php
  if($_POST['id'] && $_POST['pw']){
    $db = dbconnect();
    $input_id = addslashes($_POST['id']);
    $input_pw = md5($_POST['pw'],true);
    $result = mysqli_fetch_array(mysqli_query($db,"select id from chall51 where id='{$input_id}' and pw='{$input_pw}'"));
    if($result['id']) solve(51);
    if(!$result['id']) echo "<center><font color=green><h1>Wrong</h1></font></center>";
  }
?>
  ```

# md5 í•¨ìˆ˜
  ì´ë²ˆ ë¬¸ì œë¥¼ í’€ê¸° ìœ„í•´ì„œëŠ” md5 í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œ, True ì˜µì…˜ì— ëŒ€í•´ì„œ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

  md5 í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ë¬¸ìì—´ì— ëŒ€í•œ md5 í•´ì‹œ ê°’ì„ êµ¬í•´ì£¼ëŠ” í•¨ìˆ˜ ì…ë‹ˆë‹¤.
  ```php
md5(string $string, bool $binary = false): string
# $string : í•´ì‹œë¥¼ í•  ë¬¸ìì—´
# $binary : trueë¡œ ì„¤ì •í•˜ë©´, md5ë¥¼ raw binaryë¡œ ì¶œë ¥
  ```

  ë‹¤ìŒ ì²˜ëŸ¼ php ì½”ë“œë¥¼ í™•ì¸í•´ ë³´ë©´ ì‰½ê²Œ ì´í•´í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. md5í•¨ìˆ˜ë¥¼ ê·¸ëƒ¥ ì‚¬ìš©í•˜ë©´ 16ì§„ìˆ˜ë¡œ í•´ì‹œê°’ì„ ì¶œë ¥í•´ì£¼ê³ , true ì˜µì…˜ì„ ì£¼ë©´ raw binaryë¡œ ì¶œë ¥í•´ ì¤ë‹ˆë‹¤.

  ```php
<?php
    $pw = "password";
    echo "md5 default : ".md5($pw)."<br>";
    echo "md5 True : ".md5($pw,true)."<br>";   
?>
  ```

  ![image](https://user-images.githubusercontent.com/33647663/152946523-dd707402-9549-4bbb-9291-9a7210157cfc.png)
  
# md5 true ì·¨ì•½ì 
  md5 true ì·¨ì•½ì ì€ binaryë¡œ ë°˜í™˜ëœ ë¬¸ìì—´ì´ dbì˜ ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ ê·¸ë˜ë„ ë“¤ì–´ê°ˆ ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

  í•´ë‹¹ ë¬¸ì œë¥¼ ë³´ë©´ pwë¥¼ md5 trueë¡œ í•´ì‹œëœ ë°”ì´ë„ˆë¦¬ ê°’ì„ ê·¸ëŒ€ë¡œ DBì˜ ì¿¼ë¦¬ë¡œ ì‚¬ìš©í•¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```php
$input_pw = md5($_POST['pw'],true);
$result = mysqli_fetch_array(mysqli_query($db,"select id from chall51 where id='{$input_id}' and pw='{$input_pw}'"));
  ```

  ì´ë•Œ md5ë¡œ í•´ì‹œëœ ë°”ì´ë„ˆë¦¬ ê°’ì— ```'``` ë‚˜ ë‹¤ë¥¸ ë¬¸ìê°€ ë‚˜ì˜¤ë„ë¡ í•œë‹¤ë©´ ì•…ì˜ì ìœ¼ë¡œ ì¿¼ë¦¬ë¬¸ì„ ì¡°ì‘í•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.

  ë” ì‰½ê²Œ ì´í•´ë¥¼ í•˜ê¸° ìœ„í•´ ì˜ˆì‹œë¥¼ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤. chall51 í…Œì´ë¸”ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ë„£ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152947664-81c7f7fd-6c87-425e-a34d-1aba434bfe5e.png)

  í•´ë‹¹ ì·¨ì•½ì ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒì˜ ì¿¼ë¦¬ë¬¸ ê²°ê³¼ë¥¼ ì´í•´í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

## 'or'ìˆ«ì 
  ![image](https://user-images.githubusercontent.com/33647663/152948701-d8e679fc-1c42-46dc-b867-7eb20d1a085c.png)

  ìœ„ì˜ ì¿¼ë¦¬ë¬¸ì€ or ì•ì—ëŠ” ê±°ì§“ì´ ë˜ê³ , ë’·ë¶€ë¶„ì€ Trueì´ê¸° ë•Œë¬¸ì— ì „ì²´ê°€ Trueê°€ ë©ë‹ˆë‹¤. **mysqlì—ì„œëŠ” ì°¸ê±°ì§“ì„ íŒë‹¨í•  ë•Œ, ë¬¸ìì—´ì´ ì˜¤ë©´ ë§¨ ì²« ìë¦¬ë§Œì„ ë³´ê³  ê²€ì‚¬ë¥¼ í•©ë‹ˆë‹¤. ì´ ë•Œ, ë§¨ ì²«ìë¦¬ê°€ 1-9ì´ë©´ Trueë¥¼, 0ê³¼ ë‹¤ë¥¸ ë¬¸ìë“¤ì€ ëª¨ë‘ Falseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.**

  ì´ë•Œ ë’¤ì˜ ë¬¸ìì—´ì˜ ì²« ìˆ«ìëŠ” 1-9ì—¬ì•¼ë§Œ í•©ë‹ˆë‹¤. ë‹¤ìŒì²˜ëŸ¼ 0ì´ë‚˜, ë‹¤ë¥¸ ë¬¸ìê°€ ì˜¤ë©´ ìœ„ì˜ ë°©ë²•ì´ ë˜ì§€ ì•ŠìŒì„ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152949342-43b28a75-ab25-441e-be84-58d225f362d1.png)

## '='ë¬¸ì
  ![image](https://user-images.githubusercontent.com/33647663/152950467-c263d292-e29a-4f7d-b455-26103b938711.png)

  ì´ ë¶€ë¶„ë„ ë’·ë¶€ë¶„ì—ì„œ  'rmaodsa'ëŠ” ë§¨ ì•ë¶€ë¶„ì´ ìˆ«ìê°€ ì•„ë‹ˆê³  ë¬¸ìì´ê¸° ë•Œë¬¸ì— ì°¸ê±°ì§“ íŒë‹¨ì—ì„œ FALSEê°€ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë’·ë¶€ë¶„ì´ ë§Œì•½ ìˆ«ìë¡œ ì‹œì‘í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê³µê²©ì´ ë˜ì§€ ì•ŠìŒì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152955430-841dc1da-212c-43fc-a1f7-25932875ddb6.png)

  ìœ„ì˜ ê°œë…ì„ ì´ìš©í•˜ì—¬ md5 trueë¥¼ ì‚¬ìš©í•  ë•Œ ê·¸ ê²°ê³¼ ê°’ì—ì„œ **'or'ìˆ«ì** í˜¹ì€ **'='ë¬¸ì** ê°€ ë‚˜ì˜¤ë„ë¡ í•´ì‹œê°’ì„ ì¤€ë‹¤ë©´ ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  
  ì¶”ê°€ë¡œ ì‹¤ì œ ê³µê²©ì—ì„œ ì‹œë„í•  ë•ŒëŠ” 'or'ìˆ«ìëŠ” ì°¾ê¸°ê°€ ì–´ë µìŠµë‹ˆë‹¤. í•˜ë‚˜ì˜ ê¸€ìì”© ë³´ë©´ ' o r ' ìˆ«ì ë¡œ 5ìë¦¬ê°€ ë§ëŠ” ê²½ìš°ë¥¼ ì°¾ì•„ì•¼ í•˜ëŠ”ë° ì´ëŠ” ì‰½ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°˜ë©´ '='ëŠ” ì„¸ìë¦¬ë§Œ ì°¾ìœ¼ë©´ ë˜ê¸° ë•Œë¬¸ì—(ì•„ìŠ¤í‚¤ ì½”ë“œì—ì„œ ë³´ë©´ 1-9 ë¥¼ ì œì™¸í•œ ëª¨ë“  ê²½ìš°ê°€ ë¬¸ìì´ê¸° ë•Œë¬¸ì— ë§ˆì§€ë§‰ì— ì˜¤ëŠ” ë¬¸ìëŠ” ì‹ ê²½ì•ˆì¨ë„ ë˜ëŠ” ìˆ˜ì¤€) í›¨ì”¬ ë‚œì´ë„ê°€ ë‚®ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì‹¤ì œ ê³µê²©ì— ì‚¬ìš©í•  ë•ŒëŠ” ë¬´ì¡°ê±´ '=' ë¬¸ìë¥¼ ì´ìš©í•©ë‹ˆë‹¤.
  {: .notice--info}
 

# ë¬¸ì œ í’€ì´
  íŒŒì´ì¬ì„ í†µí•´ì„œ í•´ì‹œ ê²°ê³¼ì— '='ë¥¼ í¬í•¨í•˜ëŠ” ìˆ«ìë“¤ì„ ì°¾ì•„ë´…ë‹ˆë‹¤.

  ```python
from hashlib import md5
from tqdm import tqdm
from colorama import Fore

# '=' -> 0x27 0x3d 0x27
for i in range(1000000000):
    raw_md5 = md5(str(i).encode("ascii")).digest()
    if(b'\x27\x3d\x27' in raw_md5):
        print(Fore.GREEN + '[+] ' + str(i) +' : ' + str(raw_md5))
        
  ```

íŒŒì´ì¬ ì½”ë“œ ì‹¤í–‰ ê²°ê³¼
```sql
[+] 1839431 : b"\xc37\x90\xa5\xaf\xc4\xb1A@J\xbe'='\xaa\xa9"
[+] 2584670 : b"\xdf\x8b\x12'='N/\xe6*{\xec\x18\x16\x931"
[+] 2632003 : b"\x1c\x12(\xcc'='6\xfaQE\x84\x0e\x96\xed\x99"
[+] 2998869 : b"\xfe\xb2'=':\xe9T\xea\xd6,p\xa7\x80\xf1\xe1"
[+] 4939073 : b"u}t'Q'='\x14\xd9\xe2\x8e\xec.\xd8\x8a"
[+] 5263117 : b"e'='\x80\xb0\xb4\xf6\x12\xd6M@KD\x06\xcb"
[+] 5273607 : b"\xb7\x94a\x9f\x10d\xbe\xc6\x87\x04\xf4;\xac'='"

 ..... ì¤‘ëµ

```

ìœ„ì˜ ìˆ«ìë“¤ ì¤‘ì—ì„œ 2632003 ì¸ ê²½ìš°ì—ëŠ” '='6 ìœ¼ë¡œ ë°”ë¡œ ë‹¤ìŒì— ìˆ«ìê°€ ë‚˜ì™”ê¸° ë•Œë¬¸ì— í’€ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‚˜ë¨¸ì§€ ìˆ«ìì¤‘ì— í•˜ë‚˜ë¥¼ ê³¨ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë¬¸ì œë¥¼ í’€ì–´ì¤ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/152953746-c94987fc-521b-4138-bf9b-3fed849f4d9b.png)

![image](https://user-images.githubusercontent.com/33647663/152953827-4f1144f7-3385-46cc-a0ca-974a32250aa9.png)