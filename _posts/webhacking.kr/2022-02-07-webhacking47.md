---
title: "[webhacking.kr] 47ë²ˆ ë¬¸ì œ í’€ì´[SMTP Header Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - SMTP Header injection
toc: true
toc_sticky: true
toc_label: "47ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 47ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152763430-806d615e-8523-47ea-987e-95e91fd4c6fa.png)
  
  sendë¥¼ ëˆ„ë¥´ë©´ ì–´ë”˜ê°€ë¡œ ë©”ì¼ì„ ë³´ë‚´ê³  ìˆëŠ”ê±° ê°™ìŠµë‹ˆë‹¤. ì¼ë‹¨ ì œëª©ì„ ë³´ë‹ˆ, ë©”ì¼ì•ˆì— Flagê°€ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ë‹ˆ í•´ë‹¹ ë©”ì¼ì´ ì €ì˜ ì´ë©”ì¼ë¡œ ì˜¤ë„ë¡ í•˜ë©´ ë©ë‹ˆë‹¤.


# ë¬¸ì œ í’€ì´
  í•´ë‹¹ ë¬¸ì œëŠ” SMTP Header Injection ì·¨ì•½ì ì„ ì´ìš©í•œ ë¬¸ì œì…ë‹ˆë‹¤.
  
  ë‹¤ìŒì€ ì´í•´ë¥¼ ë•ê¸°ìœ„í•œ ì˜ˆì‹œë¡œ ì‹¤ì œë¡œ ì œê°€ ë°›ì€ ë©”ì¼ í—¤ë”ì˜ ì¼ë¶€ë¥¼ ì ì–´ë´¤ìŠµë‹ˆë‹¤.

  ```s
From: no-reply-aws@amazon.com
To: kms00129@naver.com
Message-ID: <0100017ea3cd482d-e610c809-51ce-4c43-aa35-4b0dbf1b564e-000000@email.amazonses.com>
Subject: AWS Free Tier limit alert
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_14614864_489097825.1643425646632"
  ```

  ë©”ì¼ì„ ë³´ë‚´ë©´ ìœ„ì™€ê°™ì€ í˜•íƒœë¡œ ì „ë‹¬ì´ ë˜ëŠ”ë°, ì´ë•Œ ê°ê°ì˜ í—¤ë”ëŠ” **\r\n** ì¦‰ ì¤„ë°”ê¿ˆì„ í† ëŒ€ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.

  ë”°ë¼ì„œ í˜„ì¬ ë¬¸ì œì—ì„œ Subjectë¶€ë¶„ì„ ì¡°ì‘í•  ìˆ˜ ìˆìœ¼ë‹ˆ, subjectì— ì¤„ë°”ê¿ˆì„ ì¶”ê°€í•˜ì—¬ í—¤ë”ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ê·¸ë¦¬ê³  ë©”ì¼ì—ì„œëŠ” ìˆ˜ì‹ ìë¥¼ To: ì— ëª…ì‹œí•´ ì£¼ëŠ”ë° ì´ì™€ ë³„ê°œë¡œ ì°¸ì¡°ì˜ ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ ì—¬ëŸ¬ëª…ì´ ìˆ˜ì‹ ê°€ëŠ¥í•˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  subjectì—ì„œ ì°¸ì¡°ë¥¼ ì˜ë¯¸í•˜ëŠ” Cc ì™€ Bcc ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ í•´ë‹¹ë©”ì¼ì´ ì œ ë©”ì¼ì—ë„ ë³´ë‚´ì§€ë„ë¡ í•´ì£¼ë©´ ë©ë‹ˆë‹¤.

  ì¤„ë°”ê¿ˆì´ ê°€ëŠ¥í•˜ë„ë¡ í˜„ì¬ input typeì„ textareaë¡œ ë³€ê²½í•´ ì¤ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152765291-be06938f-0a57-42ee-be01-4e982133675f.png)

  ```html
<textarea name="subject"> </textarea>
  ```

  ![image](https://user-images.githubusercontent.com/33647663/152765577-e3a96299-d37d-4c44-a424-71c967344b2d.png)

  ì…ë ¥ì¹¸ì— ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•´ ì¤ë‹ˆë‹¤. ì´ë•Œ ëŒ€ì†Œë¬¸ìì™€ ë„ì–´ì“°ê¸°ë¥¼ ì£¼ì˜í•´ì„œ ì…ë ¥í•´ ì¤ë‹ˆë‹¤.

  ```md
  subject
  Bcc: kms00129@naver.com
  # Cc: kms00129@naver.com    Ccë¥¼ ì´ìš©í•´ë„ ë©ë‹ˆë‹¤.
  ```

  ê·¸ëŸ¬ë©´ í”Œë˜ê·¸ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152765798-7830ef3e-ca4d-483f-b501-d0481e0d102e.png)