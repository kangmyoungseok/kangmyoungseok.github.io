---
title: "[webhacking.kr] 33ë²ˆ ë¬¸ì œ í’€ì´[python]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - python
toc: true
toc_sticky: true
toc_label: "33ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 33ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  33ë²ˆ ë¬¸ì œëŠ” í•˜ë‚˜ì˜ ë‹¨ê³„ë¥¼ í’€ë©´ ë‹¤ìŒ ë‹¨ê³„ì˜ ì£¼ì†Œê°€ ë‚˜ì˜¤ëŠ” ì‹ìœ¼ë¡œ ì—°ê²°ë˜ë©° ì´ 10ê°œì˜ ë¬¸ì œë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ëª¨ë“  ë¬¸ì œë¥¼ íŒŒì´ì¬ ì½”ë“œë¡œ í’€ì–´ë´¤ìŠµë‹ˆë‹¤.

## 33-1
- ë¬¸ì œ
  ```php
  <?php
  if($_GET['get']=="hehe") echo "<a href=???>Next</a>";
  else echo("Wrong");
  ?>
  ```


- í’€ì´<br>
  **get methodë¡œ hehe ë³€ìˆ˜ë¥¼ ë„˜ê²¨ì¤ë‹ˆë‹¤.**


  ```python
  def solve_1(session):
      response = session.get("https://webhacking.kr/challenge/bonus-6/?get=hehe")
      next_link = get_link(response)
      print("solve 33-1 :",next_link)
      return next_link
  ```

## 33-2
- ë¬¸ì œ
  ```php
  <?php
  if($_POST['post']=="hehe" && $_POST['post2']=="hehe2") echo "<a href=???>Next</a>";
  else echo "Wrong";
  ?>
  ```

- í’€ì´<br>
  **Post methodë¡œ 'post','post2' ë³€ìˆ˜ì— ê°ê° 'hehe','hehe2'ë¥¼ ë„˜ê²¨ì¤ë‹ˆë‹¤.**


  ```python
  def solve_2(session,next_link):
      url = BASE_URL + next_link
      datas = {
          'post' : 'hehe',
          'post2' : 'hehe2'
      }
      response = session.post(url,data= datas)
      next_link = get_link(response)
      print("solve 33-2 :",next_link)
      return next_link
  ```


## 33-3
- ë¬¸ì œ
  ```php
  <?php
  if($_GET['myip'] == $_SERVER['REMOTE_ADDR']) echo "<a href=???>Next</a>";
  else echo "Wrong";
  ?>
  ```

- í’€ì´<br>
  **get methodë¡œ ë‚˜ì˜ ì•„ì´í”¼ë¥¼ ë„˜ê²¨ì¤ë‹ˆë‹¤.**

  ```python
  def solve_3(session,next_link):
      url = BASE_URL + next_link
      params = {
          'myip' : ip
      }
      response = session.get(url,params=params)
      next_link = get_link(response)
      print("solve 33-3 :",next_link)
      return next_link
  ```


## 33-4
- ë¬¸ì œ
  ```php
  <?php
  if($_GET['password'] == md5(time())) echo "<a href=???>Next</a>";
  else echo "hint : ".time();
  ?>
  ```

- í’€ì´<br>
  **í˜„ì¬ ì‹œê°„ì„ md5ë¡œ í•´ì‹œí•œ ê°’ì„ ë³´ë‚´ì¤ë‹ˆë‹¤**

  ```python
  def solve_4(session,next_link):
      url = BASE_URL + next_link
      current_time = int(time.time())
      md5_time = hashlib.md5(str(current_time).encode("ascii")).hexdigest()
      params = {
          'password' : md5_time
      }
      response = session.get(url,params=params)
      next_link = get_link(response)
      print("solve 33-4 :",next_link)
      return next_link
  ```


## 33-5
- ë¬¸ì œ
  ```php
  <?php
  if($_GET['imget'] && $_POST['impost'] && $_COOKIE['imcookie']) echo "<a href=???>Next</a>";
  else echo "Wrong";
  ?>
  ```

- í’€ì´<br>
  **post methodë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ”ë°, ë§¤ê°œë³€ìˆ˜ë¡œ 'imget', post ë°ì´í„°ë¡œ 'impost', ì¿ í‚¤ë¡œ 'imcookie'ë¥¼ ì„¤ì •í•´ì„œ ì „ì†¡í•´ ì¤ë‹ˆë‹¤.**

  ```python
  def solve_5(session,next_link):
      url = BASE_URL + next_link
      params = {'imget': '1' }
      datas = {'impost': '1'}
      cookies = {'imcookie':'1'}

      response = session.post(url,data=datas,params=params,cookies=cookies)
      next_link = get_link(response)
      print("solve 33-5 :",next_link)
      return next_link
  ```


## 33-6
- ë¬¸ì œ
  ```php
  <?php
  if($_COOKIE['test'] == md5($_SERVER['REMOTE_ADDR']) && $_POST['kk'] == md5($_SERVER['HTTP_USER_AGENT'])) echo "<a href=???>Next</a>";
  else echo "hint : {$_SERVER['HTTP_USER_AGENT']}";
  ?>
  ```

- í’€ì´<br>
  **Cookieë¡œëŠ” 'test'ì´ë¦„ìœ¼ë¡œ ë‚˜ì˜ ipë¥¼ í•´ì‹œí•œ ê°’ì„ ë³´ë‚´ì£¼ê³ , post dataë¡œëŠ” 'kk'ì´ë¦„ìœ¼ë¡œ USER_AGENTê°’ì„ í•´ì‹œí•´ì„œ ë³´ë‚´ì¤ë‹ˆë‹¤.**

  ```python
  def solve_6(session,next_link):
      url = BASE_URL + next_link

      cookie_test = hashlib.md5(ip.encode('ascii')).hexdigest()
      cookies = {'test' : cookie_test}

      my_user_agent = session.headers['User-Agent']
      data_kk = hashlib.md5(my_user_agent.encode('ascii')).hexdigest()
      data = {'kk':data_kk}

      response = session.post(url,cookies=cookies,data=data)
      next_link = get_link(response)
      print("solve 33-6 :",next_link)
      return next_link
  ```


## 33-7
- ë¬¸ì œ
  ```php
  <?php
  $_SERVER['REMOTE_ADDR'] = str_replace(".","",$_SERVER['REMOTE_ADDR']);
  if($_GET[$_SERVER['REMOTE_ADDR']] == $_SERVER['REMOTE_ADDR']) echo "<a href=???>Next</a>";
  else echo "Wrong<br>".$_GET[$_SERVER['REMOTE_ADDR']];
  ?>
  ```

- í’€ì´<br>
  **GET ìš”ì²­ìœ¼ë¡œ ë¬¸ì œì—ì„œì™€ ë™ì¼í•˜ê²Œ '.'ì„ ì œê±°í•œ ë‹¤ìŒì— ì „ì†¡í•©ë‹ˆë‹¤.**

  ```python
  def solve_7(session,next_link):
      url = BASE_URL + next_link

      replaced_ip = ip.replace('.','')
      params = {replaced_ip : replaced_ip}

      response = session.get(url,params=params)
      next_link = get_link(response)
      print("solve 33-7 :",next_link)
      return next_link
  ```


## 33-8
- ë¬¸ì œ
  ```php
  <?php
  extract($_GET);
  if(!$_GET['addr']) $addr = $_SERVER['REMOTE_ADDR'];
  if($addr == "127.0.0.1") echo "<a href=???>Next</a>";
  else echo "Wrong";
  ?>
  ```

- í’€ì´<br>
  **GET ìš”ì²­ìœ¼ë¡œ 'addr'ë³€ìˆ˜ì— '127.0.0.1'ì„ ë„£ì–´ì„œ ë³´ë‚´ì¤ë‹ˆë‹¤.**

  ```python
  def solve_8(session,next_link):
      url = BASE_URL + next_link
      params = {'addr' : '127.0.0.1'}

      response = session.get(url,params=params)
      next_link = get_link(response)
      print("solve 33-8 :",next_link)
      return next_link
  ```

## 33-9
- ë¬¸ì œ
  ```php
  <?php
  for($i=97;$i<=122;$i=$i+2){
    $answer.=chr($i);
  }
  if($_GET['ans'] == $answer) echo "<a href=???.php>Next</a>";
  else echo "Wrong";
  ?>
  ```

- í’€ì´<br>
  **íŒŒì´ì¬ìœ¼ë¡œ ë¬¸ì œì—ì„œ ì œì‹œí•œ ë¡œì§ê³¼ ë™ì¼í•˜ê²Œ êµ¬í˜„í•œ ë‹¤ìŒ ë³´ë‚´ì¤ë‹ˆë‹¤.**
  
  ```python
  def solve_9(session,next_link):
      url = BASE_URL + next_link
      answer = ''
      for i in range(97,123,2):
          answer += chr(i)
      params = {'ans':answer}

      response = session.get(url,params=params)
      next_link = get_link(response)
      print("solve 33-9 :",next_link)
      return next_link
  ```


## 33-10
- ë¬¸ì œ
  ```php
  <?php
  $ip = $_SERVER['REMOTE_ADDR'];
  for($i=0;$i<=strlen($ip);$i++) $ip=str_replace($i,ord($i),$ip);
  $ip=str_replace(".","",$ip);
  $ip=substr($ip,0,10);
  $answer = $ip*2;
  $answer = $ip/2;
  $answer = str_replace(".","",$answer);
  $f=fopen("answerip/{$answer}_{$ip}.php","w");
  fwrite($f,"<?php include \"../../../config.php\"; solve(33); unlink(__FILE__); ?>");
  fclose($f);
  ?>
  ```

- í’€ì´<br>
  **íŒŒì´ì¬ìœ¼ë¡œ ë¬¸ì œì—ì„œ ì œì‹œí•œ ë¡œì§ê³¼ ë™ì¼í•˜ê²Œ êµ¬í˜„í•œ ë‹¤ìŒ ë³´ë‚´ì¤ë‹ˆë‹¤. í•˜ë‚˜ ë‹¤ë¥¸ì ì€ íŒŒì´ì¬ì€ 4/2ê°€ 2.0ìœ¼ë¡œ í‘œì‹œë˜ê³ , phpëŠ” 2ë¡œ í‘œì‹œë˜ì–´ ê²°ê³¼ê°€ ë‹¬ë¼ì„œ ì´ë¶€ë¶„ë§Œ ë‹¤ë¥´ê²Œ êµ¬í˜„í•´ ì¤ë‹ˆë‹¤.**
  
  ```python
  def solve_10(session,next_link):
      url = BASE_URL + next_link

      session.get(url)
      my_ip = ip

      i = 0
      while(len(my_ip) > i):
          my_ip = my_ip.replace(str(i),str(ord(str(i)[0])))
          i +=1
      my_ip = my_ip.replace('.','')
      my_ip = my_ip[0:10]
      answer = int(my_ip) *2
      # phpëŠ” 4/2ê°€ 2ì´ê³ , pythonì€ 2.0ì´ë‹¤.
      answer = int(int(my_ip) /2) if int(my_ip) %2 == 0 else int(my_ip) / 2
      answer = str(answer).replace(".","")
      flag_path  = url[:-11]+ '/answerip/{}_{}.php'.format(answer,my_ip)
      response = session.get(flag_path)

      print(response.text)
  ```







# ì „ì²´ ì½”ë“œ
  <script src="https://gist.github.com/kangmyoungseok/aae3bca1655053432ca54ea94cf6bba9.js"></script>

  ![image](https://user-images.githubusercontent.com/33647663/152668678-03807406-dc71-4558-b0f3-4a473d6e5563.png)
