---
title: "[webhacking.kr] 25ë²ˆ ë¬¸ì œ í’€ì´[PHP]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - php
toc: true
toc_sticky: true
toc_label: "25ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 25ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´
  ![image](https://user-images.githubusercontent.com/33647663/151703268-b8b8fd25-b195-402c-9776-1e3c06613dc2.png)

  ![image](https://user-images.githubusercontent.com/33647663/151703298-7520b274-e6c7-449f-906e-10907d59a450.png)


## ë¬¸ì œ í’€ì´
  ë³¸ ë¬¸ì œëŠ” file = [íŒŒì¼ì´ë¦„]ì„ ì£¼ë©´, í•´ë‹¹ íŒŒì¼ì´ ì‹¤í–‰ì´ ë˜ê³  ìˆëŠ” êµ¬ì¡°ë¡œ ë³´ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  flag.phpíŒŒì¼ì„ ë³´ë‹ˆ, ì§€ê¸ˆì€ í•´ë‹¹ íŒŒì¼ì´ ì‹¤í–‰ë˜ì–´ ```FLAG is in the code```ê°€ ì¶œë ¥ë˜ì—ˆìœ¼ë©°, íŒíŠ¸ë¥¼ ë³´ê³  ì¶”ì¸¡ì„ í•´ë³´ë©´ í•´ë‹¹ íŒŒì¼ì´ ì‹¤í–‰ë˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ì½”ë“œê°€ ë‚˜ì˜¤ë©´ í”Œë˜ê·¸ë¥¼ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ì´ë¥¼ ì•Œê¸° ìœ„í•´ì„œëŠ” Wrapperì˜ ê°œë…ì´ í•„ìš”í•©ë‹ˆë‹¤. 

### Wrapper
  php wrapperì˜ ê°œë…ì˜ ê²½ìš° php.netì˜ [ê³µì‹ë¬¸ì„œ](https://www.php.net/manual/en/wrappers.php)ì— ìì„¸íˆ ë‚˜ì™€ìˆìŠµë‹ˆë‹¤.
  phpì—ëŠ” íŒŒì¼ì˜ ì´ë¦„ì´ ì£¼ì–´ ì¡Œì„ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ë¡œì»¬ì— ìˆëŠ” íŒŒì¼ì´ë¼ê³  ê°€ì •í•˜ì—¬ í•´ë‹¹ íŒŒì¼ì˜ ê²½ë¡œë¥¼ í•´ì„í•©ë‹ˆë‹¤. í˜„ì¬ ë¬¸ì œì—ì„œëŠ” index.php ë¼ëŠ” íŒŒì¼ëª…ì´ ì£¼ì–´ì§„ë‹¤ë©´, í•´ë‹¹ íŒŒì¼ì´ ì‹¤í–‰ë˜ëŠ” ë¡œì»¬ì˜ ./index.php íŒŒì¼ì„ ê¸°ë³¸ì ìœ¼ë¡œ ì°¾ê²Œ ë˜ëŠ” ì›ë¦¬ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¤ì–‘í•œ Wrapperë“¤ì„ ì´ìš©í•˜ì—¬ ì™¸ë¶€ì˜ ìˆëŠ” íŒŒì¼ì„ ì½ì–´ ë“¤ì¼ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´  http://example.com/index.php ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì™¸ë¶€ì˜ íŒŒì¼ì„ ì—´ ìˆ˜ë„ ìˆë‹¤ëŠ” ê²ƒì´ì£ . 

  ë‹¤ìŒ ê·¸ë¦¼ì´ phpì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ wrapperë“¤ì˜ ì¢…ë¥˜ì…ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/151704619-07b2488b-975b-4ca3-9cb4-923fb4239606.png)


  ì €ëŠ” ì´ë²ˆ ë¬¸ì œë¥¼ í’€ë•Œ ```php://``` wrapperë¥¼ ì´ìš©í•˜ê² ìŠµë‹ˆë‹¤.

### php filter wrapper
  
  php filterëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
  ```md
  php://filter/read=[í•„í„° ì¢…ë¥˜]/resource=[íŒŒì¼ ìœ„ì¹˜]
  ```

  ìœ„ì˜ ë°©ì‹ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´, resoucreë¡œ ì¤€ íŒŒì¼ì„ ì£¼ì–´ì§„ í•„í„°ë¡œ ë³€í™˜í•˜ì—¬ íŒŒì¼ì„ ì½ê²Œ ë©ë‹ˆë‹¤. 

  ë‹¤ìŒì€ php ê³µì‹ ë¬¸ì„œì— ë‚˜ì™€ìˆëŠ” ì˜ˆì œì…ë‹ˆë‹¤.

  ```php
  <?php
  /* This will output the contents of
    www.example.com entirely in uppercase */
  readfile("php://filter/read=string.toupper/resource=http://www.example.com");

  /* This will do the same as above
    but will also ROT13 encode it */
  readfile("php://filter/read=string.toupper|string.rot13/resource=http://www.example.com");
  ?>

  ```
  
  ìœ„ì˜ ì˜ˆì œëŠ” ```http://www.example.com```íŒŒì¼ì„ **string.toupper** í•„í„°ì™€ **string.rot13**í•„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ í•„í„°ë§ í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

  php filter ì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•œ í•„í„°ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤
  - **String filters:** string.rot13, string.toupper, string.tolower 
  - **conversion filters:** convert.base64-encode and convert.base64-decode, convert.quoted-printable-encode and convert.quoted-printable-decode, convert.iconv.* 
  - **Compression filters:** zlib.deflate and zlib.inflate, bzip2.compress and bzip2.decompress 
  - **Encryption filters:** mcrypt.* and mdecrypt.*
  

### ë¬¸ì œ í’€ì´
  ë³¸ ë¬¸ì œì—ì„œëŠ” ìœ„ì˜ php filter wrapperë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```md
  php://filter/read=string.rot13/resource=flag
  ```

  ![image](https://user-images.githubusercontent.com/33647663/151705037-254cfde8-4f1f-4829-a8c5-bc1ce17cb866.png)

  í™”ë©´ì—ëŠ” php ì½”ë“œê°€ rot13ìœ¼ë¡œ ì¸ì½”ë”©ë˜ì–´ ì¶œë ¥ë˜ì–´ í•´ë‹¹ ì½”ë“œê°€ phpë¡œ ì¸ì‹ë˜ì§€ ì•Šì•„ì„œ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í•´ë‹¹ ì½”ë“œë¥¼ ë‹¤ì‹œ rot13ìœ¼ë¡œ ë””ì½”ë”© í•˜ë©´ ì½”ë“œê°€ ë³´ì…ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/151705101-9f07d679-9552-4833-ab01-532689969451.png)

  í”Œë˜ê·¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
  ```md
  FLAG{this_is_your_first_flag}
  ```

## ì¶”ê°€ ë¬¸ì œ ë¶„ì„
  í•´ë‹¹ ë¬¸ì œëŠ” í’€ì—ˆì§€ë§Œ ê°™ì€ ë°©ì‹ìœ¼ë¡œ index.phpë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

  ```php
  <html>
  <head>
  <meta http-equiv=Content-Type content="text/html; charset=euc-kr">
  <title>Challenge 25</title>
  <style type="text/css">
  body { background:black; color:white; font-size:10pt; }
  textarea { background:silver; color:black; fnot-size:9pt; }
  </style>
  </head>
  <body>
  <?php
    echo("<pre>");
    system("ls -al");
    echo("</pre>");
    if(!$_GET['file']) echo("<meta http-equiv=refresh content=0;url=?file=hello>");
    echo "<hr><textarea rows=10 cols=100>";
    $file = $_GET['file'].".php";
    if($file == "index.php") exit(); // anti infinite loop
    include $file;
    echo "</textarea>";
  ?>
  </body>
  </html>
  ```

  ë³´ì‹œë©´ include $file ë¶€ë¶„ì—ì„œ ì£¼ì–´ì§€ëŠ” íŒŒì¼ ìì²´ë¥¼ include ì‹œí‚¤ê¸° ë–„ë¬¸ì— phpì½”ë“œë¡œ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°ë¡œ ë¬¸ì œë¥¼ ì¶œì œí•œ ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.



  
  