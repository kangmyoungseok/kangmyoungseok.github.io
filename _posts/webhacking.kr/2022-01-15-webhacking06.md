---
title: "[webhacking.kr] 6ë²ˆ ë¬¸ì œ í’€ì´[base64]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - base64
toc: true
toc_sticky: true
toc_label: "6ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 6ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ

## ì†ŒìŠ¤ì½”ë“œ
 ```php
  <?php
  include "../../config.php";
  if($_GET['view_source']) view_source();
  if(!$_COOKIE['user']){
    $val_id="guest";
    $val_pw="123qwe";
    for($i=0;$i<20;$i++){
      $val_id=base64_encode($val_id);
      $val_pw=base64_encode($val_pw);
    }
    $val_id=str_replace("1","!",$val_id);
    $val_id=str_replace("2","@",$val_id);
    $val_id=str_replace("3","$",$val_id);
    $val_id=str_replace("4","^",$val_id);
    $val_id=str_replace("5","&",$val_id);
    $val_id=str_replace("6","*",$val_id);
    $val_id=str_replace("7","(",$val_id);
    $val_id=str_replace("8",")",$val_id);

    $val_pw=str_replace("1","!",$val_pw);
    $val_pw=str_replace("2","@",$val_pw);
    $val_pw=str_replace("3","$",$val_pw);
    $val_pw=str_replace("4","^",$val_pw);
    $val_pw=str_replace("5","&",$val_pw);
    $val_pw=str_replace("6","*",$val_pw);
    $val_pw=str_replace("7","(",$val_pw);
    $val_pw=str_replace("8",")",$val_pw);

    Setcookie("user",$val_id,time()+86400,"/challenge/web-06/");
    Setcookie("password",$val_pw,time()+86400,"/challenge/web-06/");
    echo("<meta http-equiv=refresh content=0>");
    exit;
  }
  ?>
  <html>
  <head>
  <title>Challenge 6</title>
  <style type="text/css">
  body { background:black; color:white; font-size:10pt; }
  </style>
  </head>
  <body>
  <?php
  $decode_id=$_COOKIE['user'];
  $decode_pw=$_COOKIE['password'];

  $decode_id=str_replace("!","1",$decode_id);
  $decode_id=str_replace("@","2",$decode_id);
  $decode_id=str_replace("$","3",$decode_id);
  $decode_id=str_replace("^","4",$decode_id);
  $decode_id=str_replace("&","5",$decode_id);
  $decode_id=str_replace("*","6",$decode_id);
  $decode_id=str_replace("(","7",$decode_id);
  $decode_id=str_replace(")","8",$decode_id);

  $decode_pw=str_replace("!","1",$decode_pw);
  $decode_pw=str_replace("@","2",$decode_pw);
  $decode_pw=str_replace("$","3",$decode_pw);
  $decode_pw=str_replace("^","4",$decode_pw);
  $decode_pw=str_replace("&","5",$decode_pw);
  $decode_pw=str_replace("*","6",$decode_pw);
  $decode_pw=str_replace("(","7",$decode_pw);
  $decode_pw=str_replace(")","8",$decode_pw);

  for($i=0;$i<20;$i++){
    $decode_id=base64_decode($decode_id);
    $decode_pw=base64_decode($decode_pw);
  }

  echo("<hr><a href=./?view_source=1 style=color:yellow;>view-source</a><br><br>");
  echo("ID : $decode_id<br>PW : $decode_pw<hr>");

  if($decode_id=="admin" && $decode_pw=="nimda"){
    solve(6);
  }
  ?>
  </body>
  </html>
 ```
<br><br>

# í’€ì´
 ì‚¬ìš©ìë¡œë¶€í„° ë°›ì€ ì¿ í‚¤ê°’ì„ base64 ë””ì½”ë”© ë° ë¬¸ìì—´ ì¹˜í™˜ì„ ê±°ì³¤ì„ ë•Œ, ê²°ê³¼ê°™ì´ admin, nimda ë©´ ëœë‹¤.
 ```php
 if($decode_id=="admin" && $decode_pw=="nimda"){
    solve(6);
  }
 ```

 ì˜ˆì „ì—ëŠ” base64 ì¸ì½”ë”©, ë””ì½”ë”©ì„ í•´ì£¼ëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ ì´ìš©í•´ì„œ ë…¸ê°€ë‹¤ë¡œ í’€ì—ˆì—ˆëŠ”ë°, ì´ë²ˆì—ëŠ” íŒŒì´ì¬ ì½”ë“œë¥¼ ì§œì„œ í’€ì–´ë´¤ë‹¤.
 
 ìš°ì„  íŒŒì´ì¬ì—ì„œëŠ” base64ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ì„œ base64 ì¸ì½”ë”©, ë””ì½”ë”©ì„ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤.

 **base64 ì¸ì½”ë”© ì˜ˆì‹œ**
 ```python
  import base64

  name = 'myoungseok'          # 1. ë¬¸ìì—´
  name_bytes = name .encode('ascii')  # 2. bytesí˜• ë³€í™˜
  name_base64 = base64.b64encode(name_bytes)  #3. base64ì¸ì½”ë”©
  name_base64_str = name_base64.decode('ascii')   # ê²°ê³¼ê°’ ë¬¸ìì—´ë¡œ ë§Œë“¤ê¸°

  print(name)
  print(name_bytes)
  print(name_base64)
  print(name_base64_str)
  ```

  **ì‹¤í–‰ ê²°ê³¼**

  ```md
  myoungseok
  b'myoungseok'
  b'bXlvdW5nc2Vvaw=='
  bXlvdW5nc2Vvaw==
 ```
 
 ë”°ë¼ì„œ base64 ì¸ì½”ë”©ì€ ë°˜ë³µë¬¸ì„ ì´ìš©í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆë‹¤.

 ```python
  string = 'guest'
  string_bytes = string.encode('ascii')
  string_base64 = string_bytes

  for i in range(20):
      string_base64 = base64.b64encode(string_base64)

  string_base64_20_str = string_base64.decode('ascii')
 ```
 
 ê·¸ë‹¤ìŒì€ ë¬¸ìì—´ì„ ì£¼ì–´ì§„ ì¡°ê±´ì— ë§ì¶°ì„œ ì¹˜í™˜í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ replaceë¥¼ ì´ìš©í•´ì„œ í•´ì¤¬ë‹¤.

 ```python
  replace_str = string_base64_20_str
  replace_str = replace_str.replace("1","!")
  replace_str = replace_str.replace("2","@")
  replace_str = replace_str.replace("3","$")
  replace_str = replace_str.replace("4","^")
  replace_str = replace_str.replace("5","&")
  replace_str = replace_str.replace("6","*")
  replace_str = replace_str.replace("7","(")
  replace_str = replace_str.replace("8",")")
 ```

 ì´ë ‡ê²Œ í•´ì„œ ë‚˜ì˜¨ ê²°ê³¼ê°’ì„ í˜„ì¬ í˜ì´ì§€ì˜ ì¿ í‚¤ê°’ê³¼ ë¹„êµí•´ë³´ë‹ˆ ê²°ê³¼ê°€ ë˜‘ê°™ì•˜ë‹¤. ì´ì œ ì¸ì½”ë”© í•˜ëŠ” ê°’ì„ guestê°€ ì•„ë‹Œ admin,nimdaë¥¼ í•´ì£¼ê³  í•´ë‹¹ ê°’ì„ ì¿ í‚¤ ê°’ìœ¼ë¡œ ë„£ì–´ì£¼ë©´ ë¬¸ì œê°€ í’€ë¦´ ê²ƒì´ë‹¤.

 ìœ„ì˜ ì¸ì½”ë”© ê³¼ì •ì„ í•¨ìˆ˜ë¡œ êµ¬í˜„í•˜ì—¬, ì¸ìê°’ì— ë”°ë¼ì„œ ê²°ê³¼ë¥¼ ë±‰ì–´ ì£¼ë„ë¡ í•´ì¤¬ë‹¤.

 ```python
  def base64_encode_20(string):
      string_bytes = string.encode('ascii')
      string_base64 = string_bytes

      for i in range(20):
          string_base64 = base64.b64encode(string_base64)
          print(string_base64)

      string_base64_20_str = string_base64.decode('ascii')

      replace_str = string_base64_20_str
      replace_str = replace_str.replace("1","!")
      replace_str = replace_str.replace("2","@")
      replace_str = replace_str.replace("3","$")
      replace_str = replace_str.replace("4","^")
      replace_str = replace_str.replace("5","&")
      replace_str = replace_str.replace("6","*")
      replace_str = replace_str.replace("7","(")
      replace_str = replace_str.replace("8",")")

      return replace_str
 ```
 í•¨ìˆ˜ ì‹¤í–‰ ê²°ê³¼
 ```python
 base64_encode_20("admin")
 ```
 
 ```
 Vm0wd@QyUXlVWGxWV0d^V!YwZDRWMVl$WkRSV0!WbDNXa!JTVjAxV@JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll&U@tWVWJHaG9UVlZ$VlZadGNFSmxSbGw!VTJ0V!ZXSkhhRzlVVmxaM!ZsWmFjVkZ0UmxSTmJFcEpWbTEwYTFkSFNrZGpSVGxhVmpOU!IxcFZXbUZrUjA!R!UyMTRVMkpIZHpGV!ZFb$dWakZhV0ZOcmFHaFNlbXhXVm!wT!QwMHhjRlpYYlVaclVqQTFSMWRyV@&kV0!ERkZVbFJHVjFaRmIzZFdha!poVjBaT@NtRkhhRk&sYlhoWFZtMXdUMVF$TUhoalJscFlZbGhTV0ZSV@FFTlNiRnBZWlVaT!ZXSlZXVEpWYkZKRFZqQXhkVlZ!V@xaaGExcFlXa!ZhVDJOc@NFZGhSMnhUVFcxb@IxWXhaREJaVmxsM!RVaG9hbEpzY0ZsWmJGWmhZMnhXY!ZGVVJsTk&WMUo!VmpKNFQxWlhTbFpYVkVwV!lrWktTRlpxUm!GU@JVbDZXa!prYUdFeGNHOVdha0poVkRKT@RGSnJhR@hTYXpWeldXeG9iMWRHV@&STldHUlZUVlpHTTFSVmFHOWhiRXB*WTBac!dtSkdXbWhaTVZwaFpFZFNTRkpyTlZOaVJtOTNWMnhXWVZReFdsaFRiRnBZVmtWd!YxbHJXa$RUUmxweFVtMUdVMkpWYkRaWGExcHJZVWRGZUdOSE9WZGhhMHBvVmtSS!QyUkdTbkpoUjJoVFlYcFdlbGRYZUc&aU!XUkhWMjVTVGxOSGFGQlZiVEUwVmpGU!ZtRkhPVmhTTUhCNVZHeGFjMWR0U@tkWGJXaGFUVzVvV0ZreFdrZFdWa$B*VkdzMVYySkdhM@hXYTFwaFZURlZlRmR!U@s!WFJYQnhWVzB^YjFZeFVsaE9WazVPVFZad@VGVXlkREJXTVZweVkwWndXR0V^Y0ROV@FrWkxWakpPU!dKR!pGZFNWWEJ@Vm!0U!MxUXlUWGxVYTFwb!VqTkNWRmxZY0ZkWFZscFlZMFU!YVUxcmJEUldNalZUVkd^a!NGVnNXbFZXYkhCWVZHdGFWbVZIUmtoUFYyaHBVbGhDTmxkVVFtRmpNV!IwVTJ0a!dHSlhhR0ZVVnpWdlYwWnJlRmRyWkZkV@EzQjZWa@R*TVZZd0!WWmlla!pYWWxoQ!RGUnJXbEpsUm!SellVWlNhVkp!UW&oV!YzaHJWVEZzVjFWc!dsaGlWVnBQVkZaYWQyVkdWWGxrUkVKWFRWWndlVmt$V@&kWFIwVjRZMFJPV@!FeVVrZGFWM@hIWTIxS!IxcEhiRmhTVlhCS!ZtMTBVMU!^VlhoWFdHaFlZbXhhVjFsc!pHOVdSbXhaWTBaa@JHSkhVbGxhVldNMVlWVXhXRlZyYUZkTmFsWlVWa@Q0YTFOR!ZuTlhiRlpYWWtoQ!NWWkdVa@RWTVZwMFVtdG9VRll&YUhCVmJHaERUbXhrVlZGdFJtcE&WMUl$VlRKMGExZEhTbGhoUjBaVlZucFdkbFl$V@&OT@JFcHpXa@R$YVZORlNrbFdNblJyWXpGVmVWTnVTbFJpVlZwWVZGYzFiMWRHWkZkWGJFcHNVbTFTZWxsVldsTmhWa$AxVVd^d!YySllVbGhhUkVaYVpVZEtTVk&zYUdoTk!VcFZWbGN^TkdReVZrZFdiR!JvVW&wc@IxUldXbmRsYkZsNVkwVmtWMDFFUmpGWlZXaExWMnhhV0ZWclpHRldNMmhJV!RJeFMxSXhjRWhpUm!oVFZsaENTMVp0TVRCVk!VMTRWbGhvV0ZkSGFGbFpiWGhoVm!^c@NscEhPV$BTYkhCNFZrY$dOVll^V@&OalJXaFlWa!UxZGxsV!ZYaFhSbFp&WVVaa!RtRnNXbFZXYTJRMFdWWktjMVJ!VG!oU@JGcFlXV$hhUm!ReFduRlJiVVphVm0xU!NWWlhkRzloTVVwMFlVWlNWVlpXY0dGVVZscGhZekZ$UlZWdGNFNVdNVWwzVmxSS0!HRXhaRWhUYkdob!VqQmFWbFp0ZUhkTk!WcHlWMjFHYWxacmNEQmFSV!F$VmpKS@NsTnJhRmRTTTJob!ZrUktSMVl^VG&WVmJFSlhVbFJXV!ZaR!l*RmlNV!JIWWtaV!VsZEhhRlJVVm!SVFpXeHNWbGRzVG!oU!ZFWjZWVEkxYjFZeFdYcFZiR@hZVm!^d!lWcFZXbXRrVmtwelZtMXNWMUl*YURWV0!XUXdXVmRSZVZaclpGZGliRXB&Vld0V!MySXhiRmxqUldSc!ZteEtlbFp0TURWWFIwcEhZMFpvV@sxSGFFeFdNbmhoVjBaV@NscEhSbGROTW!oSlYxUkplRk!^U!hoalJXUmhVbXMxV0ZZd!ZrdE&iRnAwWTBWa!dsWXdWalJXYkdodlYwWmtTR0ZHV@xwaVdHaG9WbTE0YzJOc!pISmtSM0JUWWtad0&GWlhNVEJOUmxsNFYyNU9hbEpYYUZoV@FrNVRWRVpzVlZGWWFGTldhM0I@VmtkNFlWVXlTa!pYV0hCWFZsWndSMVF^V@tOVmJFSlZUVVF$UFE9PQ==
 ```

 ```python
 base64_encode_20("nimda")
 ```

 ```
 Vm0wd@QyUXlVWGxWV0d^V!YwZDRWMVl$WkRSV0!WbDNXa!JTVjAxV@JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll&U@tWVWJHaG9UVlZ$VlZacVFtRlRNbEpJVm!0a!dHSkdjRTlaVjNSR!pVWmFkR0&GU@!^U@JHdzFWVEowVjFaWFNraGhSemxWVmpOT00xcFZXbUZrUjA!R!drWndWMDFFUlRGV!ZFb$dWakZhV0ZOcmFHaFNlbXhXVm0xNFlVMHhXbk&YYlVaclVqQTFSMWRyV@xOVWJVcEdZMFZ$VjJKVVJYZFdha!pYWkVaT@MxZHNhR@xTTW!oWlYxZDRiMkl&Vm&OVmJGWlRZbFZhY@xWcVFURlNNVlY!VFZSU!ZrMXJjRWxhU0hCSFZqRmFSbUl*WkZkaGExcG9WakJhVDJOdFJraGhSazVzWWxob!dGWnRNSGhPUm!^V!RVaG9XR0pyTlZsWmJGWmhZMVphZEdSSFJrNVNiRm9$V@xWYVQxWlhTbFpqUldSYVRVWmFNMVpxU@t0V!ZrcFpXa!p$VjFKV@NIbFdWRUpoVkRKT@MyTkZhR$BTYXpWWVZXcE9iMkl^V@&STldHUlZUVlpXTkZVeGFHOWhiRXB*WTBac!dtSkdXbWhaTW&oWFkxWkdWVkpzVGs!WFJVcElWbXBLTkZReFdsaFRhMlJxVW0xNGFGVXdhRU&UUmxweFVtMUdVMkpWYkRaWGExcHJZVWRGZUdOSE9WZGhhMHBvVmtSS!QyUkdTbkpoUjJoVFlYcFdlbGRYZUc&aU!XUkhWMjVTVGxOSGFGQlZiVEUwVmpGU!ZtRkhPVmhTTUhCNVZHeGFjMWR0U@tkWGJXaGFUVzVvV0ZreFdrZFdWa$B*VkdzMVYySkdhM@hXYTFwaFZURlZlRmR!U@s!WFJYQnhWVzB^YjFZeFVsaE9WazVPVFZad@VGVXlkREJXTVZweVkwWndXR0V^Y0ROV@FrWkxWakpPU!dKR!pGZFNWWEJ@Vm!0U!MxUXlUWGxVYTFwb!VqTkNWRmxZY0ZkWFZscFlZMFU!YVUxcmJEUldNV@h@V!ZaS!IxTnNaRlZXYkZwNlZHeGFZVmRGTlZaUFZtaFRUVWhDU@xac!pEUmpNV!IwVTJ0b@FGSnNTbGhVVlZwM!ZrWmFjVk&yWkZOaVJrcDZWa@N^YzFVeVNuSlRiVVpYVFc!b!dGbHFTa!psUm!SWldrVTFWMVpzY0ZWWFZsSkhaREZaZUdKSVNsaGhNMUpVVlcxNGQyVkdWbGRoUnpsb!RWWndlbFl&Y0VkV0!ERjFZVWhLV@xaWFVrZGFWM@hIWTIxS!IyRkdhRlJTVlhCS!ZtMTBVMU!^VlhoWFdHaFlZbXhhVjFsc!pHOVdSbXhaWTBaa@JHSkhVbGxhVldNMVlWVXhXRlZyYUZkTmFsWlVWa@Q0YTFOR!ZuTlhiRlpYWWtoQ!NWWkdVa@RWTVZwMFVtdG9VRll&YUhCVmJHaERUbXhrVlZGdFJtcE&WMUl$VlRKMGExZEhTbGhoUjBaVlZucFdkbFl$V@&KbFJtUnlXa!prVjJFelFqWldhMlI@VFZaWmQwMVdXbWxsYTFwWVdXeG9RMVJHVW&KWGJFcHNVbTFTZWxsVldsTmhWa$AxVVd^d!YySllVbGhhUkVaYVpVZEtTVk&zYUdoTk!VcFdWbGN^TkdReVZrZFdXR$hyVWpCYWNGVnRlSGRsYkZsNVpVaGtXRkl$VmpSWk!GSlBWMjFGZVZWclpHRldNMmhJV!RJeFMxSXhjRWhpUm!oVFZsaENTMVp0TVRCVk!VMTRWbGhvV0ZkSGFGbFpiWGhoVm!^c@NscEhPV$BTYkhCNFZrY$dOVll^V@&OalJXaFlWa!UxZGxsV!ZYaFhSbFp&WVVaa!RtRnNXbFZXYTJRMFdWWktjMVJ!VG!oU@JGcFlXV$hhUm!ReFduRlJiVVphVm0xU!NWWlhkRzloTVVwMFlVWlNWVlpXY0dGVVZscGhZekZ$UlZWdGNFNVdNVWwzVmxSS0!HRXhaRWhUYkdob!VqQmFWbFp0ZUhkTk!WcHlWMjFHYWxacmNEQmFSV!F$VmpKS@NsTnJhRmRTTTJob!ZrUktSMVl^VG&WVmJFSlhVbFJXV!ZaR!l*RmlNV!JIWWtaV!VsZEhhRlJVVm!SVFpXeHNWbGRzVG!oU!ZFWjZWVEkxYjFZeFdYcFZiR@hZVm!^d!lWcFZXbXRrVmtwelZtMXNWMUl*YURWV0!XUXdXVmRSZVZaclpGZGliRXB&Vld0V!MySXhiRmxqUldSc!ZteEtlbFp0TURWWFIwcEhZMFpvV@sxSGFFeFdNbmhoVjBaV@NscEhSbGROTW!oSlYxUkplRk!^U!hoalJXUmhVbXMxV0ZZd!ZrdE&iRnAwWTBWa!dsWXdWalJXYkdodlYwWmtTR0ZHV@xwaVdHaG9WbTE0YzJOc!pISmtSM0JUWWtad0&GWlhNVEJOUmxsNFYyNU9hbEpYYUZoV@FrNVRWRVpzVlZGWWFGTldhM0I@VmtkNFlWVXlTa!pYV0hCWFZsWndSMVF^V@tOVmJFSlZUVVF$UFE9PQ==
 ```

 ìœ„ì˜ ê°’ë“¤ì„ ì¿ í‚¤ì— ë„£ì–´ì£¼ë©´ ëœë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/149611986-be3ae58e-91aa-4053-8c50-53d6b40f0102.png)

 ë¬¸ì œ í•´ê²°!

 ![image](https://user-images.githubusercontent.com/33647663/149612030-b6f00960-fbed-4173-b073-bc9e7ae6cf0f.png)
 
 ì œê°€ ì“´ ë¬¸ì œ í’€ì´ ì½”ë“œëŠ” [ê¹ƒí—ˆë¸Œ](https://github.com/kangmyoungseok/webhacking-kr/blob/main/06-base64.py)ì— ì˜¬ë ¤ ë†“ì„í…Œë‹ˆ ì°¸ê³  í•˜ì…”ë„ ë©ë‹ˆë‹¤.