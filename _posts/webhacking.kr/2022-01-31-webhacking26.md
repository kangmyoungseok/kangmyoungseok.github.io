---
title: "[webhacking.kr] 26ë²ˆ ë¬¸ì œ í’€ì´[php]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - php
toc: true
toc_sticky: true
toc_label: "26ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 26ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´
  ![image](https://user-images.githubusercontent.com/33647663/151707963-ccbc93a7-e335-41f6-8a02-020959c73d8d.png)


## ë¬¸ì œ ì†ŒìŠ¤ ì½”ë“œ
  ```php
  <?php
    if(preg_match("/admin/",$_GET['id'])) { echo"no!"; exit(); }
    $_GET['id'] = urldecode($_GET['id']);
    if($_GET['id'] == "admin"){
      solve(26);
    }
  ?>
  ```

  
## ë¬¸ì œ í’€ì´
  í•´ë‹¹ ë¬¸ì œëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³´ë‚¸ idë¥¼ í•œë²ˆ ë” urldecodeë¥¼ í•œ ë‹¤ìŒ í•´ë‹¹ ê°’ì´ ```admin```ì¸ ê²½ìš° í´ë¦¬ì–´ ë˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤.

  ìš°ì„  ê¸°ë³¸ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ getì´ë‚˜, postë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´ urlEncodingì´ ìˆ˜í–‰ë˜ê³ , ì„œë²„ì¸¡ì—ì„œ ë°ì´í„°ë¥¼ ë°›ìœ¼ë©´ urlDecodingì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ì— ë”°ë¼ ê¸°ë³¸ì ìœ¼ë¡œ ì„œë²„ì—ì„œëŠ” ë¬´ì¡°ê±´ í•œë²ˆì˜ urlDecodingì„ ìˆ˜í–‰í•œë‹¤ëŠ” ê²ƒì„ ìƒê°í•˜ê³  ë¬¸ì œë¥¼ ì ‘ê·¼í•˜ë©´ ë©ë‹ˆë‹¤.

  ìš°ì„  idì— ë‹¤ìŒê³¼ ê°™ì´ adminì˜ ì•„ìŠ¤í‚¤ì½”ë“œ í‘œí˜„ ê°’ì¸ %61%64%6d%69%6eë¡œ ì„œë²„ë¡œ ë³´ë‚´ë©´ ìœ„ì—ì„œ ì„¤ëª…í–ˆë‹¤ì‹œí”¼ ë¬´ì¡°ê±´ í•œë²ˆì€ urldecodingì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì—, ì²« ë²ˆì§¸ preg_matchì—ì„œëŠ” ```admin```ìœ¼ë¡œ ë“¤ì–´ê°€ì„œ noê°€ ì¶œë ¥ë˜ê²Œ ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/151708255-24077d6d-fabe-4117-9dd8-7e9de957d314.png)
  ![image](https://user-images.githubusercontent.com/33647663/151708260-e4fe1af0-41f3-418d-8eec-d44b70dd0eb5.png)


  ì„œë²„ì—ì„œ urldecodingì´ í•œë²ˆ ë” ëœë‹¤ëŠ” ê²ƒì„ ìƒê°í•˜ê³  ì„œë²„ì—ì„œ í•œë²ˆì˜ urlë””ì½”ë”©ì„ ìˆ˜í–‰í•˜ê³  ë‚¬ì„ ë•Œ, ```%61%64%6d%69%6e```ê°€ ë‚˜ì˜¤ë„ë¡ í•˜ê²Œ ë©ë‹ˆë‹¤. ìœ„ì˜ **%**ê°’ì„ urlencoding ë°©ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´ **%25**ê°€ ë©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì´ë¥¼ í’€ì–´ì„œ ì“°ë©´ ë©ë‹ˆë‹¤. 

  ```%2561%2564%256d%2569%256e```

  ê·¸ëŸ¬ë©´ ë‹¤ìŒ ì²˜ëŸ¼ ë‘ ë²ˆì— ê±¸ì³ì„œ ë””ì½”ë”©ì´ ìˆ˜í–‰ë˜ë©´ì„œ preg_match í•„í„°ë§ì€ ìš°íšŒí•˜ê³ , ë¬¸ì œë¥¼ í’€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  1. ```%2561%2564%256d%2569%256e``` -> ```%61%64%6d%69%6e```   
  2. ```%61%64%6d%69%6e```  -> ```admin```


  ![image](https://user-images.githubusercontent.com/33647663/151708420-dd5139f5-8ee9-44c0-8831-adf0287b98fe.png)


