---
title: "[webhacking.kr] 23ë²ˆ ë¬¸ì œ í’€ì´[php]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - php
toc: true
toc_sticky: true
toc_label: "23ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 23ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´
  ![image](https://user-images.githubusercontent.com/33647663/150950543-c6e912ce-e97b-40e6-bf4f-19cb15ac52c5.png)

## ë¬¸ì œ í’€ì´
  ì…ë ¥ ì¹¸ì— ì—¬ëŸ¬ ë‹¨ì–´ë¥¼ ì…ë ¥í•´ ë³´ë©´ì„œ ë¬´ì—‡ì´ í•„í„°ë§ ë˜ëŠ”ì§€ ë¨¼ì € í™•ì¸í•©ë‹ˆë‹¤.

  ëª‡ê°œì˜ ë‹¨ì–´ë¥¼ ì…ë ¥í•´ë³´ë‹ˆ php ì„œë²„ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬ ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

  ```php
  if (preg_match('/[A-Za-z]{2,}/', $_GET['code'])) {
      echo "no hack <br>";
  } else {
      echo "{$_GET['code']}<br>";
  }
  ```

  ìˆ«ìë¥¼ ì œì™¸í•˜ê³  ë¬¸ìë¥¼ 2ê°œ ì—°ì† ì…ë ¥í•˜ë©´ no hackì„ ì¶œë ¥í•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ëª‡ê°œë¥¼ í…ŒìŠ¤íŠ¸ í•´ë³´ë‹ˆ preg_match ë¶€ë¶„ì€ ë¬¸ìì—´ ì¤‘ê°„ì— null byte(0x00)ë¥¼ ë¼ì›Œ ë„£ìœ¼ë©´ ë‹¤ë¥´ê²Œ íŒë‹¨ í•©ë‹ˆë‹¤.

  ex)
  admin != ad%00min

  ì´ë¥¼ ì´ìš©í•´ì„œ ì…ë ¥í•  ```<script> alert(1); </script>``` ì¤‘ê°„ì¤‘ê°„ì— preg_match ì— ì˜í•´ì„œ í•„í„°ë§ ë˜ì§€ ì•Šë„ë¡ null byteë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.

  ```<s%00c%00r%00i%00p%00t>a%00l%00e%00r%00t(1);</s%00c%00r%00i%00p%00t>```


  ![image](https://user-images.githubusercontent.com/33647663/150971471-87e799de-7864-4988-b4d1-8dfb32b1de88.png)
  


