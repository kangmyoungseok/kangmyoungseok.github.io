---
title: "[webhacking.kr] 5ë²ˆ ë¬¸ì œ í’€ì´[JavaScript]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - javascript
toc: true
toc_sticky: true
toc_label: "5ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
---

ğŸ’¡ Webhacking.kr challenge(old) 5ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´
  ê·¸ë¦¼ê³¼ ê°™ì´ Login ë²„íŠ¼ê³¼ join ë²„íŠ¼ì´ ìˆìŠµë‹ˆë‹¤.
  ë¨¼ì € ë¡œê·¸ì¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì•„ì´ë”” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë ¤ ë¡œê·¸ì¸ í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150665116-1a993ee4-9d31-465a-aa9a-fb7867882202.png)

  ìš°ì„  id/pwì— **guest/guest , admin/admin**ì„ ì…ë ¥í•´ë´¤ë”ë‹ˆ, **Wrong password**ë¼ëŠ” ë¬¸êµ¬ê°€ ë‚˜ì˜µë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150665158-e9626a28-80c3-405d-a5e6-71d1260df688.png)

  ë‹¤ì‹œ ë©”ì¸í˜ì´ì§€ì—ì„œ Join ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‹¤ìŒê³¼ ê°™ì´ Access Denied ë©”ì‹œì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤

  ![image](https://user-images.githubusercontent.com/33647663/150665187-63023013-f61b-49ac-a6de-34f83231b8f3.png)

  ê°œë°œì ëª¨ë“œë¡œ ë“¤ì–´ê°€ì„œ ë¡œì§ì„ ë³´ë‹ˆ Login ë²„íŠ¼ì„ ëˆ„ë¥´ë©´, mem/login.phpë¡œ ì´ë™ì„ í•˜ê³ , Join ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ Access Denied ë¼ëŠ” ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ë„ë¡ ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. 

  ![image](https://user-images.githubusercontent.com/33647663/150665245-4c631117-95b4-48f3-8582-8eb3ff31bc21.png)
  
  login -> mem/login.phpë¡œ ì´ë™ì´ ë˜ë‹ˆ,
  join -> mem/join.phpë¡œ ì´ë™ì´ ë ê±°ë¼ ê°€ì •í•˜ê³  í•´ë‹¹ ë§í¬ë¡œ ì ‘ì†ì„ í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ í˜ì´ì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤

  ![image](https://user-images.githubusercontent.com/33647663/150665300-736bc1bc-fc9c-4ccb-ab9d-d20ada5d1d29.png)

  í•´ë‹¹ í˜ì´ì§€ë„ ê°œë°œì ëª¨ë“œë¡œ ë“¤ì–´ê°€ì„œ ë³´ë‹ˆ, ë‚œë…í™”ëœ ìë°” ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ ì‘ë™í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤. ë³¸ ë¬¸ì œëŠ” í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶„ì„í•˜ê³ , ìš°íšŒí•˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150665357-61496ef1-711a-4e6c-9350-5f2bb454e256.png)


# ë¬¸ì œ í’€ì´

  ìë°” ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ íŒ¨í‚¹ë˜ì–´ ì½ê¸° ì–´ë µê²Œ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ë¨¼ì € ì½ì„ ìˆ˜ ìˆë„ë¡ ë³€í™˜í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. êµ¬ê¸€ì— **ìë°”ìŠ¤í¬ë¦½íŠ¸ ë‚œë…í™” í•´ì œ**ê°™ì€ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•˜ë©´ ì½”ë“œë¥¼ ì½ì„ ìˆ˜ ìˆë„ë¡ ì •ë ¬í•´ì£¼ëŠ” ì‚¬ì´íŠ¸ê°€ ë§ì´ ë‚˜ì˜µë‹ˆë‹¤. ì €ëŠ” [ì´ ì‚¬ì´íŠ¸](https://www.strictly-software.com/unpack-javascript)ì—ì„œ ì–¸íŒ¨í‚¹ì„ í•´ì¤¬ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150665415-2cc7f1fc-cfc3-4bf3-a96a-25782c07f5e5.png)

  ![image](https://user-images.githubusercontent.com/33647663/150665420-116fa87f-742c-49a1-9c8b-4090aa3f7fd5.png)

  ì´ì œ ì–¸íŒ¨í‚¹ ëœ ì½”ë“œë¥¼ ê°œë°œì ëª¨ë“œ > ì½˜ì†”ì—ì„œ ì‹¤í–‰í•´ ë³´ë©´ì„œ ì–´ë–¤ ë¡œì§ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•´ ë´…ë‹ˆë‹¤. ìš°ì„  I,II,III ... 1,11,111 ë“±ê³¼ ê°™ì€ ë¬¸ìë¡œ ì¹˜í™˜ì„ í•´ì„œ ë¬¸ìì—´ì„ ì¡°í•©í•˜ê¸° ë•Œë¬¸ì— ì½ê¸° í˜ë“¤ë„ë¡ ë‚œë…í™”ë¥¼ í•´ë†¨ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¤í–‰íˆ ì¤‘ê°„ ë¶€ë¶„ì„ ë³´ë©´ if, alertë¶€ë¶„ì´ ì½íˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¶€ë¶„ì„ ë³´ê² ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150665499-af323925-8300-4e81-a2b4-6d2600379b3a.png)

  ```javascript
  if (eval(lIIIIIIIIIIIIIIIIIIl).indexOf(lIllIllIllIllIllIllIllIllIllIl) == -1) {
	alert('bye');
	throw "stop";
  }
  ```
  

  í¬ë¡¬ì˜ ì½˜ì†”ëª¨ë“œë¡œ ifë¬¸ ì•ˆì— ìˆëŠ” ë‚´ìš©ì„ ì…ë ¥í•´ë³´ë©´, ì¡°ê±´ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666520-1c791354-a9e3-4118-b0e6-bd408f4b3cdf.png)

  ì´ë¥¼ ì¢…í•©í•˜ì—¬ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë©ë‹ˆë‹¤.

  ```javascript
  if(eval(document.cookie).indexOf(oldzombie == -1)){
    alert('bye');
    throw "stop";
  }
  ```

  ê·¸ëŸ¬ë©´ ìœ„ì˜ ì¡°ê±´ì„ ìš°íšŒí•˜ê¸° ìœ„í•´ì„œ ì¿ í‚¤ ê°’ì— oldzombieë¥¼ ì…ë ¥í•´ì„œ ë‹¤ì‹œ ì ‘ì†í•´ ë³´ê² ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666547-57d16184-dac2-48cc-8794-f3be240c0023.png)

  ì´ë²ˆì—ëŠ” **access_denied** ë©”ì‹œì§€ë¡œ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. 

  ![image](https://user-images.githubusercontent.com/33647663/150666558-4efc2a41-8ef0-449e-b5e7-a082fe36c96d.png)

  ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œì—ì„œ ë‹¤ì‹œ ì´ë¶€ë¶„ì„ ì°¾ì•„ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```javascript
  if (eval(llll + lllllllllllllll + lll + lllllllllllllllllllll + lllllllllllll + lllll + llllllllllllll + llllllllllllllllllll + li + 'U' + 'R' + 'L').indexOf(lllllllllllll + lllllllllllllll + llll + lllll + '=' + I) == -1) {
	alert('access_denied');
	throw "stop";
  }
  ``` 


  ë™ì¼í•˜ê²Œ í¬ë¡¬ ì½˜ì†”ì—ì„œ ì¹˜í™˜í•´ì•¼ í•˜ëŠ” ë¬¸ìì—´ì„ ì…ë ¥í•˜ì—¬ ifë¬¸ ì¡°ê±´ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```javascript
  if(eval(document.URL).indexOf(mode=1) == -1){
    alert('access_denied');
    throw "stop";
  }
  ```

  ì´ë²ˆì—ëŠ” í•´ë‹¹ ì¡°ê±´ì„ ì¶©ì¡±ì‹œí‚¤ê¸° ìœ„í•´ URLì— mode=1ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë„˜ê²¨ì£¼ë©´ì„œ ìš”ì²­ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. ê·¸ë¦¼ì²˜ëŸ¼ mode=1ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë„˜ê²¨ì£¼ë‹ˆ íšŒì›ê°€ì…ì„ í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666632-544b00e3-0044-4f7d-a85d-641f121694cf.png)

  guest/guestë¡œ íšŒì›ê°€ì…ì„ í•œ í›„ , Login í˜ì´ì§€ì—ì„œ guest/guestë¡œ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666668-85e62144-3b8f-42db-9603-ee293174e6b7.png)

  adminìœ¼ë¡œ ë¡œê·¸ì¸ì„ í•´ì•¼ í•˜ë¯€ë¡œ íšŒì›ê°€ì… í˜ì´ì§€ì—ì„œ adminìœ¼ë¡œ íšŒì›ê°€ì…ì„ í•˜ë ¤ê³  í•˜ë©´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë”” ë¼ê³  ëœ¹ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666708-4f6ba4db-d90d-423b-9041-6309acff769f.png)

  ì´ ë¬¸ì œëŠ” adminê³„ì •ì˜ íšŒì›ê°€ì… ë¡œì§ì„ ìš°íšŒí•´ì„œ íšŒì›ê°€ì…ì„ ì§„í–‰í•˜ì—¬, admin ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì„ í•˜ë©´ í’€ë¦¬ëŠ” ë¬¸ì œ ê°™ìŠµë‹ˆë‹¤. ì €ëŠ” ì´ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

  íšŒì›ê°€ì… ë‚´ìš©ì„ Burp_suiteë¡œ ì¡ì•„ì„œ id ë¶€ë¶„ì„ 
  admin -> admin%00ìœ¼ë¡œ ìˆ˜ì •í•˜ì—¬ ë³´ëƒˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666784-edd6f77a-50c6-4f4f-a496-d40867585f46.png)

  ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì´ íšŒì›ê°€ì…ì— ì„±ê³µí•©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666807-84e908c7-3651-4438-aa34-d9dcdec23251.png)

  ê·¸ë¦¬ê³  ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ë‹¤ì‹œ íŒ¨í‚·ì„ ì¡ì•„ì„œ ë™ì¼í•˜ê²Œ id/pwë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•´ ì¤ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666848-6f8fd851-06d4-4152-915d-980dfd7aa1ee.png)

  ê·¸ëŸ¬ë©´ ë¬¸ì œê°€ í’€ë¦½ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150666883-e3beaec9-610c-4678-b78e-39b9fb557a0a.png)

  


